(self.webpackChunkdora_dora=self.webpackChunkdora_dora||[]).push([[8959],{3484:()=>{},18641:()=>{},26031:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addDiagnosticToLog:()=>Oa,getDeclarationFile:()=>Na,getDiagnosticMessage:()=>_a,revalidateModel:()=>ba,setModelMarkers:()=>Aa,transpileTypescript:()=>Ea});var r=n(84532),i=n(90841),s=n(86292),o=n(84765);function a(e){return Array.isArray(e)?e:[e]}const c=(e,t)=>e.flatMap(((e,n)=>0===n?[e]:[t,e])),u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[...new Set(...t)]},l=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return u(e).filter((e=>n.every((t=>t.includes(e)))))};let p=1e5;const d=e=>((e,t)=>Object.assign((function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return{file:void 0,start:void 0,length:void 0,category:i.DiagnosticCategory.Error,code:e,source:"typescript-to-lua",...t(...r)}}),{code:e}))(p++,e),f=e=>e.replace(/\\/g,"/"),m=e=>e.slice(0,-s.default.extname(e).length);function h(e){return e=e.replace(/\.json$/,""),"Windows"===o.A.platform&&(e=e.replace(/\.\\/g,"").replace(/\\/g,".")),e.replace(/\.\//g,"").replace(/\//g,".")}function g(e,t,n){return e.has(t)||e.set(t,n()),e.get(t)}function y(e){return null!=e}function S(e,t){if(t(e))return e;throw new Error(`Failed to cast value to expected type using ${t.name}.`)}function x(e){throw new Error("Value is expected to be never")}const T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.DiagnosticCategory.Error;return d((function(){return{messageText:e(...arguments),category:t}}))},v=T(((e,t)=>`Could not resolve lua source files for require path '${e}' in file ${t}.`)),E=T((e=>`Could not read content of resolved dependency ${e}.`)),b=(T(((e,t)=>`To load "${t}" ${e} it should be transpiled or "ts-node" should be installed.`)),T(((e,t,n)=>`Could not resolve "${t}" ${e} from "${n}".`)),T(((e,t,n)=>`"${t}" ${e} should have a "${n}" export.`)),T((e=>`"${e}" transformer should be a ts.TransformerFactory or an object with ts.TransformerFactory values.`)),T((e=>`Could not find bundle entry point '${e}'. It should be a file in the project.`))),A=T((()=>"'luaBundleEntry' is required when 'luaBundle' is enabled.")),_=d((()=>({category:i.DiagnosticCategory.Warning,messageText:"Using 'luaBundle' with 'luaLibImport: \"inline\"' might generate duplicate code. It is recommended to use 'luaLibImport: \"require\"'."}))),O=T((()=>'Cannot bundle projects with "buildmode": "library". Projects including the library can still bundle (which will include external library files).')),k=T((()=>'JSX is only supported with "react" jsx option.')),N=T((()=>"When configuring 'paths' in tsconfig.json, the option 'baseUrl' must also be provided."));let w=function(e){return e.None="none",e.Inline="inline",e.Require="require",e.RequireMinimal="require-minimal",e}({}),F=function(e){return e.Universal="universal",e.Lua50="5.0",e.Lua51="5.1",e.Lua52="5.2",e.Lua53="5.3",e.Lua54="5.4",e.LuaJIT="JIT",e.Luau="Luau",e}({}),L=function(e){return e.Default="default",e.Library="library",e}({});const I=e=>void 0!==e.luaBundle&&void 0!==e.luaBundleEntry;let M=function(e){return e[e.File=0]="File",e[e.Block=1]="Block",e[e.DoStatement=2]="DoStatement",e[e.VariableDeclarationStatement=3]="VariableDeclarationStatement",e[e.AssignmentStatement=4]="AssignmentStatement",e[e.IfStatement=5]="IfStatement",e[e.WhileStatement=6]="WhileStatement",e[e.RepeatStatement=7]="RepeatStatement",e[e.ForStatement=8]="ForStatement",e[e.ForInStatement=9]="ForInStatement",e[e.GotoStatement=10]="GotoStatement",e[e.LabelStatement=11]="LabelStatement",e[e.ReturnStatement=12]="ReturnStatement",e[e.BreakStatement=13]="BreakStatement",e[e.ContinueStatement=14]="ContinueStatement",e[e.ExpressionStatement=15]="ExpressionStatement",e[e.StringLiteral=16]="StringLiteral",e[e.NumericLiteral=17]="NumericLiteral",e[e.NilKeyword=18]="NilKeyword",e[e.DotsKeyword=19]="DotsKeyword",e[e.ArgKeyword=20]="ArgKeyword",e[e.TrueKeyword=21]="TrueKeyword",e[e.FalseKeyword=22]="FalseKeyword",e[e.FunctionExpression=23]="FunctionExpression",e[e.TableFieldExpression=24]="TableFieldExpression",e[e.TableExpression=25]="TableExpression",e[e.UnaryExpression=26]="UnaryExpression",e[e.BinaryExpression=27]="BinaryExpression",e[e.CallExpression=28]="CallExpression",e[e.MethodCallExpression=29]="MethodCallExpression",e[e.Identifier=30]="Identifier",e[e.TableIndexExpression=31]="TableIndexExpression",e[e.ParenthesizedExpression=32]="ParenthesizedExpression",e[e.ConditionalExpression=33]="ConditionalExpression",e[e.AdditionOperator=34]="AdditionOperator",e[e.SubtractionOperator=35]="SubtractionOperator",e[e.MultiplicationOperator=36]="MultiplicationOperator",e[e.DivisionOperator=37]="DivisionOperator",e[e.FloorDivisionOperator=38]="FloorDivisionOperator",e[e.ModuloOperator=39]="ModuloOperator",e[e.PowerOperator=40]="PowerOperator",e[e.NegationOperator=41]="NegationOperator",e[e.ConcatOperator=42]="ConcatOperator",e[e.LengthOperator=43]="LengthOperator",e[e.EqualityOperator=44]="EqualityOperator",e[e.InequalityOperator=45]="InequalityOperator",e[e.LessThanOperator=46]="LessThanOperator",e[e.LessEqualOperator=47]="LessEqualOperator",e[e.GreaterThanOperator=48]="GreaterThanOperator",e[e.GreaterEqualOperator=49]="GreaterEqualOperator",e[e.AndOperator=50]="AndOperator",e[e.OrOperator=51]="OrOperator",e[e.NotOperator=52]="NotOperator",e[e.BitwiseAndOperator=53]="BitwiseAndOperator",e[e.BitwiseOrOperator=54]="BitwiseOrOperator",e[e.BitwiseExclusiveOrOperator=55]="BitwiseExclusiveOrOperator",e[e.BitwiseRightShiftOperator=56]="BitwiseRightShiftOperator",e[e.BitwiseLeftShiftOperator=57]="BitwiseLeftShiftOperator",e[e.BitwiseNotOperator=58]="BitwiseNotOperator",e}({}),P=function(e){return e[e.None=0]="None",e[e.Inline=1]="Inline",e[e.Declaration=2]="Declaration",e[e.TableUnpackCall=4]="TableUnpackCall",e}({});function C(e,t){if(void 0===t)return{kind:e,flags:P.None};const n=K(t);return n?{kind:e,line:n.line,column:n.column,flags:P.None}:{kind:e,flags:P.None}}function D(e,t){return e.line=t.line,e.column=t.column,e}function K(e){var t;const n=null!==(t=i.getParseTreeNode(e))&&void 0!==t?t:e,r=n.getSourceFile();if(void 0!==r&&n.pos>=0){const{line:e,character:t}=i.getLineAndCharacterOfPosition(r,n.pos+n.getLeadingTriviaWidth());return{line:e,column:t}}}function B(e){return{line:e.line,column:e.column}}function R(e,t){const n=C(M.Block,t);return n.statements=e,n}function j(e,t){const n=C(M.DoStatement,t);return n.statements=e,n}function $(e){return e.kind===M.VariableDeclarationStatement}function V(e,t,n){const r=C(M.VariableDeclarationStatement,n);return r.left=a(e),t&&(r.right=a(t)),r}function W(e,t,n){const r=C(M.AssignmentStatement,n);return r.left=a(e),r.right=t?a(t):[],r}function q(e,t,n,r){const i=C(M.IfStatement,r);return i.condition=e,i.ifBlock=t,i.elseBlock=n,i}function G(e,t,n){const r=C(M.WhileStatement,n);return r.body=e,r.condition=t,r}function U(e,t,n){const r=C(M.RepeatStatement,n);return r.body=e,r.condition=t,r}function z(e,t,n,r){const i=C(M.ForInStatement,r);return i.body=e,i.names=t,i.expressions=n,i}function H(e,t){const n=C(M.LabelStatement,t);return n.name=e,n}function J(e){return e.kind===M.ReturnStatement}function Q(e,t){const n=C(M.ReturnStatement,t);return n.expressions=e,n}function Y(e){return C(M.BreakStatement,e)}function Z(e,t){const n=C(M.ExpressionStatement,t);return n.expression=e,n}function X(e){return e.kind===M.NilKeyword}function ee(e){return C(M.NilKeyword,e)}function te(e,t){return C(e?M.TrueKeyword:M.FalseKeyword,t)}function ne(e){return e.kind===M.DotsKeyword}function re(e){return C(M.DotsKeyword,e)}function ie(e){return C(M.ArgKeyword,e)}function se(e){return e.kind===M.NumericLiteral}function oe(e,t){const n=C(M.NumericLiteral,t);return n.value=e,n}function ae(e){return e.kind===M.StringLiteral}function ce(e,t){const n=C(M.StringLiteral,t);return n.value=e,n}function ue(e){return X(e)||ne(e)||function(e){return e.kind===M.ArgKeyword}(e)||function(e){return e.kind===M.TrueKeyword||e.kind===M.FalseKeyword}(e)||se(e)||ae(e)}function le(e){return e.kind===M.FunctionExpression}function pe(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P.None,i=arguments.length>4?arguments[4]:void 0;const s=C(M.FunctionExpression,i);return s.body=e,s.params=t,s.dots=n,s.flags=r,s}function de(e){return e.kind===M.TableFieldExpression}function fe(e,t,n){const r=C(M.TableFieldExpression,n);return r.value=e,r.key=t,r}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const n=C(M.TableExpression,t);return n.fields=e,n}function he(e){return e.kind===M.UnaryExpression}function ge(e,t,n){const r=C(M.UnaryExpression,n);return r.operand=e,r.operator=t,r}function ye(e){return e.kind===M.BinaryExpression}function Se(e,t,n,r){const i=C(M.BinaryExpression,r);return i.left=e,i.right=t,i.operator=n,i}function xe(e){return e.kind===M.CallExpression}function Te(e,t,n){const r=C(M.CallExpression,n);return r.expression=e,r.params=t,r}function ve(e){return e.kind===M.Identifier}function Ee(e,t,n,r){const i=C(M.Identifier,t);return i.exportable=!0,i.text=e,i.symbolId=n,i.originalName=r,i}function be(e,t){return Ee(e.text,t,e.symbolId,e.originalName)}function Ae(e){const t=C(M.Identifier,e);return t.exportable=!1,t.text="____",t}function _e(e){return e.kind===M.TableIndexExpression}function Oe(e,t,n){const r=C(M.TableIndexExpression,n);return r.table=e,r.index=t,r}function ke(e){return ve(e)||_e(e)}function Ne(e){var t;return 1===e.left.length&&1===(null===(t=e.right)||void 0===t?void 0:t.length)&&le(e.right[0])}function we(e,t){const n=C(M.ParenthesizedExpression,t);return n.expression=e,n}const Fe=JSON.parse('{"ArrayAt":{"exports":["__TS__ArrayAt"]},"ArrayConcat":{"exports":["__TS__ArrayConcat"],"dependencies":["ArrayIsArray"]},"ArrayEntries":{"exports":["__TS__ArrayEntries"],"dependencies":["Symbol"]},"ArrayEvery":{"exports":["__TS__ArrayEvery"]},"ArrayFill":{"exports":["__TS__ArrayFill"]},"ArrayFilter":{"exports":["__TS__ArrayFilter"]},"ArrayForEach":{"exports":["__TS__ArrayForEach"]},"ArrayFind":{"exports":["__TS__ArrayFind"]},"ArrayFindIndex":{"exports":["__TS__ArrayFindIndex"]},"ArrayFrom":{"exports":["__TS__ArrayFrom"],"dependencies":["Iterator"]},"ArrayIncludes":{"exports":["__TS__ArrayIncludes"]},"ArrayIndexOf":{"exports":["__TS__ArrayIndexOf"]},"ArrayIsArray":{"exports":["__TS__ArrayIsArray"]},"ArrayJoin":{"exports":["__TS__ArrayJoin"]},"ArrayMap":{"exports":["__TS__ArrayMap"]},"ArrayPush":{"exports":["__TS__ArrayPush"]},"ArrayPushArray":{"exports":["__TS__ArrayPushArray"]},"ArrayReduce":{"exports":["__TS__ArrayReduce"],"dependencies":["CountVarargs"]},"ArrayReduceRight":{"exports":["__TS__ArrayReduceRight"],"dependencies":["CountVarargs"]},"ArrayReverse":{"exports":["__TS__ArrayReverse"]},"ArrayUnshift":{"exports":["__TS__ArrayUnshift"]},"ArraySort":{"exports":["__TS__ArraySort"]},"ArraySlice":{"exports":["__TS__ArraySlice"]},"ArraySome":{"exports":["__TS__ArraySome"]},"ArraySplice":{"exports":["__TS__ArraySplice"],"dependencies":["CountVarargs"]},"ArrayToObject":{"exports":["__TS__ArrayToObject"]},"ArrayFlat":{"exports":["__TS__ArrayFlat"],"dependencies":["ArrayIsArray","ArrayFlat"]},"ArrayFlatMap":{"exports":["__TS__ArrayFlatMap"],"dependencies":["ArrayIsArray"]},"ArraySetLength":{"exports":["__TS__ArraySetLength"]},"ArrayToReversed":{"exports":["__TS__ArrayToReversed"],"dependencies":["Unpack","ArrayReverse"]},"ArrayToSorted":{"exports":["__TS__ArrayToSorted"],"dependencies":["Unpack","ArraySort"]},"ArrayToSpliced":{"exports":["__TS__ArrayToSpliced"],"dependencies":["Unpack","ArraySplice"]},"ArrayWith":{"exports":["__TS__ArrayWith"],"dependencies":["Unpack"]},"Await":{"exports":["__TS__AsyncAwaiter","__TS__Await"],"dependencies":["Promise","New"]},"Class":{"exports":["__TS__Class"]},"ClassExtends":{"exports":["__TS__ClassExtends"]},"CloneDescriptor":{"exports":["__TS__CloneDescriptor"]},"CountVarargs":{"exports":["__TS__CountVarargs"]},"Decorate":{"exports":["__TS__Decorate"]},"DecorateLegacy":{"exports":["__TS__DecorateLegacy"],"dependencies":["ObjectAssign","ObjectGetOwnPropertyDescriptor","SetDescriptor"]},"DecorateParam":{"exports":["__TS__DecorateParam"],"dependencies":["DecorateLegacy"]},"Delete":{"exports":["__TS__Delete"],"dependencies":["Error","New","ObjectGetOwnPropertyDescriptors"]},"DelegatedYield":{"exports":["__TS__DelegatedYield"],"dependencies":["StringAccess","Symbol"]},"DescriptorGet":{"exports":["__TS__DescriptorGet"]},"DescriptorSet":{"exports":["__TS__DescriptorSet"]},"Error":{"exports":["Error","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],"dependencies":["StringIncludes","New","Error","Class","ClassExtends"]},"FunctionBind":{"exports":["__TS__FunctionBind"],"dependencies":["Unpack","ArrayUnshift"]},"Generator":{"exports":["__TS__Generator"],"dependencies":["Symbol","CountVarargs","Unpack"]},"InstanceOf":{"exports":["__TS__InstanceOf"],"dependencies":["Symbol"]},"InstanceOfObject":{"exports":["__TS__InstanceOfObject"]},"Iterator":{"exports":["__TS__Iterator"],"dependencies":["Symbol"]},"LuaIteratorSpread":{"exports":["__TS__LuaIteratorSpread"],"dependencies":["Unpack"]},"Map":{"exports":["Map"],"dependencies":["Class","Symbol","Iterator"]},"MapGroupBy":{"exports":["__TS__MapGroupBy"],"dependencies":["Map","New","Iterator"]},"Match":{"exports":["__TS__Match"]},"MathAtan2":{"exports":["__TS__MathAtan2"]},"MathModf":{"exports":["__TS__MathModf"]},"MathSign":{"exports":["__TS__MathSign"],"dependencies":["NumberIsNaN"]},"MathTrunc":{"exports":["__TS__MathTrunc"],"dependencies":["NumberIsFinite"]},"New":{"exports":["__TS__New"]},"Number":{"exports":["__TS__Number"]},"NumberIsFinite":{"exports":["__TS__NumberIsFinite"]},"NumberIsInteger":{"exports":["__TS__NumberIsInteger"],"dependencies":["NumberIsFinite"]},"NumberIsNaN":{"exports":["__TS__NumberIsNaN"]},"ParseInt":{"exports":["__TS__ParseInt"],"dependencies":["StringSubstring","Match"]},"ParseFloat":{"exports":["__TS__ParseFloat"],"dependencies":["StringAccess","Match"]},"NumberToString":{"exports":["__TS__NumberToString"],"dependencies":["StringAccess","MathModf"]},"NumberToFixed":{"exports":["__TS__NumberToFixed"]},"ObjectAssign":{"exports":["__TS__ObjectAssign"]},"ObjectDefineProperty":{"exports":["__TS__ObjectDefineProperty"],"dependencies":["SetDescriptor"]},"ObjectEntries":{"exports":["__TS__ObjectEntries"]},"ObjectFromEntries":{"exports":["__TS__ObjectFromEntries"],"dependencies":["Symbol"]},"ObjectGetOwnPropertyDescriptor":{"exports":["__TS__ObjectGetOwnPropertyDescriptor"]},"ObjectGetOwnPropertyDescriptors":{"exports":["__TS__ObjectGetOwnPropertyDescriptors"]},"ObjectGroupBy":{"exports":["__TS__ObjectGroupBy"],"dependencies":["Iterator"]},"ObjectKeys":{"exports":["__TS__ObjectKeys"]},"ObjectRest":{"exports":["__TS__ObjectRest"]},"ObjectValues":{"exports":["__TS__ObjectValues"]},"Promise":{"exports":["__TS__Promise"],"dependencies":["Promise","New","InstanceOf","Class"]},"PromiseAll":{"exports":["__TS__PromiseAll"],"dependencies":["InstanceOf","Promise","Iterator","New"]},"PromiseAllSettled":{"exports":["__TS__PromiseAllSettled"],"dependencies":["InstanceOf","Iterator","Promise","New"]},"PromiseAny":{"exports":["__TS__PromiseAny"],"dependencies":["InstanceOf","Promise","Iterator","New"]},"PromiseRace":{"exports":["__TS__PromiseRace"],"dependencies":["InstanceOf","Promise","Iterator","New"]},"Set":{"exports":["Set"],"dependencies":["Class","Symbol","Iterator","New"]},"SetDescriptor":{"exports":["__TS__SetDescriptor"],"dependencies":["CloneDescriptor","DescriptorGet","DescriptorSet"]},"SparseArrayNew":{"exports":["__TS__SparseArrayNew"],"dependencies":["CountVarargs"]},"SparseArrayPush":{"exports":["__TS__SparseArrayPush"],"dependencies":["CountVarargs"]},"SparseArraySpread":{"exports":["__TS__SparseArraySpread"]},"WeakMap":{"exports":["WeakMap"],"dependencies":["Class","Symbol"]},"WeakSet":{"exports":["WeakSet"],"dependencies":["Class","Symbol"]},"SourceMapTraceBack":{"exports":["__TS__SourceMapTraceBack"],"dependencies":["StringIncludes","Match"]},"Spread":{"exports":["__TS__Spread"],"dependencies":["StringAccess","Iterator","Unpack"]},"StringAccess":{"exports":["__TS__StringAccess"]},"StringCharAt":{"exports":["__TS__StringCharAt"]},"StringCharCodeAt":{"exports":["__TS__StringCharCodeAt"]},"StringEndsWith":{"exports":["__TS__StringEndsWith"]},"StringIncludes":{"exports":["__TS__StringIncludes"]},"StringPadEnd":{"exports":["__TS__StringPadEnd"]},"StringPadStart":{"exports":["__TS__StringPadStart"]},"StringReplace":{"exports":["__TS__StringReplace"]},"StringReplaceAll":{"exports":["__TS__StringReplaceAll"],"dependencies":["StringSplit"]},"StringSlice":{"exports":["__TS__StringSlice"]},"StringSplit":{"exports":["__TS__StringSplit"]},"StringStartsWith":{"exports":["__TS__StringStartsWith"]},"StringSubstr":{"exports":["__TS__StringSubstr"]},"StringSubstring":{"exports":["__TS__StringSubstring"]},"StringTrim":{"exports":["__TS__StringTrim"]},"StringTrimEnd":{"exports":["__TS__StringTrimEnd"]},"StringTrimStart":{"exports":["__TS__StringTrimStart"]},"Symbol":{"exports":["__TS__Symbol","Symbol"]},"SymbolRegistry":{"exports":["__TS__SymbolRegistryFor","__TS__SymbolRegistryKeyFor"],"dependencies":["Symbol"]},"TypeOf":{"exports":["__TS__TypeOf"]},"Unpack":{"exports":["__TS__Unpack"]},"Using":{"exports":["__TS__Using"],"dependencies":["Unpack","Symbol"]},"UsingAsync":{"exports":["__TS__UsingAsync"],"dependencies":["Unpack","Symbol","Await"]}}');let Le=function(e){return e.ArrayAt="ArrayAt",e.ArrayConcat="ArrayConcat",e.ArrayEntries="ArrayEntries",e.ArrayEvery="ArrayEvery",e.ArrayFill="ArrayFill",e.ArrayFilter="ArrayFilter",e.ArrayForEach="ArrayForEach",e.ArrayFind="ArrayFind",e.ArrayFindIndex="ArrayFindIndex",e.ArrayFrom="ArrayFrom",e.ArrayIncludes="ArrayIncludes",e.ArrayIndexOf="ArrayIndexOf",e.ArrayIsArray="ArrayIsArray",e.ArrayJoin="ArrayJoin",e.ArrayMap="ArrayMap",e.ArrayPush="ArrayPush",e.ArrayPushArray="ArrayPushArray",e.ArrayReduce="ArrayReduce",e.ArrayReduceRight="ArrayReduceRight",e.ArrayReverse="ArrayReverse",e.ArrayUnshift="ArrayUnshift",e.ArraySort="ArraySort",e.ArraySlice="ArraySlice",e.ArraySome="ArraySome",e.ArraySplice="ArraySplice",e.ArrayToObject="ArrayToObject",e.ArrayFlat="ArrayFlat",e.ArrayFlatMap="ArrayFlatMap",e.ArraySetLength="ArraySetLength",e.ArrayToReversed="ArrayToReversed",e.ArrayToSorted="ArrayToSorted",e.ArrayToSpliced="ArrayToSpliced",e.ArrayWith="ArrayWith",e.Await="Await",e.Class="Class",e.ClassExtends="ClassExtends",e.CloneDescriptor="CloneDescriptor",e.CountVarargs="CountVarargs",e.Decorate="Decorate",e.DecorateLegacy="DecorateLegacy",e.DecorateParam="DecorateParam",e.Delete="Delete",e.DelegatedYield="DelegatedYield",e.DescriptorGet="DescriptorGet",e.DescriptorSet="DescriptorSet",e.Error="Error",e.FunctionBind="FunctionBind",e.Generator="Generator",e.InstanceOf="InstanceOf",e.InstanceOfObject="InstanceOfObject",e.Iterator="Iterator",e.LuaIteratorSpread="LuaIteratorSpread",e.Map="Map",e.MapGroupBy="MapGroupBy",e.Match="Match",e.MathAtan2="MathAtan2",e.MathModf="MathModf",e.MathSign="MathSign",e.MathTrunc="MathTrunc",e.New="New",e.Number="Number",e.NumberIsFinite="NumberIsFinite",e.NumberIsInteger="NumberIsInteger",e.NumberIsNaN="NumberIsNaN",e.NumberParseInt="ParseInt",e.NumberParseFloat="ParseFloat",e.NumberToString="NumberToString",e.NumberToFixed="NumberToFixed",e.ObjectAssign="ObjectAssign",e.ObjectDefineProperty="ObjectDefineProperty",e.ObjectEntries="ObjectEntries",e.ObjectFromEntries="ObjectFromEntries",e.ObjectGetOwnPropertyDescriptor="ObjectGetOwnPropertyDescriptor",e.ObjectGetOwnPropertyDescriptors="ObjectGetOwnPropertyDescriptors",e.ObjectGroupBy="ObjectGroupBy",e.ObjectKeys="ObjectKeys",e.ObjectRest="ObjectRest",e.ObjectValues="ObjectValues",e.ParseFloat="ParseFloat",e.ParseInt="ParseInt",e.Promise="Promise",e.PromiseAll="PromiseAll",e.PromiseAllSettled="PromiseAllSettled",e.PromiseAny="PromiseAny",e.PromiseRace="PromiseRace",e.Set="Set",e.SetDescriptor="SetDescriptor",e.SparseArrayNew="SparseArrayNew",e.SparseArrayPush="SparseArrayPush",e.SparseArraySpread="SparseArraySpread",e.WeakMap="WeakMap",e.WeakSet="WeakSet",e.SourceMapTraceBack="SourceMapTraceBack",e.Spread="Spread",e.StringAccess="StringAccess",e.StringCharAt="StringCharAt",e.StringCharCodeAt="StringCharCodeAt",e.StringEndsWith="StringEndsWith",e.StringIncludes="StringIncludes",e.StringPadEnd="StringPadEnd",e.StringPadStart="StringPadStart",e.StringReplace="StringReplace",e.StringReplaceAll="StringReplaceAll",e.StringSlice="StringSlice",e.StringSplit="StringSplit",e.StringStartsWith="StringStartsWith",e.StringSubstr="StringSubstr",e.StringSubstring="StringSubstring",e.StringTrim="StringTrim",e.StringTrimEnd="StringTrimEnd",e.StringTrimStart="StringTrimStart",e.Symbol="Symbol",e.SymbolRegistry="SymbolRegistry",e.TypeOf="TypeOf",e.Unpack="Unpack",e.Using="Using",e.UsingAsync="UsingAsync",e}({});function Ie(e){const t=e===F.Lua50?"5.0":"universal";return s.default.resolve("/",s.default.join("/","dist","lualib",t))}const Me=new Map;function Pe(e){return Me.has(e)||Me.set(e,Fe),Me.get(e)}const Ce=new Map;const De=new Map;function Ke(e,t,n){return function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Pe(t);const i=new Set,s=[];function o(e){var t;if(i.has(e))return;i.add(e);const n=null===(t=r[e])||void 0===t?void 0:t.dependencies;n&&n.forEach(o),s.push(e)}for(const a of e)o(a);return s}(e,t,n).map((e=>function(e,t,n){const r=g(De,t,(()=>new Map));if(!r.has(e)){const i=s.default.join(Ie(t),`${e}.lua`),o=n.readFile(i);if(void 0===o)throw new Error(`Could not load lualib feature from '${i}'`);r.set(e,o)}return r.get(e)}(e,t,n))).join("\n")}const Be=new Map;function Re(e,t,n){const r=new Set,i=function(e){if(!Ce.has(e)){const t=Pe(e),n=new Map;for(const[e,r]of Object.entries(t))for(const t of r.exports)n.set(t,e);Ce.set(e,n)}return Ce.get(e)}(e);for(const s of n){const e=/^local (\w+) = ____lualib\.(\w+)$/gm;for(;;){const t=e.exec(s);if(!t)break;const[,n,o]=t;if(n!==o)continue;const a=i.get(o);a&&r.add(a)}}return r}var je=n(89823);const $e=(e,t)=>d((function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return{file:i.getOriginalNode(n).getSourceFile(),start:i.getOriginalNode(n).getStart(),length:i.getOriginalNode(n).getWidth(),messageText:"string"===typeof t?t:t(...s),category:e}})),Ve=e=>$e(i.DiagnosticCategory.Error,e),We=e=>$e(i.DiagnosticCategory.Warning,e),qe=Ve((e=>`Unsupported node kind ${i.SyntaxKind[e]}`)),Ge=Ve("Iterating over arrays with 'for ... in' is not allowed."),Ue=Ve((e=>`Unable to convert function with a 'this' parameter to function${e?` '${e}'`:""} with no 'this'. To fix, wrap in an arrow function, or declare with 'this: void'.`)),ze=Ve((e=>`Unable to convert function with no 'this' parameter to function${e?` '${e}'`:""} with 'this'. To fix, wrap in an arrow function, or declare with 'this: any'.`)),He=Ve((e=>`Unsupported assignment of function with different overloaded types for 'this'${e?` to '${e}'`:""}. Overloads should all have the same type for 'this'.`)),Je=Ve("Decorator function cannot have 'this: void'."),Qe=Ve(((e,t,n)=>`'@${e}' expects ${n} arguments, but got ${t}.`)),Ye=Ve("$range can only be used in a for...of loop."),Ze=Ve("$vararg can only be used in a spread element ('...$vararg') in global scope."),Xe=Ve("For loop using $range must declare a single control variable."),et=Ve("LuaIterable with a LuaMultiReturn return value type must be destructured."),tt=Ve("LuaPairsIterable type must be destructured in a for...of statement."),nt=Ve("Accessors in object literal are not supported."),rt=Ve("Right shift operator is not supported for target Lua 5.3. Use `>>>` instead."),it=e=>e===F.LuaJIT?"LuaJIT":`Lua ${e}`,st=Ve(((e,t)=>`${e} is/are not supported for target ${it(t)}.`)),ot=Ve(((e,t,n)=>`As a precaution, ${e} is/are not supported for target ${it(t)} due to language features/limitations. However "--${n}" can be used to bypass this precaution. See https://typescripttolua.github.io/docs/configuration for more information.`)),at=Ve(((e,t)=>`${e}.${t} is unsupported.`)),ct=Ve((e=>`Invalid ambient identifier name '${e}'. Ambient identifiers must be valid lua identifiers.`)),ut=Ve("`var` declarations are not supported. Use `let` or `const` instead."),lt=Ve("The $multi function must be called in a return statement."),pt=Ve("The $multi function cannot be cast to a non-LuaMultiReturn type."),dt=Ve("The LuaMultiReturn type can only be accessed via an element access expression of a numeric type."),ft=Ve("This function must be called directly and cannot be referred to."),mt=(We((e=>`'@${e}' is deprecated and will be removed in a future update. Please update your code before upgrading to the next release, otherwise your project will no longer compile. See https://typescripttolua.github.io/docs/advanced/compiler-annotations#${e.toLowerCase()} for more information.`)),We("Only false and nil evaluate to 'false' in Lua, everything else is considered 'true'. Explicitly compare the value with ===.")),ht=Ve("The left-hand side of an assignment expression may not be an optional property access."),gt=Ve("Await can only be used inside async functions."),yt=Ve("Optional calls are not supported for builtin or language extension functions."),St=Ve("Optional calls are not supported on enums marked with @compileMembersOnly."),xt=Ve("Array literals may not contain undefined or null."),Tt=Ve("This language extension must be called as a method."),vt=Ve("Spread elements are not supported in call extensions."),Et=Ve((e=>`Cannot create assignment assigning to a node of type ${M[e]}.`)),bt=We("You are using a class field decorator, note that tstl ignores returned value initializers!"),At=Ve("Constructing new Array with length is not supported.");let _t=function(e){return e.MultiFunction="MultiFunction",e.RangeFunction="RangeFunction",e.VarargConstant="VarargConstant",e.AdditionOperatorType="Addition",e.AdditionOperatorMethodType="AdditionMethod",e.SubtractionOperatorType="Subtraction",e.SubtractionOperatorMethodType="SubtractionMethod",e.MultiplicationOperatorType="Multiplication",e.MultiplicationOperatorMethodType="MultiplicationMethod",e.DivisionOperatorType="Division",e.DivisionOperatorMethodType="DivisionMethod",e.ModuloOperatorType="Modulo",e.ModuloOperatorMethodType="ModuloMethod",e.PowerOperatorType="Power",e.PowerOperatorMethodType="PowerMethod",e.FloorDivisionOperatorType="FloorDivision",e.FloorDivisionOperatorMethodType="FloorDivisionMethod",e.BitwiseAndOperatorType="BitwiseAnd",e.BitwiseAndOperatorMethodType="BitwiseAndMethod",e.BitwiseOrOperatorType="BitwiseOr",e.BitwiseOrOperatorMethodType="BitwiseOrMethod",e.BitwiseExclusiveOrOperatorType="BitwiseExclusiveOr",e.BitwiseExclusiveOrOperatorMethodType="BitwiseExclusiveOrMethod",e.BitwiseLeftShiftOperatorType="BitwiseLeftShift",e.BitwiseLeftShiftOperatorMethodType="BitwiseLeftShiftMethod",e.BitwiseRightShiftOperatorType="BitwiseRightShift",e.BitwiseRightShiftOperatorMethodType="BitwiseRightShiftMethod",e.ConcatOperatorType="Concat",e.ConcatOperatorMethodType="ConcatMethod",e.LessThanOperatorType="LessThan",e.LessThanOperatorMethodType="LessThanMethod",e.GreaterThanOperatorType="GreaterThan",e.GreaterThanOperatorMethodType="GreaterThanMethod",e.NegationOperatorType="Negation",e.NegationOperatorMethodType="NegationMethod",e.BitwiseNotOperatorType="BitwiseNot",e.BitwiseNotOperatorMethodType="BitwiseNotMethod",e.LengthOperatorType="Length",e.LengthOperatorMethodType="LengthMethod",e.TableNewType="TableNew",e.TableDeleteType="TableDelete",e.TableDeleteMethodType="TableDeleteMethod",e.TableGetType="TableGet",e.TableGetMethodType="TableGetMethod",e.TableHasType="TableHas",e.TableHasMethodType="TableHasMethod",e.TableSetType="TableSet",e.TableSetMethodType="TableSetMethod",e.TableAddKeyType="TableAddKey",e.TableAddKeyMethodType="TableAddKeyMethod",e.TableIsEmptyType="TableIsEmpty",e.TableIsEmptyMethodType="TableIsEmptyMethod",e}({});const Ot=new Set(Object.values(_t));function kt(e,t){const n=wt(e,t,"__tstlExtension");if(n&&Ot.has(n))return n}const Nt=262143|i.TypeFlags.Index|i.TypeFlags.NonPrimitive;function wt(e,t,n){if(t.flags&Nt)return;const r=t.getProperty(n);if(!r)return;const i=e.checker.getTypeOfSymbolAtLocation(r,e.sourceFile);return i.isStringLiteral()?i.value:void 0}function Ft(e,t){const n=i.getOriginalNode(t);let r=e.checker.getTypeAtLocation(n);return i.isOptionalChain(n)&&(r=e.checker.getNonNullableType(r)),kt(e,r)}function Lt(e,t){const n=e.checker.getTypeOfSymbolAtLocation(t,e.sourceFile);return kt(e,n)}let It=function(e){return e.Iterable="Iterable",e.Pairs="Pairs",e.PairsKey="PairsKey",e}({});function Mt(e,t){const n=e.checker.getTypeAtLocation(t);return function(e,t){const n=wt(e,t,"__tstlIterable");if(n&&n in It)return n}(e,n)}const Pt=new Set(Object.values(_t).filter((e=>e.endsWith("Method"))));function Ct(e,t,n,r){let s;if(!t.arguments.some(i.isSpreadElement)){if(Pt.has(n)){if(!i.isPropertyAccessExpression(t.expression)&&!i.isElementAccessExpression(t.expression))return void e.diagnostics.push(Tt(t));if(t.arguments.length<r-1)return;s=[t.expression.expression,...t.arguments]}else{if(t.arguments.length<r)return;s=t.arguments}return s}e.diagnostics.push(vt(t))}function Dt(e,t,n){var r;return null===(r=Ct(e,t,n,1))||void 0===r?void 0:r[0]}function Kt(e,t,n){const r=Ct(e,t,n,2);if(void 0!==r)return[r[0],r[1]]}function Bt(e,t){e.usedLuaLibFeatures.add(t)}function Rt(e,t,n){Bt(e,t);const r=Ee(`__TS__${t}`);for(var i=arguments.length,s=new Array(i>3?i-3:0),o=3;o<i;o++)s[o-3]=arguments[o];return Te(r,s,n)}function jt(e){return i.isObjectLiteralExpression(e)||i.isArrayLiteralExpression(e)}function $t(e){return i.isBinaryExpression(e)&&e.operatorToken.kind===i.SyntaxKind.EqualsToken&&jt(e.left)}function Vt(e){const t=tn(e,i.isFunctionLike);return!!t&&(!!i.canHaveModifiers(t)&&(null!==(n=null===(r=i.getModifiers(t))||void 0===r?void 0:r.some((e=>e.kind===i.SyntaxKind.AsyncKeyword)))&&void 0!==n&&n));var n,r}function Wt(e,t,n){const r=e.checker.getBaseConstraintOfType(t);return r&&(t=r),!!(t.flags&n)||(t.isUnion()?t.types.every((t=>Wt(e,t,n))):!!t.isIntersection()&&t.types.some((t=>Wt(e,t,n))))}function qt(e,t,n){const r=e.checker.getBaseConstraintOfType(t);if(r)t=r;else if(t.isTypeParameter())return!0;return!!(t.flags&n)||(t.isUnion()||!!t.isIntersection())&&t.types.some((t=>qt(e,t,n)))}function Gt(e,t){return Wt(e,t,i.TypeFlags.StringLike)}function Ut(e,t){return Wt(e,t,i.TypeFlags.NumberLike)}function zt(e,t){if(e.checker.isArrayType(t)||e.checker.isTupleType(t))return!0;if(t.isUnionOrIntersection()&&t.types.some((t=>zt(e,t))))return!0;const n=t.getBaseTypes();if(n&&n.some((t=>zt(e,t))))return!0;if(t.symbol){const n=e.checker.getBaseConstraintOfType(t);if(n&&n!==t)return zt(e,n)}return!1}function Ht(e,t){if(e.checker.isArrayType(t)||e.checker.isTupleType(t))return!0;if(t.symbol){const n=e.checker.getBaseConstraintOfType(t);if(n&&n!==t)return Ht(e,n)}return!!t.isUnionOrIntersection()&&t.types.every((t=>Ht(e,t)))}function Jt(e,t,n){if(n(t))return!0;!t.isClassOrInterface()&&t.symbol&&(t=e.checker.getDeclaredTypeOfSymbol(t.symbol));const r=t.getBaseTypes();return!!r&&r.some((t=>Jt(e,t,n)))}function Qt(e,t){return Jt(e,t,(t=>zt(e,t)))}function Yt(e,t){return Jt(e,t,(t=>Ht(e,t)))}function Zt(e){return e.getCallSignatures().length>0}function Xt(e,t){if(!(!0===e.options.strict||!0===e.options.strictNullChecks)&&!t.isLiteral())return!0;return qt(e,t,i.TypeFlags.Boolean|i.TypeFlags.BooleanLiteral|i.TypeFlags.Never|i.TypeFlags.Void|i.TypeFlags.Unknown|i.TypeFlags.Any|i.TypeFlags.Undefined|i.TypeFlags.Null)}function en(e,t){return qt(e,t,i.TypeFlags.Boolean|i.TypeFlags.BooleanLiteral|i.TypeFlags.Never|i.TypeFlags.Void|i.TypeFlags.Unknown|i.TypeFlags.Any)}function tn(e,t){let n=e;for(;n.parent;){if(t(n.parent))return n.parent;n=n.parent}}function nn(e){let t=i.getOriginalNode(e).parent;for(;i.isOuterExpression(t);)t=i.getOriginalNode(t).parent;return t}function rn(e){return!i.isExpressionStatement(nn(e))}function sn(e,t){var n;const r=(null!==(n=i.getParseTreeNode(t))&&void 0!==n?n:t).getSourceFile();return!!r&&("lib.Dora.d.ts"!==r.fileName&&"lua.d.ts"!==r.fileName&&e.program.isSourceFileDefaultLibrary(r))}function on(e,t,n){const r=t.getSymbol();if(!r||(n?r.name!==n:"__type"===r.name))return!1;const i=r.valueDeclaration;return!i||sn(e,i)}function an(e){return e.isUnion()?e.types.flatMap(an):e.getCallSignatures()}function cn(e){return void 0!==e.getProperty("__tstlMultiReturn")}function un(e){return 0!==(e.flags&i.TypeFlags.Any)||cn(e)||e.isUnion()&&e.types.some((e=>un(e)))}function ln(e,t){return function(e,t){return i.isIdentifier(t)&&"$multi"===t.text&&Ft(e,t)===_t.MultiFunction}(e,t.expression)}function pn(e,t){const n=e.checker.getResolvedSignature(t),r=null===n||void 0===n?void 0:n.getReturnType();return!!r&&cn(r)}function dn(e,t){return i.isCallExpression(t)&&pn(e,t)}function fn(e,t){const n=tn(t,i.isFunctionLike);if(!n)return!1;const r=e.checker.getSignatureFromDeclaration(n),s=null===r||void 0===r?void 0:r.getReturnType();return!!s&&cn(s)}function mn(e,t){if(!pn(e,t))return!1;const n=nn(t);return(!i.isVariableDeclaration(n)||!i.isArrayBindingPattern(n.name))&&((!i.isBinaryExpression(n)||n.operatorToken.kind!==i.SyntaxKind.EqualsToken||!i.isArrayLiteralExpression(n.left))&&(!i.isSpreadElement(n)&&(!i.isExpressionStatement(n)&&((!i.isReturnStatement(n)&&!i.isArrowFunction(n)||!fn(e,t))&&(!i.isElementAccessExpression(n)&&(!i.isForOfStatement(n)||Mt(e,t)!==It.Iterable))))))}function hn(e,t){return"$vararg"===t.getName()&&Lt(e,t)===_t.VarargConstant}function gn(e,t,n){var r;if(!i.isSpreadElement(nn(n)))return!1;const s=bn(e,Tn.Function|Tn.Try|Tn.Catch|Tn.File);if(!s)return;if(function(e,t,n){return n.type===Tn.File&&hn(e,t)}(e,t,s))return!0;if(!function(e){return void 0!==e.node&&i.isFunctionLike(e.node)}(s))return!1;if(i.canHaveModifiers(s.node)&&null!==(r=i.getModifiers(s.node))&&void 0!==r&&r.some((e=>e.kind===i.SyntaxKind.AsyncKeyword)))return!1;return!!s.node.parameters.some((n=>n.dotDotDotToken&&i.isIdentifier(n.name)&&e.checker.getSymbolAtLocation(n.name)===t))&&(!function(e,t,n){if(!t.referencedSymbols)return;for(const r of t.referencedSymbols.values())if(r.some((t=>e.checker.getSymbolAtLocation(t)===n)))return!0;return!1}(e,s,t)&&!function(e,t){if(!t.referencedSymbols||!t.node)return!1;for(const[r,i]of t.referencedSymbols){var n;const s=e.checker.getTypeAtLocation(i[0]);if((null===(n=t.functionDefinitions)||void 0===n||!n.has(r))&&s.getCallSignatures().length>0&&_n(s.symbol,t.node))return!0}return!1}(e,s))}function yn(e,t){return e.symbolInfoMap.get(t)}function Sn(e,t,n){let r=e.symbolIdMaps.get(t);return void 0===r&&(r=e.nextSymbolId(),e.symbolIdMaps.set(t,r),e.symbolInfoMap.set(r,{symbol:t,firstSeenAtPos:n.pos})),gn(e,t,n)||function(e,t,n){for(const r of e.scopeStack){r.referencedSymbols||(r.referencedSymbols=new Map);g(r.referencedSymbols,t,(()=>[])).push(n)}}(e,r,n),r}function xn(e,t,n){if(n)return Sn(e,n,t)}let Tn=function(e){return e[e.File=1]="File",e[e.Function=2]="Function",e[e.Switch=4]="Switch",e[e.Loop=8]="Loop",e[e.Conditional=16]="Conditional",e[e.Block=32]="Block",e[e.Try=64]="Try",e[e.Catch=128]="Catch",e[e.LoopInitializer=256]="LoopInitializer",e}({}),vn=function(e){return e[e.WithGoto=0]="WithGoto",e[e.WithRepeatBreak=1]="WithRepeatBreak",e[e.WithContinue=2]="WithContinue",e}({});function En(e){const t=e.scopeStack,n=t[t.length-1];return n}function bn(e,t){for(let n=e.scopeStack.length-1;n>=0;--n){const r=e.scopeStack[n];if(t&r.type)return r}}function An(e,t){e.variableDeclarations||(e.variableDeclarations=[]),e.variableDeclarations.push(t)}function _n(e,t){var n;return null===e||void 0===e||null===(n=e.declarations)||void 0===n?void 0:n.some((e=>i.isFunctionDeclaration(e)&&tn(e,(e=>e===t))))}function On(e,t){const n=En(e),r=[],i=[];let{unhoistedStatements:s,hoistedStatements:o,hoistedIdentifiers:a}=function(e,t,n){if(!t.functionDefinitions)return{unhoistedStatements:n,hoistedStatements:[],hoistedIdentifiers:[]};const r=[...n],i=[],s=[];for(const[o,a]of t.functionDefinitions)if(a.definition,Nn(e,o,t)){const e=r.indexOf(a.definition);if(e<0)continue;r.splice(e,1),$(a.definition)?(a.definition.right,s.push(...a.definition.left),i.push(W(a.definition.left,a.definition.right))):i.push(a.definition)}return{unhoistedStatements:r,hoistedStatements:i,hoistedIdentifiers:s}}(e,n,t);return r.push(...o),i.push(...a),({unhoistedStatements:s,hoistedIdentifiers:a}=function(e,t,n){if(!t.variableDeclarations)return{unhoistedStatements:n,hoistedIdentifiers:[]};const r=[...n],i=[];for(const s of t.variableDeclarations){if(s.left.map((e=>e.symbolId)).filter(y).some((n=>Nn(e,n,t)))){const e=r.indexOf(s);if(e<0)continue;if(s.right){const t=W(s.left,s.right);D(t,s),r.splice(e,1,t)}else r.splice(e,1);i.push(...s.left)}}return{unhoistedStatements:r,hoistedIdentifiers:i}}(e,n,s)),i.push(...a),({unhoistedStatements:s,hoistedStatements:o}=function(e,t){var n;return{unhoistedStatements:t,hoistedStatements:null!==(n=e.importStatements)&&void 0!==n?n:[]}}(n,s)),r.unshift(...o),{statements:s,hoistedStatements:r,hoistedIdentifiers:i}}function kn(e,t){const n=On(e,t),r=[...n.hoistedStatements,...n.statements];return n.hoistedIdentifiers.length>0&&r.unshift(V(n.hoistedIdentifiers)),r}function Nn(e,t,n){if(n.type===Tn.Switch)return!0;const r=yn(e,t);if(!r)return!1;const s=function(e,t){var n,r;const s=null!==(n=i.getParseTreeNode(t))&&void 0!==n?n:t,o=(null!==(r=e.getDeclarations())&&void 0!==r?r:[]).filter((e=>e.getSourceFile()===s));return o.length>0?o.reduce(((e,t)=>e.pos<t.pos?e:t)):void 0}(r.symbol,e.sourceFile);if(!s)return!1;if(r.firstSeenAtPos<s.pos)return!0;if(n.functionDefinitions)for(const[o,a]of n.functionDefinitions){a.definition;const{line:r,column:c}=B(a.definition);if(void 0!==r&&void 0!==c){const u=i.getPositionOfLineAndCharacter(e.sourceFile,r,c);if(o!==t&&s.pos<u&&a.referencedSymbols.has(t)&&Nn(e,o,n))return!0}}return!1}function wn(e){return void 0===e?[]:a(e)}function Fn(e){return Ee("self",e,void 0,"this")}function Ln(){return Ee("____exports")}function In(e,t){if(0===t)return e;const n=Mn(e);if(void 0!==n){const r=oe(n+t);return D(r,e),r}return ye(e)&&se(e.right)&&(e.operator===M.SubtractionOperator&&e.right.value===t||e.operator===M.AdditionOperator&&e.right.value===-t)?e.left:t>0?Se(e,oe(t),M.AdditionOperator):Se(e,oe(-t),M.SubtractionOperator)}function Mn(e){if(e)return se(e)?e.value:he(e)&&e.operator===M.NegationOperator&&se(e.operand)?-e.operand.value:void 0}function Pn(e,t,n){if(e.luaTarget===F.Universal)return Rt(e,Le.Unpack,n,t);const r=e.luaTarget===F.Lua50||e.luaTarget===F.Lua51||e.luaTarget===F.LuaJIT?Ee("unpack"):Oe(Ee("table"),ce("unpack"));return i=Te(r,[t],n),s=P.TableUnpackCall,i.flags=s,i;var i,s}function Cn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return me(t.map((e=>fe(e))))}function Dn(e){return ae(e)||se(e)||ye(e)&&e.operator===M.ConcatOperator?e:Te(Ee("tostring"),[e])}function Kn(e,t,n,r){const i=V(t,n,r);if(void 0!==t.symbolId){const t=En(e);t.type,Tn.Switch,An(t,i)}return i}function Bn(e,t,n,r,s){let o,c;const u=!0===e.options.noImplicitGlobalVariables,l=void 0!==r&&i.isFunctionDeclaration(r),p=a(t);if(0===p.length)return[];const d=null!==s&&void 0!==s?s:Es(e,p[0]);if(d){if(!n)return[];c=W(p.map((t=>ws(e,t,d))),n,r)}else{const i=En(e),s=i.type===Tn.File;if(e.isModule||!s||u){const s=n&&!Array.isArray(n)&&le(n);if(!(l&&s)&&function(e,t){const n=e.referencedSymbols;return!!n&&a(t).map((e=>e.symbolId&&n.get(e.symbolId))).some((e=>e&&e.length>1))}(i,t)){const s=V(t,void 0,r);e.prependPrecedingStatements(s),n&&(c=W(t,n,r)),An(i,s)}else o=V(t,n,r),l||An(i,o)}else{if(!n)return[];c=W(t,n,r)}}if(l){const n=t.symbolId,r=En(e);if(n&&r.functionDefinitions){const e=r.functionDefinitions.get(n);var f;if(e)e.definition=null!==(f=o)&&void 0!==f?f:c}}return function(e,t,n,r){if(e.options.removeComments)return;const s=function(e,t){if(void 0===t)return;const n=t;if(void 0===n.name)return;const r=e.checker.getSymbolAtLocation(n.name);if(void 0===r)return;const s=r.getDocumentationComment(e.checker),o=i.displayPartsToString(s).trim(),a=r.getJsDocTags(e.checker),c=a.map((e=>{let t="@"+e.name;if(void 0!==e.text){t+=" "+e.text.filter((e=>""!==e.text.trim())).map((e=>e.text.trim())).join(" ")}return t})).join("\n"),u=(o+"\n\n"+c).trim();if(""===u)return;const l=u.split("\n").map((e=>` ${e}`));if(l.length>0){const e=l[0];return e.startsWith(" @")?l.unshift("-"):(l.shift(),l.unshift("-"+e)),l}}(e,t);if(void 0===s)return;n&&r||n?n.leadingComments=s:r&&(r.leadingComments=s)}(e,r,o,c),o&&c?[o,c]:o?[o]:c?[c]:[]}const Rn=e=>Se(oe(0),oe(0),M.DivisionOperator,e);let jn=function(e){return e.CustomConstructor="customConstructor",e.CompileMembersOnly="compileMembersOnly",e.NoResolution="noResolution",e.NoSelf="noSelf",e.CustomName="customName",e.NoSelfInFile="noSelfInFile",e}({});const $n=new Map(Object.values(jn).map((e=>[e.toLowerCase(),e])));const Vn=new WeakMap;function Wn(e){const t=Vn.get(e);if(t)return t;const n=new Map;return function(e,t){for(const i of e.getJsDocTags()){var n,r;const e=$n.get(i.name.toLowerCase());if(!e)continue;const s={kind:i.name,args:null!==(n=null===(r=i.text)||void 0===r?void 0:r.map((e=>e.text)))&&void 0!==n?n:[]};t.set(e,s)}}(e,n),Vn.set(e,n),n}function qn(e){const t=new Map;return e.symbol&&Wn(e.symbol).forEach(((e,n)=>{t.set(n,e)})),e.aliasSymbol&&Wn(e.aliasSymbol).forEach(((e,n)=>{t.set(n,e)})),t}const Gn=new WeakMap;function Un(e){const t=Gn.get(e);if(t)return t;const n=new Map;return zn(n,i.getAllJSDocTags(e,i.isJSDocUnknownTag)),Gn.set(e,n),n}function zn(e,t){for(const n of t){const t=$n.get(n.tagName.text.toLowerCase());t&&e.set(t,{kind:t,args:Qn(n)})}}const Hn=new WeakMap;function Jn(e){const t=Hn.get(e);if(t)return t;const n=new Map;if(e.statements.length>0){const t=e.statements[0].jsDoc;if(t)for(const e of t)e.tags&&zn(n,e.tags)}return Hn.set(e,n),n}function Qn(e){return e.comment?"string"===typeof e.comment?e.comment.split(" "):e.comment.map((e=>e.text)):[]}let Yn=function(e){return e[e.None=0]="None",e[e.Void=1]="Void",e[e.NonVoid=2]="NonVoid",e[e.Mixed=3]="Mixed",e}({});function Zn(e){const t=tn(e,(e=>i.isSourceFile(e)||i.isModuleDeclaration(e)));return!!t&&(i.isSourceFile(t)?Jn(t).has(jn.NoSelfInFile):!!Un(t).has(jn.NoSelf)||Zn(t))}function Xn(e){const t=e.parameters[0];if(t&&i.isIdentifier(t.name)&&i.identifierToKeywordKind(t.name)===i.SyntaxKind.ThisKeyword)return t}const er=new WeakMap;function tr(e,t){const n=er.get(t);if(void 0!==n)return n;const r=e.checker.getResolvedSignature(t),s=null===r||void 0===r?void 0:r.getDeclaration();let o=Yn.None;if(s)o=rr(e,s);else{const n=function(e,t){var n,r;const s=i.isTaggedTemplateExpression(t)?t.tag:i.isJsxSelfClosingElement(t)||i.isJsxOpeningElement(t)?t.tagName:i.isCallExpression(t)?t.expression:void 0;if(!s)return[];const o=e.checker.getSymbolAtLocation(s);return void 0===o?[]:null!==(n=null===(r=o.getDeclarations())||void 0===r?void 0:r.flatMap((t=>{if(i.isImportSpecifier(t)){var n;return null!==(n=e.checker.getAliasedSymbol(o).getDeclarations())&&void 0!==n?n:[]}return[t]})))&&void 0!==n?n:[]}(e,t);o=n.some((e=>Jn(e.getSourceFile()).has(jn.NoSelfInFile)))||e.options.noImplicitSelf?Yn.Void:Yn.NonVoid}return er.set(t,o),o}const nr=new WeakMap;function rr(e,t){const n=Xn(t);if(n)return n.type&&n.type.kind===i.SyntaxKind.VoidKeyword?Yn.Void:Yn.NonVoid;if(Un(t).has(jn.NoSelf))return Yn.Void;if(i.isMethodSignature(t)||i.isMethodDeclaration(t)||i.isConstructSignatureDeclaration(t)||i.isConstructorDeclaration(t)||t.parent&&i.isPropertyDeclaration(t.parent)||t.parent&&i.isPropertySignature(t.parent)){const e=tn(t,(e=>i.isClassDeclaration(e)||i.isClassExpression(e)||i.isInterfaceDeclaration(e)));return void 0!==e&&Un(e).has(jn.NoSelf)?Yn.Void:Yn.NonVoid}if(t.parent&&i.isTypeParameterDeclaration(t.parent))return Yn.NonVoid;const r=e.program;if(r.getCompilerOptions().noImplicitSelf){const e=r.getSourceFile(t.getSourceFile().fileName);if(void 0!==e&&!r.isSourceFileDefaultLibrary(e)&&!r.isSourceFileFromExternalLibrary(e))return Yn.Void}return Zn(t)?Yn.Void:Yn.NonVoid}function ir(e,t){if(t.compositeSignatures)return t.compositeSignatures.flatMap((t=>ir(e,t)));const n=t.getDeclaration();if(void 0===n)return[];let r;if(i.isMethodDeclaration(n)&&i.isObjectLiteralExpression(n.parent)&&!Xn(n)?r=e.checker.getContextualTypeForObjectLiteralElement(n):!i.isFunctionExpression(n)&&!i.isArrowFunction(n)||Xn(n)||(r=function(e,t){var n;return null!==(n=e.checker.getContextualType(t))&&void 0!==n?n:e.checker.getTypeAtLocation(t)}(e,n)),r){const e=an(r);if(e.length>0)return e.map((e=>e.getDeclaration()))}return[n]}const sr=new WeakMap;function or(e,t){const n=sr.get(t);if(void 0!==n)return n;const r=function(e,t){if(t.isTypeParameter()){const n=t.getConstraint();if(n)return or(e,n)}const n=e.checker.getSignaturesOfType(t,i.SignatureKind.Call);if(0===n.length)return Yn.None;return function(e){let t=Yn.None;for(const n of e)if(t|=n,t===Yn.Mixed)break;return t}(n.flatMap((t=>ir(e,t))).map((t=>function(e,t){const n=nr.get(t);if(void 0!==n)return n;const r=rr(e,t);return nr.set(t,r),r}(e,t))))}(e,t);return sr.set(t,r),r}const ar=new WeakMap;function cr(e,t,n,r,s){var o,a;if(r===n)return;if(0!==(r.flags&i.TypeFlags.Any))return;const c=g(ar,n,(()=>new Set));if(c.has(r))return;c.add(r),function(e,t,n,r,i){const s=or(e,n),o=or(e,r);s===Yn.Mixed||o===Yn.Mixed?e.diagnostics.push(He(t,i)):s!==o&&s!==Yn.None&&o!==Yn.None&&e.diagnostics.push(o===Yn.Void?Ue(t,i):ze(t,i))}(e,t,n,r,s);const u=e.checker;if((u.isTupleType(r)||u.isArrayType(r))&&(u.isTupleType(n)||u.isArrayType(n))){const i=n.typeArguments,o=r.typeArguments;if(void 0===i||void 0===o)return;const a=Math.min(i.length,o.length);for(let n=0;n<a;++n)cr(e,t,i[n],o[n],s)}const l=null===(o=n.symbol)||void 0===o?void 0:o.members,p=null===(a=r.symbol)||void 0===a?void 0:a.members;function d(n,r,o){const a=e.checker.getTypeOfSymbolAtLocation(n,t),c=e.checker.getTypeOfSymbolAtLocation(r,t),u=i.unescapeLeadingUnderscores(o);cr(e,t,c,a,s?`${s}.${u}`:u)}l&&p&&(p.size<l.size?p.forEach(((e,t)=>{const n=l.get(t);n&&d(e,n,t)})):l.forEach(((e,t)=>{const n=p.get(t);n&&d(n,e,t)})))}function ur(e,t){e.pushPrecedingStatements();const n=t();return{precedingStatements:e.popPrecedingStatements(),result:n}}function lr(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Bt(e,Le.Await);const r=n?[Ee("____awaiter_resolve")]:[];return Te(Ee("__TS__AsyncAwaiter"),[pe(R(t),r)])}function pr(e,t,n){const r=e.checker.getTypeAtLocation(t),s=i.skipOuterExpressions(t,i.OuterExpressionKinds.Assertions);if(i.isCallExpression(s)){if(ln(e,s)){const r=e.checker.getContextualType(t);r&&!un(r)&&e.diagnostics.push(pt(s));let i=Xi(e,s.arguments);return n&&(i=[Cn(...i)]),i}if(n&&pn(e,s)&&!mn(e,s))return[Cn(e.transformExpression(t))]}else if(fn(e,s)&&cn(r))return[Pn(e,e.transformExpression(s),s)];return[e.transformExpression(t)]}function dr(e,t,n){return Vt(n)?Q([Te(Ee("____awaiter_resolve"),[ee(),...t])]):(fr(e)&&(t=[te(!0),...t]),Q(t,n))}function fr(e){let t=!1;for(const n of function*(e){const t=e.scopeStack;for(let n=t.length-1;n>=0;--n){const e=t[n];yield e}}(e)){if(n.functionReturned=!0,n.type===Tn.Function)break;t=t||n.type===Tn.Try||n.type===Tn.Catch}return t}const mr=-1;class hr{constructor(e,t,n){var r,s,o;this.program=e,this.sourceFile=t,this.visitorMap=n,this.diagnostics=[],this.checker=this.program.getTypeChecker(),this.resolver=void 0,this.precedingStatementsStack=[],this.options=this.program.getCompilerOptions(),this.luaTarget=null!==(r=this.options.luaTarget)&&void 0!==r?r:F.Universal,this.isModule=i.isExternalModule(this.sourceFile),this.isStrict=(null!==(s=this.options.alwaysStrict)&&void 0!==s?s:this.options.strict)||this.isModule&&void 0!==this.options.target&&this.options.target>=i.ScriptTarget.ES2015,this.currentNodeVisitors=[],this.currentNodeVisitorsIndex=0,this.nextTempId=0,this.lastSymbolId=0,this.symbolInfoMap=new Map,this.symbolIdMaps=new Map,this.usedLuaLibFeatures=new Set,this.scopeStack=[],this.lastScopeId=0,this.currentNamespaces=void 0,this.classSuperInfos=[];const a=null!==(o=i.getParseTreeNode(t,i.isSourceFile))&&void 0!==o?o:t;this.resolver=this.checker.getEmitResolver(a)}transformNode(e){return wn(this.transformNodeRaw(e))}transformNodeRaw(e,t){var n;if(i.canHaveModifiers(e)&&null!==(n=e.modifiers)&&void 0!==n&&n.some((e=>e.kind===i.SyntaxKind.DeclareKeyword)))return[];const r=this.visitorMap.get(e.kind);if(!r)return this.diagnostics.push(qe(e,e.kind)),t?[ee()]:[];const s=this.currentNodeVisitors,o=this.currentNodeVisitorsIndex;this.currentNodeVisitors=r,this.currentNodeVisitorsIndex=r.length-1;const a=(0,this.currentNodeVisitors[this.currentNodeVisitorsIndex])(e,this);return this.currentNodeVisitors=s,this.currentNodeVisitorsIndex=o,a}superTransformNode(e){return wn(this.doSuperTransformNode(e))}doSuperTransformNode(e){if(--this.currentNodeVisitorsIndex<0)throw new Error(`There is no super transform for ${i.SyntaxKind[e.kind]} visitor`);return wn((0,this.currentNodeVisitors[this.currentNodeVisitorsIndex])(e,this))}transformExpression(e){const t=this.transformNodeRaw(e,!0);return this.assertIsExpression(e,t)}assertIsExpression(e,t){if(void 0===t)throw new Error(`Expression visitor for node type ${i.SyntaxKind[e.kind]} did not return any result.`);return Array.isArray(t)?t[0]:t}superTransformExpression(e){const t=this.doSuperTransformNode(e);return this.assertIsExpression(e,t)}transformStatements(e){return a(e).flatMap((e=>{this.pushPrecedingStatements();const t=this.transformNode(e),n=this.popPrecedingStatements();return n.push(...t),n}))}superTransformStatements(e){return a(e).flatMap((e=>{this.pushPrecedingStatements();const t=this.superTransformNode(e),n=this.popPrecedingStatements();return n.push(...t),n}))}pushPrecedingStatements(){this.precedingStatementsStack.push([])}popPrecedingStatements(){const e=this.precedingStatementsStack.pop();return e}addPrecedingStatements(e){const t=this.precedingStatementsStack[this.precedingStatementsStack.length-1];Array.isArray(e)?t.push(...e):t.push(e)}prependPrecedingStatements(e){const t=this.precedingStatementsStack[this.precedingStatementsStack.length-1];Array.isArray(e)?t.unshift(...e):t.unshift(e)}createTempName(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"temp";return e=e.replace(/^_*/,""),Rs(`${e}_${this.nextTempId++}`)}getTempNameForLuaExpression(e){if(ae(e))return e.value;if(se(e))return`_${e.value.toString()}`;if(ve(e))return e.text;if(xe(e)){const t=this.getTempNameForLuaExpression(e.expression);if(t)return`${t}_result`}else if(_e(e)){const t=this.getTempNameForLuaExpression(e.table),n=this.getTempNameForLuaExpression(e.index);if(t||n)return`${null!==t&&void 0!==t?t:"table"}_${null!==n&&void 0!==n?n:"index"}`}}createTempNameForLuaExpression(e){const t=this.getTempNameForLuaExpression(e),n=Ee(this.createTempName(t),void 0,mr);return D(n,B(e)),n}getTempNameForNode(e){if(i.isStringLiteral(e)||i.isIdentifier(e)||i.isMemberName(e))return e.text;if(i.isNumericLiteral(e))return`_${e.text}`;if(i.isCallExpression(e)){const t=this.getTempNameForNode(e.expression);if(t)return`${t}_result`}else if(i.isElementAccessExpression(e)||i.isPropertyAccessExpression(e)){const t=this.getTempNameForNode(e.expression),n=i.isElementAccessExpression(e)?this.getTempNameForNode(e.argumentExpression):e.name.text;if(t||n)return`${null!==t&&void 0!==t?t:"table"}_${null!==n&&void 0!==n?n:"index"}`}}createTempNameForNode(e){const t=this.getTempNameForNode(e);return Ee(this.createTempName(t),e,mr)}nextSymbolId(){return++this.lastSymbolId}pushScope(e){const t={type:e,id:++this.lastScopeId};return this.scopeStack.push(t),t}popScope(){const e=this.scopeStack.pop();return e}}function gr(e,t){if(!i.isPropertyAccessExpression(t)&&!i.isElementAccessExpression(t))return!1;const n=e.checker.getTypeAtLocation(t.expression);if(!Qt(e,n))return!1;return"length"===(i.isPropertyAccessExpression(t)?t.name.text:i.isStringLiteral(t.argumentExpression)?t.argumentExpression.text:void 0)}function yr(e,t,n,r){switch(t.kind){case i.SyntaxKind.ObjectLiteralExpression:return xr(e,t,n,r);case i.SyntaxKind.ArrayLiteralExpression:return Sr(e,t,n,r)}}function Sr(e,t,n,r){return t.elements.flatMap(((s,o)=>{const a=Oe(n,oe(o+1),s);switch(s.kind){case i.SyntaxKind.ObjectLiteralExpression:return xr(e,s,a,r);case i.SyntaxKind.ArrayLiteralExpression:return Sr(e,s,a,r);case i.SyntaxKind.BinaryExpression:const c=e.createTempNameForLuaExpression(a),u=V(c,a),l=Se(c,ee(),M.EqualityOperator),{precedingStatements:p,result:d}=ur(e,(()=>Ar(e,s.left,e.transformExpression(s.right))));d.unshift(...p);const f=Ar(e,s.left,c);return[u,q(l,R(d),R(f),t)];case i.SyntaxKind.Identifier:case i.SyntaxKind.PropertyAccessExpression:case i.SyntaxKind.ElementAccessExpression:const{precedingStatements:m,result:h}=ur(e,(()=>Ar(e,s,a,r)));return[...m,...h];case i.SyntaxKind.SpreadElement:if(o!==t.elements.length-1)return[];const g=Rt(e,Le.ArraySlice,void 0,n,oe(o)),{precedingStatements:y,result:S}=ur(e,(()=>Ar(e,s.expression,g,r)));return[...y,...S];case i.SyntaxKind.OmittedExpression:default:return[]}}))}function xr(e,t,n,r){const s=[];for(const o of t.properties)switch(o.kind){case i.SyntaxKind.ShorthandPropertyAssignment:s.push(...Tr(e,o,n));break;case i.SyntaxKind.PropertyAssignment:s.push(...vr(e,o,n,r));break;case i.SyntaxKind.SpreadAssignment:s.push(...Er(e,o,n,t.properties));break;case i.SyntaxKind.MethodDeclaration:case i.SyntaxKind.GetAccessor:case i.SyntaxKind.SetAccessor:break;default:x()}return s}function Tr(e,t,n){const r=[],i=br(e,t.name),s=ce(t.name.text),o=Ar(e,t.name,Oe(n,s));r.push(...o);const a=t.objectAssignmentInitializer?e.transformExpression(t.objectAssignmentInitializer):void 0;if(a){const n=Se(i,ee(),M.EqualityOperator),s=R(Ar(e,t.name,a));r.push(q(n,s,void 0,t))}return r}function vr(e,t,n,r){const s=[];if(jt(t.initializer)){const s=Oe(n,bi(e,t.name));if(i.isObjectLiteralExpression(t.initializer))return xr(e,t.initializer,s,r);if(i.isArrayLiteralExpression(t.initializer))return Sr(e,t.initializer,s,r)}e.pushPrecedingStatements();let o=bi(e,t.name);o=ii(e,o,t.name);const a=Oe(n,o);let c;if(i.isBinaryExpression(t.initializer))if(i.isPropertyAccessExpression(t.initializer.left)||i.isElementAccessExpression(t.initializer.left)){const n=S(e.transformExpression(t.initializer.left),_e),r=t.initializer.right,{precedingStatements:s,result:o}=ur(e,(()=>e.transformExpression(r))),u=e.createTempNameForLuaExpression(n.table),l=e.createTempNameForLuaExpression(n.index),p=V([u,l],[n.table,n.index]),{precedingStatements:d,result:f}=zr(e,a,o,s,i.SyntaxKind.QuestionQuestionToken,t.initializer);c=[p,...d,W(Oe(u,l),f)]}else{c=[q(Se(e.transformExpression(t.initializer.left),ee(),M.EqualityOperator),R(Nr(e,t.initializer)),void 0,t)]}else c=Ar(e,t.initializer,a,r);return s.push(...e.popPrecedingStatements()),s.push(...c),s}function Er(e,t,n,r){const s=[];for(const a of r)if((i.isShorthandPropertyAssignment(a)||i.isPropertyAssignment(a))&&!i.isComputedPropertyName(a.name)&&!i.isPrivateIdentifier(a.name)){const t=i.isIdentifier(a.name)?ce(a.name.text):e.transformExpression(a.name);s.push(fe(te(!0),t))}const o=Rt(e,Le.ObjectRest,void 0,n,me(s));return Ar(e,t.expression,o)}function br(e,t,n){if(n&&(i.isElementAccessExpression(t)||i.isPropertyAccessExpression(t))){let n,r=e.transformExpression(t.expression);return r=ii(e,r,t.expression),i.isElementAccessExpression(t)?(n=zi(e,t),n=ii(e,n,t.argumentExpression)):n=ce(t.name.text,t.name),Oe(r,n,t)}const r=e.checker.getSymbolAtLocation(t),s=e.transformExpression(t);return ve(s)&&r&&Os(e,r)?ws(e,s):ke(s)?s:(e.diagnostics.push(Et(t,s.kind)),Ae())}function Ar(e,t,n,r,s){if(i.isOptionalChain(t))return e.diagnostics.push(ht(t)),[];if(gr(e,t)){return[Z(Rt(e,Le.ArraySetLength,s,e.transformExpression(t.expression),n))]}if((i.isPropertyAccessExpression(t)||i.isElementAccessExpression(t))&&t.expression.kind===i.SyntaxKind.SuperKeyword){const r=e.checker.getSymbolAtLocation(t);if(r&&r.flags&i.SymbolFlags.SetAccessor)return[Z(Rt(e,Le.DescriptorSet,s,Ee("self"),e.transformExpression(t.expression),i.isPropertyAccessExpression(t)?ce(t.name.text):e.transformExpression(t.argumentExpression),n))]}const o=t.parent&&i.isShorthandPropertyAssignment(t.parent)?e.checker.getShorthandAssignmentValueSymbol(t.parent):e.checker.getSymbolAtLocation(t),a=o?_s(e,o):[],c=W(br(e,t,r),n,t.parent);return[c,...a.map((t=>{const[n]=c.left;return W(ws(e,Ee(t.name)),n)}))]}function _r(e,t,n,r,i){return[...r,...Ar(e,t,n,r.length>0,i)]}function Or(e,t){let{precedingStatements:n,result:r}=ur(e,(()=>e.transformExpression(t.right)));e.addPrecedingStatements(n),dn(e,t.right)&&(r=Cn(r));const i=ii(e,r,t.right),s=function(e,t,n,r){return yr(e,t.left,n,r)}(e,t,i,n.length>0);return{statements:s,result:i}}const kr=(e,t)=>i.isArrayLiteralExpression(t.left)&&t.left.elements.every((t=>{if(gr(e,t))return!1;if(i.isPropertyAccessExpression(t)||i.isElementAccessExpression(t))return!1;if(i.isIdentifier(t)){const n=e.checker.getSymbolAtLocation(t);if(n){return 0===_s(e,n).length}}return!0}));function Nr(e,t){const n=e.checker.getTypeAtLocation(t.right),r=e.checker.getTypeAtLocation(t.left);if(cr(e,t.right,n,r),$t(t)){if(kr(e,t)){const n=e.checker.getTypeAtLocation(t.right);let r;i.isArrayLiteralExpression(t.right)?r=ci(e,t.right.elements):(r=e.transformExpression(t.right),!dn(e,t.right)&&Qt(e,n)&&(r=Pn(e,r,t.right)));return[W(t.left.elements.map((t=>br(e,t))),r,t)]}const{statements:n}=Or(e,t);return n}{const{precedingStatements:n,result:r}=ur(e,(()=>e.transformExpression(t.right)));return _r(e,t.left,r,n)}}const wr=e=>e in Fr,Fr={[i.SyntaxKind.AmpersandToken]:"band",[i.SyntaxKind.BarToken]:"bor",[i.SyntaxKind.CaretToken]:"bxor",[i.SyntaxKind.LessThanLessThanToken]:"lshift",[i.SyntaxKind.GreaterThanGreaterThanToken]:"arshift",[i.SyntaxKind.GreaterThanGreaterThanGreaterThanToken]:"rshift"};function Lr(e,t,n,r,i){const s=Fr[r];return Te(Oe(Ee(i),ce(s)),[t,n],e)}function Ir(e,t,n,r,s){switch(e.luaTarget){case F.Universal:case F.Lua50:case F.Lua51:return e.diagnostics.push(st(t,"Bitwise operations",e.luaTarget)),Lr(t,n,r,s,"bit");case F.LuaJIT:return Lr(t,n,r,s,"bit");case F.Lua52:return Lr(t,n,r,s,"bit32");default:const o=function(e,t,n){switch(n){case i.SyntaxKind.BarToken:return M.BitwiseOrOperator;case i.SyntaxKind.CaretToken:return M.BitwiseExclusiveOrOperator;case i.SyntaxKind.AmpersandToken:return M.BitwiseAndOperator;case i.SyntaxKind.LessThanLessThanToken:return M.BitwiseLeftShiftOperator;case i.SyntaxKind.GreaterThanGreaterThanToken:return e.diagnostics.push(rt(t)),M.BitwiseRightShiftOperator;case i.SyntaxKind.GreaterThanGreaterThanGreaterThanToken:return M.BitwiseRightShiftOperator}}(e,t,s);return Se(n,r,o,t)}}function Mr(e,t,n,r){let i;if(n===M.BitwiseNotOperator)i="bnot";else x();return Te(Oe(Ee(r),ce(i)),[t],e)}function Pr(e){return!(ue(e)||ve(e))}const Cr={[i.SyntaxKind.BarEqualsToken]:i.SyntaxKind.BarToken,[i.SyntaxKind.PlusEqualsToken]:i.SyntaxKind.PlusToken,[i.SyntaxKind.CaretEqualsToken]:i.SyntaxKind.CaretToken,[i.SyntaxKind.MinusEqualsToken]:i.SyntaxKind.MinusToken,[i.SyntaxKind.SlashEqualsToken]:i.SyntaxKind.SlashToken,[i.SyntaxKind.PercentEqualsToken]:i.SyntaxKind.PercentToken,[i.SyntaxKind.AsteriskEqualsToken]:i.SyntaxKind.AsteriskToken,[i.SyntaxKind.AmpersandEqualsToken]:i.SyntaxKind.AmpersandToken,[i.SyntaxKind.AsteriskAsteriskEqualsToken]:i.SyntaxKind.AsteriskAsteriskToken,[i.SyntaxKind.LessThanLessThanEqualsToken]:i.SyntaxKind.LessThanLessThanToken,[i.SyntaxKind.GreaterThanGreaterThanEqualsToken]:i.SyntaxKind.GreaterThanGreaterThanToken,[i.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken]:i.SyntaxKind.GreaterThanGreaterThanGreaterThanToken,[i.SyntaxKind.BarBarEqualsToken]:i.SyntaxKind.BarBarToken,[i.SyntaxKind.AmpersandAmpersandEqualsToken]:i.SyntaxKind.AmpersandAmpersandToken,[i.SyntaxKind.QuestionQuestionEqualsToken]:i.SyntaxKind.QuestionQuestionToken},Dr=e=>e in Cr,Kr=e=>Cr[e];function Br(e,t,n,r,i,s){const{precedingStatements:o,result:a}=function(e,t,n,r,i,s){if(gr(e,n)){const{precedingStatements:s,result:o}=Vr(e,t,n,r,i);return{precedingStatements:s,result:o.expression}}const o=e.transformExpression(n);if(!ke(o))return e.diagnostics.push(Et(t,o.kind)),{precedingStatements:[],result:o};const{precedingStatements:a,result:c}=ur(e,(()=>e.transformExpression(r)));if(_e(o)){const n=e.createTempNameForLuaExpression(o.table),r=e.createTempNameForLuaExpression(o.index),u=V([n,r],[o.table,o.index]),l=Oe(n,r),p=e.createTempNameForLuaExpression(o);if(s){const n=V(p,l),{precedingStatements:r,result:s}=zr(e,p,c,a,i,t);return{precedingStatements:[u,...r,n,W(l,s)],result:p}}{if(jr(i))return{precedingStatements:[u,...$r(l,i,c,a)],result:o};const{precedingStatements:n,result:r}=zr(e,l,c,a,i,t);return{precedingStatements:[u,...n,V(p,r),W(l,p)],result:p}}}if(s){const r=e.createTempNameForLuaExpression(o),s=V(r,o),{precedingStatements:u,result:l}=zr(e,r,c,a,i,t);return{precedingStatements:[s,...u,..._r(e,n,l,a)],result:r}}{if(a.length>0&&jr(i))return{precedingStatements:$r(o,i,c,a),result:o};const{precedingStatements:r,result:s}=zr(e,o,c,a,i,t);return{precedingStatements:_r(e,n,s,r),result:o}}}(e,t,n,r,i,s);return e.addPrecedingStatements(o),a}function Rr(e,t,n,r,i){if(gr(e,n)){const{precedingStatements:s,result:o}=Vr(e,t,n,r,i);return[...s,o]}const s=e.transformExpression(n);if(!ke(s))return e.diagnostics.push(Et(t,s.kind)),[];const{precedingStatements:o,result:a}=ur(e,(()=>e.transformExpression(r)));if(_e(s)&&function(e,t){return Pr(e.table)||Pr(e.index)||t.length>0}(s,o)){const n=e.createTempNameForLuaExpression(s.table),r=e.createTempNameForLuaExpression(s.index),c=V([n,r],[s.table,s.index]),u=Oe(n,r);if(jr(i))return[c,...$r(u,i,a,o,t)];const{precedingStatements:l,result:p}=zr(e,u,a,o,i,t);return[c,...l,W(u,p)]}{if(jr(i))return $r(s,i,a,o,t);const{precedingStatements:r,result:c}=zr(e,s,a,o,i,t);return _r(e,n,c,r)}}function jr(e){return e===i.SyntaxKind.AmpersandAmpersandToken||e===i.SyntaxKind.BarBarToken||e===i.SyntaxKind.QuestionQuestionToken}function $r(e,t,n,r,s){let o;return t===i.SyntaxKind.AmpersandAmpersandToken?o=e:t===i.SyntaxKind.BarBarToken?o=ge(e,M.NotOperator):t===i.SyntaxKind.QuestionQuestionToken?o=Se(e,ee(),M.EqualityOperator):x(),[q(o,R([...r,W(e,n,s)]),void 0,s)]}function Vr(e,t,n,r,i){const{precedingStatements:s,result:o}=ur(e,(()=>e.transformExpression(r))),a=e.transformExpression(n.expression),c=ge(a,M.LengthOperator,n),{precedingStatements:u,result:l}=zr(e,c,o,s,i,t);return{precedingStatements:u,result:Z(Rt(e,Le.ArraySetLength,t,a,l))}}const Wr=e=>e===i.SyntaxKind.AmpersandAmpersandToken||e===i.SyntaxKind.BarBarToken||e===i.SyntaxKind.QuestionQuestionToken,qr={[i.SyntaxKind.AmpersandAmpersandToken]:M.AndOperator,[i.SyntaxKind.BarBarToken]:M.OrOperator,[i.SyntaxKind.PlusToken]:M.AdditionOperator,[i.SyntaxKind.MinusToken]:M.SubtractionOperator,[i.SyntaxKind.AsteriskToken]:M.MultiplicationOperator,[i.SyntaxKind.AsteriskAsteriskToken]:M.PowerOperator,[i.SyntaxKind.SlashToken]:M.DivisionOperator,[i.SyntaxKind.PercentToken]:M.ModuloOperator,[i.SyntaxKind.GreaterThanToken]:M.GreaterThanOperator,[i.SyntaxKind.GreaterThanEqualsToken]:M.GreaterEqualOperator,[i.SyntaxKind.LessThanToken]:M.LessThanOperator,[i.SyntaxKind.LessThanEqualsToken]:M.LessEqualOperator,[i.SyntaxKind.EqualsEqualsToken]:M.EqualityOperator,[i.SyntaxKind.EqualsEqualsEqualsToken]:M.EqualityOperator,[i.SyntaxKind.ExclamationEqualsToken]:M.InequalityOperator,[i.SyntaxKind.ExclamationEqualsEqualsToken]:M.InequalityOperator};function Gr(e,t,n,r,s){if(wr(r))return Ir(e,s,t,n,r);if(r===i.SyntaxKind.QuestionQuestionToken)return i.isBinaryExpression(s),function(e,t,n,r){const s=e.checker.getTypeAtLocation(t.left);if(en(e,s)){const{precedingStatements:s,result:o}=Ur(e,n,r,[],i.SyntaxKind.QuestionQuestionToken,t);return e.addPrecedingStatements(s),o}return Se(n,r,M.OrOperator,t)}(e,s,t,n);if(r===i.SyntaxKind.PercentToken&&e.luaTarget===F.Lua50){return Te(Oe(Ee("math"),ce("mod")),[t,n],s)}let o=qr[r];if(r===i.SyntaxKind.PlusToken&&i.isBinaryExpression(s)){const r=e.checker.getTypeAtLocation(s.left),i=e.checker.getTypeAtLocation(s.right),a=Gt(e,r),c=Gt(e,i);(a||c)&&(t=a?t:Dn(t),n=c?n:Dn(n),o=M.ConcatOperator)}return Se(t,n,o,s)}function Ur(e,t,n,r,s,o){const a=e.createTempNameForLuaExpression(t),c=V(a,t,null===o||void 0===o?void 0:o.left);let u;switch(s){case i.SyntaxKind.BarBarToken:u=ge(be(a),M.NotOperator,o);break;case i.SyntaxKind.AmpersandAmpersandToken:u=be(a);break;case i.SyntaxKind.QuestionQuestionToken:u=Se(be(a),ee(),M.EqualityOperator,o)}return{precedingStatements:[c,q(u,R([...r,W(a,n)]),void 0,null===o||void 0===o?void 0:o.left)],result:a}}function zr(e,t,n,r,s,o){return r.length>0&&Wr(s)?(i.isBinaryExpression(o),Ur(e,t,n,r,s,o)):{precedingStatements:r,result:Gr(e,t,n,s,o)}}function Hr(e){if(ve(e)&&e.symbolId===mr)return;return(ve(e)||ue(e))&&void 0===e.line?void 0:xe(e)||e.kind===M.MethodCallExpression?Z(e):V(Ae(),e)}function Jr(e){for(;i.isNonNullChain(e);)e=e.expression;return e}function Qr(e,t,n){return i.isParenthesizedExpression(t)?Qr(e,t.expression,n):i.isPropertyAccessExpression(t)?Ji(e,t,n):i.isElementAccessExpression(t)?Hi(e,t,n):{expression:e.transformExpression(t)}}function Yr(e,t,n,r){if(!ri(e,t,r))return t;const i=W(n,t,r);return e.addPrecedingStatements(i),n}const Zr=new WeakMap;function Xr(e){return i.isIdentifier(e)&&Zr.has(e)}function ei(e){return Zr.get(e)}function ti(e,t){return ni(e,t,void 0).expression}function ni(e,t,n,r){const s=e.createTempName("opt"),{expression:o,chain:a}=function(e){const t=[e=Jr(e)];for(;!e.questionDotToken&&!i.isTaggedTemplateExpression(e);){const n=e.expression;i.isOptionalChain(n),e=Jr(n),t.unshift(e)}return{expression:e.expression,chain:t}}(t),c=function(e,t){const n=i.factory.createIdentifier(e);return i.setOriginalNode(n,t),Zr.set(n,{usedIdentifiers:[]}),n}(s,o);let u,l=c;for(const b of a)i.isPropertyAccessExpression(b)?l=i.factory.createPropertyAccessExpression(l,b.name):i.isElementAccessExpression(b)?l=i.factory.createElementAccessExpression(l,b.argumentExpression):i.isCallExpression(b)?l=i.factory.createCallExpression(l,void 0,b.arguments):x(),i.setOriginalNode(l,b);r&&(l=i.factory.createDeleteExpression(l),i.setOriginalNode(l,r));const{precedingStatements:p,result:d}=ur(e,(()=>{if(!n)return e.transformExpression(l);const{expression:t,thisValue:r}=Qr(e,l,n);return u=r,t})),f=Ee(e.createTempName("this"),void 0,mr);let m;const h=ei(c),g=null===h||void 0===h?void 0:h.contextualCall,{precedingStatements:y,result:S}=ur(e,(()=>{let t;return g?({expression:t,thisValue:m}=Qr(e,o,f)):t=e.transformExpression(o),t}));if(function e(t){return i.isPropertyAccessExpression(t)?e(t.expression):t}(o).kind===i.SyntaxKind.SuperKeyword&&(m=Ee("self")),g)if(m)g.params[0]=m,m===f&&e.addPrecedingStatements(V(f));else if(e.isStrict)g.params[0]=ee();else{const t=Ee("_G");if(0===p.length)g.params[0]=t;else{const n=e.createTempNameForLuaExpression(t);p.unshift(V(n,t)),g.params[0]=n}}let T;e.addPrecedingStatements(y);const v=null===h||void 0===h?void 0:h.usedIdentifiers,E=v&&v.length>0&&ve(S)&&(0===p.length||!ri(e,S,o));if(E){T=S;for(const e of v)e.text=T.text}else T=Ee(s,void 0,mr),e.addPrecedingStatements(V(T,S));if(!rn(t)||r){const t=Hr(d),n=p;return t&&n.push(t),e.addPrecedingStatements(q(Se(T,ee(),M.InequalityOperator),R(n))),{expression:ee(),thisValue:u}}if(0!==p.length||en(e,e.checker.getTypeAtLocation(o))){let t;return E?(t=Ee(e.createTempName("opt_result"),void 0,mr),e.addPrecedingStatements(V(t))):t=T,e.addPrecedingStatements(q(Se(T,ee(),M.InequalityOperator),R([...p,W(t,d)]))),{expression:t,thisValue:u}}return{expression:Se(T,d,M.AndOperator,t),thisValue:u}}function ri(e,t,n){return!ue(t)&&!(ve(t)&&t.symbolId===mr)&&!(n&&(function(e,t){let n=t;if(i.isComputedPropertyName(n)&&(n=n.expression),!i.isIdentifier(n))return!1;const r=e.checker.getSymbolAtLocation(n);return!(null===r||void 0===r||!r.declarations)&&r.declarations.some((e=>i.isVariableDeclarationList(e.parent)&&0!==(e.parent.flags&i.NodeFlags.Const)))}(e,n)||Xr(n)||n.kind===i.SyntaxKind.ThisKeyword))}function ii(e,t,n){if(!ri(e,t,n))return t;const r=e.createTempNameForLuaExpression(t),i=V(r,t,n);return e.addPrecedingStatements(i),be(r,n)}function si(e,t){const n=[],r=[];let i=-1;for(let s=0;s<t.length;++s){const{precedingStatements:o,result:a}=ur(e,(()=>e.transformExpression(t[s])));r.push(a),o.length>0&&(i=s),n.push(o)}return{transformedExpressions:r,precedingStatements:n,lastPrecedingStatementsIndex:i}}function oi(e,t,n,r,i){for(let s=0;s<n.length;++s)e.addPrecedingStatements(r[s]),s<i&&(n[s]=ii(e,n[s],t[s]));return n}function ai(e,t,n){if(t){const r=Rt(e,Le.SparseArrayPush,void 0,t,...n);e.addPrecedingStatements(Z(r))}else{const r=V(t=Ee(e.createTempName("array")),Rt(e,Le.SparseArrayNew,void 0,...n));e.addPrecedingStatements(r)}return t}function ci(e,t){const{transformedExpressions:n,precedingStatements:r,lastPrecedingStatementsIndex:s}=si(e,t),o=t.findIndex((e=>i.isSpreadElement(e)));return o>=0&&o<t.length-1||function(e,t,n,r){return r<0?0:n.slice(0,r).filter(((n,r)=>ri(e,n,t[r]))).length}(e,t,n,s)>2?function(e,t,n,r){let s,o=[];for(let a=0;a<t.length;++a)r[a].length>0&&o.length>0&&(s=ai(e,s,o),o=[]),e.addPrecedingStatements(r[a]),o.push(n[a]),i.isSpreadElement(t[a])&&(s=ai(e,s,o),o=[]);if(o.length>0&&(s=ai(e,s,o)),!s)throw new Error("Array identifier was not created");return[Rt(e,Le.SparseArraySpread,void 0,s)]}(e,t,n,r):oi(e,t,n,r,s)}function ui(e,t){const{transformedExpressions:n,precedingStatements:r,lastPrecedingStatementsIndex:i}=si(e,t);return oi(e,t,n,r,i)}function li(e,t){if(i.isOmittedExpression(t))return Ae(t);if(i.isIdentifier(t))return ps(e,t);if(i.isBindingElement(t)){if(i.isIdentifier(t.name))return ps(e,t.name);{const n=e.createTempNameForNode(t.name);return e.addPrecedingStatements(pi(e,t.name,n)),n}}x()}function pi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const s=[];for(const[a,c]of t.elements.entries()){var o;if(i.isOmittedExpression(c))continue;if(i.isArrayBindingPattern(c.name)||i.isObjectBindingPattern(c.name)){const o=i.isObjectBindingPattern(t)?c.propertyName:i.factory.createNumericLiteral(String(a+1));void 0!==o&&r.push(o),s.push(...pi(e,c.name,n,r));continue}const u=r.reduce(((t,n)=>Oe(t,bi(e,n))),n),l=ps(e,c.name),p=null!==(o=c.propertyName)&&void 0!==o?o:c.name,{precedingStatements:d,result:f}=ur(e,(()=>bi(e,p)));let m;if(s.push(...d),c.dotDotDotToken){if(a!==t.elements.length-1)continue;if(i.isObjectBindingPattern(t)){const n=[];for(const e of t.elements)e.dotDotDotToken||(i.isIdentifier(e.name)&&!e.propertyName&&n.push(e.name),e.propertyName&&e.name&&i.isIdentifier(e.propertyName)&&n.push(e.propertyName));const r=n.map((e=>fe(te(!0),ce(e.text,e))));m=Rt(e,Le.ObjectRest,void 0,u,me(r))}else m=Rt(e,Le.ArraySlice,void 0,u,oe(a))}else m=Oe(u,i.isObjectBindingPattern(t)?f:oe(a+1));if(s.push(...Bn(e,l,m)),c.initializer){const t=Ns(e,l),n=c.initializer,{precedingStatements:r,result:i}=ur(e,(()=>e.transformExpression(n)));s.push(q(Se(t,ee(),M.EqualityOperator),R([...r,W(t,i)])))}}return r.pop(),s}function di(e,t){if(t.initializer&&t.type){const n=e.checker.getTypeAtLocation(t.initializer),r=e.checker.getTypeFromTypeNode(t.type);cr(e,t.initializer,n,r)}if(i.isIdentifier(t.name)){const n=ps(e,t.name),r=t.initializer&&e.transformExpression(t.initializer),s=r&&function(){t.initializer;const n=i.skipOuterExpressions(t.initializer);return!(!i.isFunctionExpression(n)&&!i.isArrowFunction(n))&&((!i.isFunctionExpression(n)||!n.name)&&gi(e,e.checker.getTypeAtLocation(t.name)))}()?hi(r):r;return Bn(e,n,s,t)}return i.isArrayBindingPattern(t.name)||i.isObjectBindingPattern(t.name)?function(e,t,n){const r=[];if(i.isObjectBindingPattern(t)||t.elements.some((e=>i.isBindingElement(e)&&(!i.isIdentifier(e.name)||e.dotDotDotToken)))){let i;if(n){let t=e.transformExpression(n);dn(e,n)&&(t=Cn(t));const{precedingStatements:s,result:o}=ur(e,(()=>ii(e,t,n)));r.push(...s),i=o}else i=Ae();return r.push(...pi(e,t,i)),r}const s=t.elements.length>0?t.elements.map((t=>li(e,t))):Ae();if(n)if(dn(e,n))r.push(...Bn(e,s,e.transformExpression(n),n));else if(i.isArrayLiteralExpression(n)){const t=n.elements.length>0?n.elements.map((t=>e.transformExpression(t))):ee();r.push(...Bn(e,s,t,n))}else{const t=Pn(e,e.transformExpression(n),n);r.push(...Bn(e,s,t,n))}else r.push(...Bn(e,s,ee(),n));for(const o of t.elements)if(!i.isOmittedExpression(o)&&o.initializer){const t=ps(e,o.name),n=Ns(e,t);r.push(q(Se(n,ee(),M.EqualityOperator),R([W(n,e.transformExpression(o.initializer))])))}return r}(e,t.name,t.initializer):x(t.name)}function fi(e,t){if(0===(t.flags&(i.NodeFlags.Let|i.NodeFlags.Const|i.NodeFlags.Using|i.NodeFlags.AwaitUsing))){const n=i.getOriginalNode(t).getFirstToken();e.diagnostics.push(ut(n))}}function mi(e,t,n,r){const{precedingStatements:i,result:s}=ur(e,(()=>e.transformExpression(n)));if(X(s)||i.push(W(t,s)),0===i.length)return;return q(Se(t,ee(),M.EqualityOperator),R(i,r),void 0,r)}function hi(e){var t;le(e)?null===(t=e.params)||void 0===t||t.unshift(Ae()):e=pe(R([Q([Te(e,[re()])])]),[Ae()],re(),P.Inline);return Te(Ee("setmetatable"),[me(),me([fe(e,ce("__call"))])])}function gi(e,t){return t.isUnion()?t.types.some((t=>gi(e,t))):Zt(t)&&t.getProperties().length>0&&void 0===kt(e,t)}function yi(e,t){if(!i.isBlock(t)){const{precedingStatements:n,result:r}=ur(e,(()=>function(e,t){return dr(e,pr(e,t,!1),t)}(e,t)));return[...n,r]}return kn(e,e.transformStatements(t.statements))}function Si(e,t,n,r){const s=[],o=[];let a=0;for(const c of n)if(i.isObjectBindingPattern(c.name)||i.isArrayBindingPattern(c.name)){const t=Ee("____bindingPattern"+a++);if(void 0!==c.initializer){const n=mi(e,t,c.initializer);n&&s.push(n)}const n=c.name,{precedingStatements:r,result:i}=ur(e,(()=>pi(e,n,t)));o.push(...r,...i)}else if(void 0!==c.initializer){const t=mi(e,ps(e,c.name),c.initializer);t&&s.push(t)}if(r&&function(e,t){if(!e.symbolId)return!0;if(void 0===t.referencedSymbols)return!1;const n=t.referencedSymbols.get(e.symbolId);return void 0!==n&&n.length>0}(r,t)){const t=e.luaTarget===F.Lua50?ie():Cn(re());s.push(V(r,t))}return s.push(...o),s}function xi(e,t,n,r,s){const o=e.pushScope(Tn.Function);o.node=s;let a=yi(e,n);s&&function(e){var t,n;return null!==(t=null===(n=e.modifiers)||void 0===n?void 0:n.some((e=>e.kind===i.SyntaxKind.AsyncKeyword)))&&void 0!==t&&t}(s)&&(a=[Q([lr(e,a)])]);const c=Si(e,o,t,r);return e.popScope(),[[...c,...a],o]}function Ti(e,t,n){const r=[];let s,o;n&&r.push(n);let a=0;for(const c of t){if(i.isIdentifier(c.name)&&i.identifierToKeywordKind(c.name)===i.SyntaxKind.ThisKeyword)continue;const t=i.isObjectBindingPattern(c.name)||i.isArrayBindingPattern(c.name)?Ee("____bindingPattern"+a++):ps(e,c.name);c.dotDotDotToken?(s=t,o=re()):r.push(t)}return[r,o,s]}function vi(e,t){var n;t.body;const r=e.checker.getTypeAtLocation(t);let s;const o=t.parameters[0];o&&i.isIdentifier(o.name)&&i.identifierToKeywordKind(o.name)===i.SyntaxKind.ThisKeyword&&(null===(n=o.type)||void 0===n?void 0:n.kind)===i.SyntaxKind.VoidKeyword||or(e,r)===Yn.Void||(i.isArrowFunction(t)?t.parameters.length>0&&(s=Ae()):s=Fn());let a=P.None;i.isBlock(t.body)||(a|=P.Inline),(i.isFunctionDeclaration(t)||i.isMethodDeclaration(t))&&(a|=P.Declaration);const[c,u,l]=Ti(e,t.parameters,s),[p,d]=xi(e,t.parameters,t.body,l,t),f=pe(R(p),c,u,a,t);return[t.asteriskToken?Rt(e,Le.Generator,void 0,f):f,d]}function Ei(e,t){if(void 0===e.body)return ee();const[n,r]=vi(t,e),s=i.isFunctionExpression(e)&&e.name;if(s&&r.referencedSymbols){const i=t.checker.getSymbolAtLocation(e.name);if(i){if([...r.referencedSymbols].some((e=>{let[,n]=e;return n.some((e=>{var n;return(null===(n=t.checker.getSymbolAtLocation(e))||void 0===n?void 0:n.valueDeclaration)===i.valueDeclaration}))}))){const r=ps(t,e.name);return gi(t,t.checker.getTypeAtLocation(e))?t.addPrecedingStatements([V(r),W(r,hi(n))]):t.addPrecedingStatements(V(r,n)),be(r)}}}return s&&gi(t,t.checker.getTypeAtLocation(e))?hi(n):n}function bi(e,t){if(i.isComputedPropertyName(t))return e.transformExpression(t.expression);if(i.isIdentifier(t))return ce(t.text);if(i.isPrivateIdentifier(t))throw new Error("PrivateIdentifier is not supported");return e.transformExpression(t)}function Ai(e,t,n){return ms(e,n,t)}function _i(e){return e.kind===i.SyntaxKind.UndefinedKeyword||e.kind===i.SyntaxKind.NullKeyword||i.isIdentifier(e)&&"undefined"===e.text}const Oi={[i.SyntaxKind.NullKeyword]:e=>ee(e),[i.SyntaxKind.TrueKeyword]:e=>te(!0,e),[i.SyntaxKind.FalseKeyword]:e=>te(!1,e),[i.SyntaxKind.NumericLiteral]:(e,t)=>{if("Infinity"===e.text){if(t.luaTarget===F.Lua50){return Se(oe(1),oe(0),M.DivisionOperator)}return Oe(Ee("math"),ce("huge"),e)}return oe(Number(e.text),e)},[i.SyntaxKind.StringLiteral]:e=>ce(e.text,e),[i.SyntaxKind.NoSubstitutionTemplateLiteral]:e=>ce(e.text,e),[i.SyntaxKind.ObjectLiteralExpression]:(e,t)=>{const n=[],r=[],s=[],o=[];let a=-1;for(let l=0;l<e.properties.length;++l){const c=e.properties[l];t.pushPrecedingStatements();const u=c.name?bi(t,c.name):void 0;let p=t.popPrecedingStatements();if(s.push(p),p.length>0&&(a=l),t.pushPrecedingStatements(),i.isPropertyAssignment(c)){const e=t.transformExpression(c.initializer);n.push(fe(e,u,c)),r.push(c.initializer)}else if(i.isShorthandPropertyAssignment(c)){const e=t.checker.getShorthandAssignmentValueSymbol(c);e&&Sn(t,e,c.name);const i=Ai(t,e,c.name);n.push(fe(i,u,c)),r.push(c)}else if(i.isMethodDeclaration(c)){const e=Ei(c,t);n.push(fe(e,u,c)),r.push(c)}else if(i.isSpreadAssignment(c)){const e=t.checker.getTypeAtLocation(c.expression);let i;i=Qt(t,e)?Rt(t,Le.ArrayToObject,c.expression,t.transformExpression(c.expression)):t.transformExpression(c.expression),n.push(i),r.push(c.expression)}else i.isAccessor(c)?t.diagnostics.push(nt(c)):x();p=t.popPrecedingStatements(),o.push(p),p.length>0&&(a=l)}if(a>=0)for(let i=0;i<n.length;++i){const c=n[i];t.addPrecedingStatements(s[i]),i<=a&&de(c)&&c.key&&(c.key=ii(t,c.key,e.properties[i].name)),t.addPrecedingStatements(o[i]),i<a&&(de(c)?c.value=ii(t,c.value,r[i]):n[i]=ii(t,c,r[i]))}let c=[];const u=[];for(const i of n)de(i)?c.push(i):(c.length>0&&u.push(me(c)),u.push(i),c=[]);if(0===u.length)return me(c,e);if(c.length>0){const t=me(c,e);u.push(t)}return u[0].kind!==M.TableExpression&&u.unshift(me(void 0,e)),Rt(t,Le.ObjectAssign,e,...u)},[i.SyntaxKind.ArrayLiteralExpression]:(e,t)=>{!function(e,t){let n=e.elements.length-1;for(;n>=0&&_i(e.elements[n]);n--);for(let r=0;r<e.elements.length;r++)r<n&&_i(e.elements[r])&&t.diagnostics.push(xt(e.elements[r]))}(e,t);return me(ci(t,e.elements.map((e=>i.isOmittedExpression(e)?i.factory.createIdentifier("undefined"):e))).map((e=>fe(e))),e)}};function ki(e,t){const n=e.checker.getConstantValue(t);return"string"===typeof n?ce(n,t):"number"===typeof n?oe(n,t):void 0}const Ni=new Map([[_t.AdditionOperatorType,M.AdditionOperator],[_t.AdditionOperatorMethodType,M.AdditionOperator],[_t.SubtractionOperatorType,M.SubtractionOperator],[_t.SubtractionOperatorMethodType,M.SubtractionOperator],[_t.MultiplicationOperatorType,M.MultiplicationOperator],[_t.MultiplicationOperatorMethodType,M.MultiplicationOperator],[_t.DivisionOperatorType,M.DivisionOperator],[_t.DivisionOperatorMethodType,M.DivisionOperator],[_t.ModuloOperatorType,M.ModuloOperator],[_t.ModuloOperatorMethodType,M.ModuloOperator],[_t.PowerOperatorType,M.PowerOperator],[_t.PowerOperatorMethodType,M.PowerOperator],[_t.FloorDivisionOperatorType,M.FloorDivisionOperator],[_t.FloorDivisionOperatorMethodType,M.FloorDivisionOperator],[_t.BitwiseAndOperatorType,M.BitwiseAndOperator],[_t.BitwiseAndOperatorMethodType,M.BitwiseAndOperator],[_t.BitwiseOrOperatorType,M.BitwiseOrOperator],[_t.BitwiseOrOperatorMethodType,M.BitwiseOrOperator],[_t.BitwiseExclusiveOrOperatorType,M.BitwiseExclusiveOrOperator],[_t.BitwiseExclusiveOrOperatorMethodType,M.BitwiseExclusiveOrOperator],[_t.BitwiseLeftShiftOperatorType,M.BitwiseLeftShiftOperator],[_t.BitwiseLeftShiftOperatorMethodType,M.BitwiseLeftShiftOperator],[_t.BitwiseRightShiftOperatorType,M.BitwiseRightShiftOperator],[_t.BitwiseRightShiftOperatorMethodType,M.BitwiseRightShiftOperator],[_t.ConcatOperatorType,M.ConcatOperator],[_t.ConcatOperatorMethodType,M.ConcatOperator],[_t.LessThanOperatorType,M.LessThanOperator],[_t.LessThanOperatorMethodType,M.LessThanOperator],[_t.GreaterThanOperatorType,M.GreaterThanOperator],[_t.GreaterThanOperatorMethodType,M.GreaterThanOperator]]),wi=new Map([[_t.NegationOperatorType,M.NegationOperator],[_t.NegationOperatorMethodType,M.NegationOperator],[_t.BitwiseNotOperatorType,M.BitwiseNotOperator],[_t.BitwiseNotOperatorMethodType,M.BitwiseNotOperator],[_t.LengthOperatorType,M.LengthOperator],[_t.LengthOperatorMethodType,M.LengthOperator]]),Fi=new Set([_t.BitwiseAndOperatorType,_t.BitwiseAndOperatorMethodType,_t.BitwiseOrOperatorType,_t.BitwiseOrOperatorMethodType,_t.BitwiseExclusiveOrOperatorType,_t.BitwiseExclusiveOrOperatorMethodType,_t.BitwiseLeftShiftOperatorType,_t.BitwiseLeftShiftOperatorMethodType,_t.BitwiseRightShiftOperatorType,_t.BitwiseRightShiftOperatorMethodType,_t.BitwiseNotOperatorType,_t.BitwiseNotOperatorMethodType]),Li=new Set([...Fi,_t.FloorDivisionOperatorType,_t.FloorDivisionOperatorMethodType]),Ii={};for(const wa of Ni.keys())Ii[wa]=Mi;for(const wa of wi.keys())Ii[wa]=Pi;function Mi(e,t,n){Li.has(n)&&Ci(e,t,n);const r=Kt(e,t,n);if(!r)return ee();const[i,s]=ui(e,r),o=Ni.get(n);return Se(i,s,o)}function Pi(e,t,n){Li.has(n)&&Ci(e,t,n);const r=Dt(e,t,n);if(!r)return ee();const i=wi.get(n);return ge(e.transformExpression(r),i)}function Ci(e,t,n){if(e.luaTarget===F.Lua50||e.luaTarget===F.Lua51||e.luaTarget===F.Lua52||e.luaTarget===F.LuaJIT||e.luaTarget===F.Universal){const r=e.luaTarget===F.Universal?F.Lua51:e.luaTarget;n===_t.FloorDivisionOperatorType||n===_t.FloorDivisionOperatorMethodType?e.diagnostics.push(st(t,"Floor division operator",r)):e.diagnostics.push(st(t,"Native bitwise operations",r))}}const Di=[_t.TableNewType],Ki={[_t.TableDeleteType]:Bi,[_t.TableDeleteMethodType]:Bi,[_t.TableGetType]:Ri,[_t.TableGetMethodType]:Ri,[_t.TableHasType]:ji,[_t.TableHasMethodType]:ji,[_t.TableSetType]:$i,[_t.TableSetMethodType]:$i,[_t.TableAddKeyType]:Vi,[_t.TableAddKeyMethodType]:Vi,[_t.TableIsEmptyType]:Wi,[_t.TableIsEmptyMethodType]:Wi};function Bi(e,t,n){const r=Kt(e,t,n);if(!r)return ee();const[i,s]=ui(e,r);return e.addPrecedingStatements(W(Oe(i,s),ee(),t)),te(!0)}function Ri(e,t,n){const r=Kt(e,t,n);if(!r)return ee();const[i,s]=ui(e,r);return Oe(i,s,t)}function ji(e,t,n){const r=Kt(e,t,n);if(!r)return ee();const[i,s]=ui(e,r);return Se(Oe(i,s),ee(),M.InequalityOperator,t)}function $i(e,t,n){const r=Ct(e,t,n,3);if(!r)return ee();const[i,s,o]=ui(e,r);return e.addPrecedingStatements(W(Oe(i,s),o,t)),ee()}function Vi(e,t,n){const r=Ct(e,t,n,2);if(!r)return ee();const[i,s]=ui(e,r);return e.addPrecedingStatements(W(Oe(i,s),te(!0),t)),ee()}function Wi(e,t,n){const r=Dt(e,t,n);if(!r)return ee();const i=e.transformExpression(r);return Se(Te(Ee("next"),[i],t),ee(),M.EqualityOperator,t)}const qi={...Ii,...Ki},Gi=new Set(Object.keys(qi));function Ui(e,t,n){const r=e.checker.getTypeAtLocation(t.expression),i=e.checker.getTypeAtLocation(t.argumentExpression);return Qt(e,r)&&Ut(e,i)?In(n,1):n}function zi(e,t){const n=e.transformExpression(t.argumentExpression);return Ui(e,t,n)}Di.forEach((e=>Gi.add(e)));function Hi(e,t,n){const r=ki(e,t);if(r)return{expression:r};if(i.isOptionalChain(t))return ni(e,t,n);const[s,o]=ui(e,[t.expression,t.argumentExpression]),a=e.checker.getTypeAtLocation(t.expression),c=e.checker.getTypeAtLocation(t.argumentExpression);if(Gt(e,a)&&Ut(e,c))return{expression:Rt(e,Le.StringAccess,t,s,o)};const u=Ui(e,t,o);if(dn(e,t.expression)){const n=e.checker.getTypeAtLocation(t.argumentExpression);Ut(e,n)||e.diagnostics.push(dt(t));if(i.isNumericLiteral(t.argumentExpression)&&"0"===t.argumentExpression.text)return{expression:we(s)};return{expression:Te(Ee("select"),[u,s])}}if(n){const r=Yr(e,s,n,t.expression);return{expression:Oe(r,u,t),thisValue:r}}return{expression:Oe(s,u,t)}}function Ji(e,t,n){const r=e.checker.getTypeAtLocation(t.expression),s=Xr(t.expression);let o=t.name.text;const a=ds(e.checker.getSymbolAtLocation(t.name));a&&(o=a);const c=ki(e,t);if(c)return{expression:c};if(i.isCallExpression(t.expression)&&pn(e,t.expression)&&e.diagnostics.push(dt(t)),i.isOptionalChain(t))return ni(e,t,n);if(qn(r).has(jn.CompileMembersOnly)){if(s&&e.diagnostics.push(St(t)),i.isPropertyAccessExpression(t.expression)){return{expression:Oe(e.transformExpression(t.expression.expression),ce(o),t)}}return Os(e,r.symbol)&&bs(e,r.symbol)===t.expression.getSourceFile()?{expression:Oe(Ln(),ce(o),t)}:{expression:Ee(o,t)}}const u=function(e,t){const n=e.checker.getTypeAtLocation(t.expression);if(i.isIdentifier(t.expression)&&on(e,n,void 0))switch(n.symbol.name){case"NumberConstructor":return function(e,t){const n=t.name.text;switch(n){case"POSITIVE_INFINITY":if(e.luaTarget===F.Lua50){return Se(oe(1),oe(0),M.DivisionOperator)}return Oe(Ee("math"),ce("huge"),t);case"NEGATIVE_INFINITY":if(e.luaTarget===F.Lua50){return ge(Se(oe(1),oe(0),M.DivisionOperator),M.NegationOperator)}return ge(Oe(Ee("math"),ce("huge"),t),M.NegationOperator);case"NaN":return Rn(t);case"EPSILON":return Se(oe(2),oe(-52),M.PowerOperator,t);case"MIN_VALUE":case"MIN_SAFE_INTEGER":return Se(oe(-2),oe(1074),M.PowerOperator,t);case"MAX_SAFE_INTEGER":case"MAX_VALUE":return Se(oe(2),oe(1024),M.PowerOperator,t);default:e.diagnostics.push(at(t.name,"Number",n))}}(e,t);case"Math":return function(e,t){const n=t.name.text;switch(n){case"PI":const r=ce("pi",t.name);return Oe(Ee("math",t.expression),r,t);case"E":case"LN10":case"LN2":case"LOG10E":case"LOG2E":case"SQRT1_2":case"SQRT2":return oe(Math[n],t);default:e.diagnostics.push(at(t.name,"Math",n))}}(e,t);case"SymbolConstructor":Bt(e,Le.Symbol)}if(Gt(e,n))return function(e,t){if("length"===t.name.text){const n=e.transformExpression(t.expression);if(e.luaTarget===F.Lua50){return Te(Oe(Ee("string"),ce("len")),[n],t)}return ge(n,M.LengthOperator,t)}e.diagnostics.push(at(t.name,"string",t.name.text))}(e,t);if(Qt(e,n))return function(e,t){if("length"===t.name.text){const n=e.transformExpression(t.expression);return is(e,n,t)}return}(e,t);if(Zt(n))return function(e,t){switch(t.name.text){case"length":e.luaTarget!==F.Lua50&&e.luaTarget!==F.Lua51&&e.luaTarget!==F.Universal||e.diagnostics.push(st(t,"function.length",e.luaTarget));const n=Te(Oe(Ee("debug"),ce("getinfo")),[e.transformExpression(t.expression)]),r=Oe(n,ce("nparams"));return or(e,e.checker.getTypeAtLocation(t.expression))===Yn.NonVoid?Se(r,oe(1),M.SubtractionOperator):r;case"arguments":case"caller":case"displayName":case"name":e.diagnostics.push(at(t.name,"function",t.name.text))}}(e,t)}(e,t);if(u)return{expression:u};if(i.isIdentifier(t.expression)&&t.parent&&(!i.isCallExpression(t.parent)||t.parent.expression!==t)){const n=Ft(e,t);n&&Gi.has(n)&&e.diagnostics.push(ft(t))}const l=e.transformExpression(t.expression);if(n){const r=Yr(e,l,n,t.expression);return{expression:Oe(r,ce(o),t),thisValue:r}}if(t.expression.kind===i.SyntaxKind.SuperKeyword){const n=e.checker.getSymbolAtLocation(t);if(n&&n.flags&i.SymbolFlags.GetAccessor)return{expression:Rt(e,Le.DescriptorGet,t,Ee("self"),l,ce(o))}}return{expression:Oe(l,ce(o),t)}}function Qi(e,t){return Oe(Ee("__TS__Promise"),ce(e),t)}function Yi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const r=[];if(i.isStringLiteral(t)){const n=function(e,t){const n=e.checker.getSymbolAtLocation(t);return!!n&&Wn(n).has(jn.NoResolution)}(e,t)?`@NoResolution:${t.text}`:t.text;r.push(ce(n))}return Te(Ee("require"),r,n)}function Zi(e,t){return e.resolver.isReferencedAliasDeclaration(t)}function Xi(e,t,n,r){return function(e,t,n){if(n&&!(n.parameters.length<t.length))for(const[r,i]of t.entries()){const t=n.parameters[r];if(void 0!==t.valueDeclaration){const n=e.checker.getTypeAtLocation(t.valueDeclaration),r=e.checker.getTypeAtLocation(i);cr(e,i,r,n,t.name)}}}(e,t,n),ci(e,r?[r,...t]:t)}function es(e,t,n,r,i){let s,o=e.transformExpression(t);return i&&(s=e.transformExpression(i)),r.length>0&&(s&&(s=ii(e,s,i)),o=ii(e,o,t),e.addPrecedingStatements(r)),s&&n.unshift(s),[o,n]}function ts(e,t,n,r,i){const{precedingStatements:s,result:o}=ur(e,(()=>Xi(e,n,r,i)));return es(e,t,o,s)}function ns(e,t,n){if(i.isOptionalChain(t))return ti(e,t);const r=i.isCallExpression(t)?rs(t):t.tag;let{precedingStatements:s,result:o}=ur(e,(()=>Xi(e,n)));if(i.isPropertyAccessExpression(r)&&i.isIdentifier(r.name)&&Is(r.name.text,e.options)&&0===s.length){const n=e.transformExpression(r.expression);let i=r.name.text;const s=ds(e.checker.getSymbolAtLocation(r));return s&&(i=s),function(e,t,n,r){const i=C(M.MethodCallExpression,r);return i.prefixExpression=e,i.name=t,i.params=n,i}(n,Ee(i,r.name),o,t)}if(i.isElementAccessExpression(r)||i.isPropertyAccessExpression(r)){if(function(e){return!(i.isLiteralExpression(e)||i.isIdentifier(e)||e.kind===i.SyntaxKind.ThisKeyword)}(r.expression))return function(e,t,n,r){const s=Ee(e.createTempName("self")),o=V(s,e.transformExpression(t.expression));e.addPrecedingStatements(o);let a=Oe(s,i.isElementAccessExpression(t)?zi(e,t):ce(t.name.text));return r.length>0&&(a=ii(e,a),e.addPrecedingStatements(r)),Te(a,[s,...n])}(e,r,o,s);{let n;return[n,o]=es(e,r,o,s,r.expression),Te(n,o,t)}}if(i.isIdentifier(r)||i.isCallExpression(r)){const n=e.isStrict?i.factory.createNull():i.factory.createIdentifier("_G");let a;return[a,o]=es(e,r,o,s,n),Te(a,o,t)}throw new Error(`Unsupported LeftHandSideExpression kind: ${i.SyntaxKind[r.kind]}`)}function rs(e){return i.skipOuterExpressions(e.expression)}function is(e,t,n){if(e.luaTarget===F.Lua50){return Te(Oe(Ee("table"),ce("getn")),[t],n)}return ge(t,M.LengthOperator,n)}const ss=e=>i.isStringLiteral(e)&&e.text.includes("%");function os(e,t){const n=Ee("string");for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return Te(Oe(n,ce(e)),i,t)}const as=new Set(["Error","ErrorConstructor","RangeError","RangeErrorConstructor","ReferenceError","ReferenceErrorConstructor","SyntaxError","SyntaxErrorConstructor","TypeError","TypeErrorConstructor","URIError","URIErrorConstructor"]);function cs(e,t){const n=t.symbol;if(!n||n.parent)return;const r=n.name;switch(r){case"Map":case"MapConstructor":return void Bt(e,Le.Map);case"Set":case"SetConstructor":return void Bt(e,Le.Set);case"WeakMap":case"WeakMapConstructor":return void Bt(e,Le.WeakMap);case"WeakSet":case"WeakSetConstructor":return void Bt(e,Le.WeakSet);case"Promise":case"PromiseConstructor":return void Bt(e,Le.Promise)}as.has(r)&&Bt(e,Le.Error)}function us(e,t){if(t.isUnionOrIntersection())for(const n of t.types){const t=us(e,n);if(t)return t}else if(on(e,t,void 0))return t.symbol}const ls={[_t.MultiFunction]:"$multi",[_t.RangeFunction]:"$range",[_t.VarargConstant]:"$vararg"};function ps(e,t){return fs(e,t,e.checker.getSymbolAtLocation(t))}function ds(e){let t;if(e){const n=e.getDeclarations();if(n){let e;for(const t of n){const n=Un(t).get(jn.CustomName);if(n){e=n;break}}e&&(t=e.args[0])}}return t}function fs(e,t,n){if(Xr(t)){const e=Ee(t.text,void 0,mr);return ei(t).usedIdentifiers.push(e),e}const r=n?Lt(e,n):Ft(e,t);if(r)if(Gi.has(r))i.isVariableDeclaration(t.parent)&&t.parent.name===t||e.diagnostics.push(ft(t));else if(function(e,t){return void 0!==e&&ls[t]===e.name}(n,r))return function(e,t,n){n===_t.MultiFunction?e.diagnostics.push(lt(t)):n===_t.RangeFunction?e.diagnostics.push(Ye(t)):n===_t.VarargConstant&&e.diagnostics.push(Ze(t))}(e,t,r),Ae(t);const s=e.checker.getTypeAtLocation(t);if(on(e,s,void 0)&&(cs(e,s),function(e,t){if("Promise"!==t.text)return!1;const n=e.checker.getTypeAtLocation(t);return on(e,n,void 0)}(e,t)))return Ee("__TS__Promise",t);let o=Bs(e,t,n)?Rs(t.text):t.text;const a=ds(n);a&&(o=a);return Ee(o,t,xn(e,t,n),t.text)}function ms(e,t,n){if(n){const r=bs(e,n);if(r){const i=n.name;return ws(e,Ee(Bs(e,t,n)?Rs(i):i,t,xn(e,t,n),i),r)}}const r=function(e,t,n){switch(t.text){case"NaN":return Rn(t);case"Infinity":return e.luaTarget===F.Lua50?Se(oe(1),oe(0),M.DivisionOperator):Oe(Ee("math"),ce("huge"),t);case"globalThis":return Ee("_G",t,xn(e,t,n),"globalThis")}}(e,t,n);return r||fs(e,t,n)}function hs(e,t){if(!i.isSourceFile(t.parent)&&i.isModuleDeclaration(t.parent)){return Oe(hs(e,t.parent),ce(gs(e,t).text),t.name)}return gs(e,t)}function gs(e,t){const n=e.checker.getSymbolAtLocation(t.name);return void 0!==n&&Cs(n.name,e.options)?Ee(Rs(t.name.text),t.name,n&&function(e,t){return e.symbolIdMaps.get(t)}(e,n),t.name.text):ps(e,t.name)}function ys(e){if(e.body){if(i.isModuleBlock(e.body))return e.body.statements.some((e=>!i.isInterfaceDeclaration(e)&&!i.isTypeAliasDeclaration(e)));if(i.isModuleDeclaration(e.body))return!0}return!1}function Ss(e){var t;return i.canHaveModifiers(e)&&!0===(null===(t=e.modifiers)||void 0===t?void 0:t.some((e=>e.kind===i.SyntaxKind.DefaultKeyword)))}function xs(e){return!!function(e){var t;return i.canHaveModifiers(e)&&!0===(null===(t=e.modifiers)||void 0===t?void 0:t.some((e=>e.kind===i.SyntaxKind.ExportKeyword)))}(e)&&void 0===i.findAncestor(e,i.isModuleDeclaration)}const Ts=e=>ce("default",e);function vs(e){const t=e.getDeclarations();if(t)return t.find((e=>0!==(i.getCombinedModifierFlags(e)&i.ModifierFlags.Export)))}function Es(e,t){const n=function(e,t){if(void 0!==t.symbolId){const n=yn(e,t.symbolId);if(void 0!==n)return n.symbol}}(e,t);if(n)return bs(e,n)}function bs(e,t){const n=vs(t);if(!n)return;const r=tn(n,(e=>i.isSourceFile(e)||i.isModuleDeclaration(e)));if(r&&((!i.isModuleDeclaration(r)||0===(r.flags&i.NodeFlags.GlobalAugmentation))&&ks(e,t,r)))return r}function As(e,t){const n=e.checker.getSymbolAtLocation(i.isSourceFile(t)?t:t.name);if(void 0===(null===n||void 0===n?void 0:n.exports))return[];return[...{[Symbol.iterator]:()=>n.exports.values()}]}function _s(e,t){return As(e,e.sourceFile).filter((n=>{var r;return null===(r=n.declarations)||void 0===r?void 0:r.filter(i.isExportSpecifier).map(e.checker.getExportSpecifierLocalTargetSymbol).includes(t)}))}function Os(e,t){return void 0!==vs(t)||ks(e,t,e.sourceFile)}function ks(e,t,n){return As(e,n).includes(t)}function Ns(e,t){const n=Es(e,t);return n?ws(e,t,n):t}function ws(e,t,n){if(!t.exportable)return t;return Oe(n&&i.isModuleDeclaration(n)?hs(e,n):Ln(),ce(t.text))}function Fs(e){return Oe(Ln(),Ts(e),e)}const Ls=e=>e.luaTarget===F.LuaJIT,Is=(e,t)=>!Ms.has(e)&&(Ls(t)?/^[a-zA-Z_\u007F-\uFFFD][a-zA-Z0-9_\u007F-\uFFFD]*$/:/^[a-zA-Z_][a-zA-Z0-9_]*$/).test(e),Ms=new Set(["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while"]),Ps=new Set(["_G","assert","coroutine","debug","error","ipairs","math","pairs","pcall","print","rawget","repeat","require","self","string","table","tostring","type","unpack"]),Cs=(e,t)=>!Is(e,t)||Ps.has(e);function Ds(e,t,n){const r=!Is(t,e.options);return r&&""!==t&&e.diagnostics.push(ct(n,t)),r}function Ks(e,t,n){var r,s;const o=null!==(r=null===(s=t.declarations)||void 0===s?void 0:s.some((e=>{return t=e,0!==(i.getCombinedModifierFlags(t)&i.ModifierFlags.Ambient);var t})))&&void 0!==r&&r;return!(!o||!Ds(e,t.name,n))||Cs(t.name,e.options)&&!o&&!Os(e,t)}function Bs(e,t,n){return n?Ks(e,n,t):Ds(e,t.text,t)}const Rs=e=>"____"+(e=>e.replace(/[^a-zA-Z0-9_]/g,(e=>`_${e.charCodeAt(0).toString(16).toUpperCase()}`)))(e);const js=(e,t)=>fa(h(m(aa(e,t))));function $s(e){return`\nlocal ____modules = {}\nlocal ____moduleCache = {}\nlocal ____originalRequire = require\nlocal function require(file, ...)\n    if ____moduleCache[file] then\n        return ____moduleCache[file].value\n    end\n    if ____modules[file] then\n        local module = ____modules[file]\n        ____moduleCache[file] = { value = ${e.luaTarget===F.Lua50?"(table.getn(arg) > 0) and module(unpack(arg)) or module(file)":'(select("#", ...) > 0) and module(...) or module(file)'} }\n        return ____moduleCache[file].value\n    else\n        if ____originalRequire then\n            return ____originalRequire(file)\n        else\n            error("module '" .. file .. "' not found")\n        end\n    end\nend\n`}const Vs="{#SourceMapTracebackBundle}";function Ws(e){const t={};let n=1;e.walk(((e,r)=>{if(void 0!==r.line&&r.line>0){const e=((e,n)=>{const r=t[e];return void 0===r?n:"number"===typeof r?r:r.line})(n,r.line);t[n]={line:e,file:s.default.basename(r.source)}}n+=e.split("\n").length-1}));return`__TS__SourceMapTraceBack(debug.getinfo(1).short_src, ${"{"+Object.entries(t).map((e=>{let[t,n]=e;return`["${t}"] = ${r=n,"number"===typeof r?r:`{line = ${r.line}, file = "${r.file}"}`}`;var r})).join(",")+"}"});`}function qs(e,t){var n,r,i;const o=[],a=e.getCompilerOptions(),c=S(a.luaBundle,y),u=S(a.luaBundleEntry,y),l=s.default.resolve(la(e),u),p=s.default.resolve(ua(e),c),d=null!==(n=null===(r=e.getSourceFile(u))||void 0===r?void 0:r.fileName)&&void 0!==n?n:null===(i=e.getSourceFile(l))||void 0===i?void 0:i.fileName;void 0===d&&o.push(b(u));const f=t.map((t=>function(e,t){let{code:n,sourceMapNode:r}=e;return Gs([`[${t}] = function(...) \n`,null!==r&&void 0!==r?r:n," end,\n"])}(t,js(t.fileName,e)))),m=(h=f,Gs(["____modules = {\n",...h,"}\n"]));var h;const g=a.luaTarget===F.Lua50?"unpack(arg == nil and {} or arg)":"...",x=`return require(${js(null!==d&&void 0!==d?d:u,e)}, ${g})\n`,T=[];a.sourceMapTraceback&&(T.push('local __TS__SourceMapTraceBack = require("lualib_bundle").__TS__SourceMapTraceBack\n'),T.push(`${Vs}\n`));const v=[$s(a),m,...T,x];a.noHeader||v.unshift(ma);const E=Gs(v);let{code:A,map:_}=E.toStringWithSourceMap();return A=A.replace(Vs,Ws(E)),[o,{outputPath:p,code:A,sourceMap:_.toString(),sourceFiles:t.flatMap((e=>{var t;return null!==(t=e.sourceFiles)&&void 0!==t?t:[]}))}]}function Gs(e){return new je.SourceNode(null,null,null,e)}function Us(e){return function(e,t){const n=[];for(;t<e.length;){const r=e[t];if("r"!==r||0!==t&&!Qs(e[t-1])&&"]"!==e[t-1]&&"("!==e[t-1]&&"["!==e[t-1])'"'===r||"'"===r?t=Hs(e,t,r).offset:"-"===r&&t+1<e.length&&"-"===e[t+1]?t=Ys(e,t):t++;else{const r=zs(e,t);r.matched?(t=r.match.to+1,n.push(r.match)):t=r.end}}return n}(e,0)}function zs(e,t){const n=t;for(const o of"require"){if(t>e.length)return{matched:!1,end:t};if(e[t]!==o)return{matched:!1,end:t};t++}let r=!1;if((t=Js(e,t))>e.length)return{matched:!1,end:t};if("("===e[t])r=!0,t=Js(e,++t);else if('"'!==e[t]&&"'"!==e[t])return{matched:!1,end:t};if(t>e.length||'"'!==e[t]&&"'"!==e[t])return{matched:!1,end:t};const{value:i,offset:s}=Hs(e,t,e[t]);if(t=s,r){if((t=Js(e,t))>e.length||")"!==e[t])return{matched:!1,end:t};t++}return{matched:!0,match:{from:n,to:t-1,requirePath:i}}}function Hs(e,t,n){Zs(e,t,n);let r=++t,i="",s=!1;for(;t<e.length&&(e[t]!==n||s);)"\\"!==e[t]||s?(e[t]===n&&(i+=e.slice(r,t-1),r=t),s=!1):s=!0,t++;return t<e.length&&Zs(e,t,n),i+=e.slice(r,t),{value:i,offset:t+1}}function Js(e,t){for(;t<e.length&&Qs(e[t]);)t++;return t}function Qs(e){return" "===e||"\t"===e||"\r"===e||"\n"===e}function Ys(e,t){return Zs(e,t,"-"),Zs(e,t+1,"-"),(t+=2)+1<e.length&&"["===e[t]&&"["===e[t+1]?function(e,t){for(;t<e.length&&("]"!==e[t]||"]"!==e[t-1]);)t++;return t+1}(e,t):function(e,t){for(;t<e.length&&"\n"!==e[t];)t++;return t+1}(e,t)}function Zs(e,t,n){if(e[t]!==n)throw new Error(`Expected ${n} at position ${t} but found ${e[t]}`)}class Xs{constructor(e,t,n){this.program=e,this.options=t,this.emitHost=n,this.diagnostics=[],this.resolvedFiles=new Map,this.processedDependencies=new Set,this.pathToFile=new Map}addAndResolveDependencies(e){if(!this.resolvedFiles.has(e.fileName)){this.resolvedFiles.set(e.fileName,e);for(const t of Us(e.code).reverse())if(t.requirePath.startsWith("@NoResolution:")){if(!eo(this.program)){const n=t.requirePath.replace("@NoResolution:","");to(e,t,n,this.options.extension),no(e,t,n,this.options.extension)}}else this.resolveImport(e,t)}}resolveImport(e,t){if("lualib_bundle"===t.requirePath)return void this.resolvedFiles.set("lualib_bundle",{fileName:"lualib_bundle",code:""});const n=this.resolveDependencyPath(e,t.requirePath);if(!n)return this.couldNotResolveImport(t,e);if(this.options.tstlVerbose&&console.log(`Resolved ${t.requirePath} to ${f(n)}`),this.processDependency(n),r=n,!eo(this.program)||!so(r)){const r=aa(n,this.program);to(e,t,r,this.options.extension),no(e,t,r,this.options.extension)}var r}formatPathToFile(e,t){var n;const r=["/","./","../"].some((t=>e.startsWith(t))),i=s.default.dirname(t.fileName),o=r?i:null!==(n=this.options.baseUrl)&&void 0!==n?n:i;return s.default.join(o,e)}processDependency(e){if(this.processedDependencies.has(e))return;if(this.processedDependencies.add(e),t=e,n=this.program,function(e,t){const n=m(e);return oo(n+".ts",t)||oo(n+".tsx",t)||oo(n+".json",t)}(t,n)||so(t)&&eo(n))return;var t,n;const r=this.emitHost.readFile(e);if(void 0===r)return void this.diagnostics.push(E(e));const i={fileName:e,code:r};this.addAndResolveDependencies(i)}couldNotResolveImport(e,t){const n=function(e,t,n){return h(s.default.normalize(s.default.join(s.default.relative(t,n),e.requirePath)).split(s.default.sep).filter((e=>"."!==e&&".."!==e)).join(s.default.sep))}(e,ca(this.program),s.default.dirname(t.fileName));to(t,e,n,this.options.extension),no(t,e,n,this.options.extension),this.diagnostics.push(v(e.requirePath,s.default.relative(la(this.program),t.fileName)))}resolveDependencyPath(e,t){this.options.tstlVerbose&&console.log(`Resolving "${t}" from ${f(e.fileName)}`);const n=e.fileName.endsWith(".lua"),r=n?t.replace(/\./g,s.default.sep):t;if(n&&so(e.fileName)){const t=this.resolveLuaDependencyPathFromNodeModules(e,r);if(t)return t}const i=this.formatPathToFile(r,e),o=this.getFileFromPath(i);if(o)return o;if(this.options.paths&&this.options.baseUrl){const e=this.tryGetModuleNameFromPaths(r,this.options.paths,this.options.baseUrl);if(e)return e}}resolveLuaDependencyPathFromNodeModules(e,t){const n=s.default.normalize(e.fileName).split(s.default.sep);let r=n.lastIndexOf("node_modules")+2,i=n.slice(0,r).join(s.default.sep);for(;r<n.length;){const e=s.default.join(i,t),o=this.getFileFromPath(e);if(o)return o;i=s.default.join(i,n[r++])}}getFileFromPath(e){const t=this.pathToFile.get(e);if(t)return t;if(!1===t)return;const n=this.searchForFileFromPath(e);return this.pathToFile.set(e,null!==n&&void 0!==n&&n),n}searchForFileFromPath(e){const t=[e,e+".ts",s.default.join(e,"index.ts"),e+".tsx",s.default.join(e,"index.tsx")];for(const r of t)if(oo(r,this.program))return r;const n=[e+".lua",s.default.join(e,"index.lua"),s.default.join(e,"init.lua")];for(const r of n)if(this.emitHost.fileExists(r))return r}tryGetModuleNameFromPaths(e,t,n){const r=ao(f(e));for(const[o,a]of Object.entries(t)){const e=(i=f(o)).includes(".")?m(i):i,t=e.indexOf("*");if(-1!==t){const i=e.substring(0,t),o=e.substring(t+1);if(r.length>=i.length+o.length&&r.startsWith(i)&&r.endsWith(o)||!o&&r===ao(i)){const e=r.substring(i.length,r.length-o.length);for(const t of a){const r=this.getFileFromPath(s.default.join(n,t.replace("*",e)));if(r)return r}}}else if(e===r)for(const r of a){const e=this.getFileFromPath(s.default.join(n,r));if(e)return e}}var i}}function eo(e){return e.getCompilerOptions().buildMode===L.Library}function to(e,t,n,r){const i=ro(n,r);e.code=e.code=e.code.substring(0,t.from)+`require("${i}")`+e.code.substring(t.to+1)}function no(e,t,n,r){const i=ro(n,r);e.sourceMapNode&&io(e.sourceMapNode,e.sourceMapNode,`"${t.requirePath}"`,`"${i}"`)}function ro(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".lua";return t.startsWith(".")||(t=`.${t}`),e.endsWith(t)?h(e.substring(0,e.length-t.length)):h(e)}function io(e,t,n,r){if((!e.children||0===e.children.length)&&e.toString()===n)return t.children=[new je.SourceNode(e.line,e.column,e.source,[r])],!0;if(e.children)for(const i of e.children)if(io(i,e,n,r))return!0;return!1}function so(e){return s.default.normalize(e).split(s.default.sep).some((e=>"node_modules"===e))}function oo(e,t){return void 0!==t.getSourceFile(e)}function ao(e){return e.endsWith("/")||e.endsWith("\\")?e.substring(0,-1):e}function co(e,t){return e.transformStatements(i.isBlock(t)?t.statements:t)}function uo(e,t,n){e.pushScope(n);const r=kn(e,e.transformStatements(t.statements)),i=e.popScope();return[R(r,t),i]}function lo(e){var t;return!0===(null===(t=e.modifiers)||void 0===t?void 0:t.some((e=>e.kind===i.SyntaxKind.PrivateKeyword)))}function po(e){var t;return!0===(null===(t=e.modifiers)||void 0===t?void 0:t.some((e=>e.kind===i.SyntaxKind.StaticKeyword)))}function fo(e){var t;return null===(t=e.heritageClauses)||void 0===t?void 0:t.find((e=>e.token===i.SyntaxKind.ExtendsKeyword))}function mo(e){const t=fo(e);if(t)return t.types[0]}function ho(e,t){const n=[];for(const r of t){const{precedingStatements:t,result:i}=ur(e,(()=>{const t=bi(e,r.name),n=r.initializer?e.transformExpression(r.initializer):void 0;return W(Oe(Fn(),t),n,r)}));n.push(...t,i)}return n}function go(e,t,n){if(!t.initializer)return;const r=bi(e,t.name),i=e.transformExpression(t.initializer);return W(Oe(be(n),r),i)}function yo(e){return Oe(be(e),ce("prototype"))}function So(e){return Oe(yo(e),ce("____constructor"))}function xo(e,t,n,r,s){if(!t.body)return;const o=e.pushScope(Tn.Function),a=yi(e,t.body),[c,u,l]=Ti(e,t.parameters,Fn()),p=Si(e,o,t.parameters,l),d=t.parameters.filter((e=>void 0!==e.modifiers)),f=ho(e,r);if((d.length>0||f.length>0)&&t.body&&t.body.statements.length>0){const e=t.body.statements.findIndex((e=>i.isExpressionStatement(e)&&i.isCallExpression(e.expression)&&e.expression.expression.kind===i.SyntaxKind.SuperKeyword));-1!==e&&p.push(...a.splice(0,e+1))}for(const g of d)if(i.isIdentifier(g.name)){const t=W(Oe(Fn(),ce(g.name.text)),ps(e,g.name));p.push(t)}p.push(...f),p.push(...a);const m=R(p),h=-1===t.pos;return e.popScope(),W(So(n),pe(m,c,u,P.Declaration),h?s:t)}function To(e,t){return po(e)?be(t):yo(t)}function vo(e,t){const n=bi(e,t.name);return ae(n)&&"toString"===n.value?ce("__tostring",t.name):n}function Eo(e,t,n){var r,s;if(!t.body)return[];const o=To(t,n),a=vo(e,t),[c]=vi(e,t),u=(null!==(r=null===(s=i.getDecorators(t))||void 0===s?void 0:s.length)&&void 0!==r?r:0)>0,l=t.parameters.some((e=>{var t,n;return(null!==(t=null===(n=i.getDecorators(e))||void 0===n?void 0:n.length)&&void 0!==t?t:0)>0}));return u||l?e.options.experimentalDecorators?[W(Oe(o,a),c),Z(Ao(e,t,c,n))]:[W(Oe(o,a),Ao(e,t,c,n),t)]:[W(Oe(o,a),c,t)]}function bo(e,t){const n=t.expression,r=e.checker.getTypeAtLocation(n);return or(e,r)===Yn.Void&&e.diagnostics.push(Je(t)),e.transformExpression(n)}function Ao(e,t,n,r){var s,o;const a=No(e,t),c=null!==(s=null===(o=i.getDecorators(t))||void 0===o?void 0:o.map((t=>bo(e,t))))&&void 0!==s?s:[],u=vo(e,t);if(e.options.experimentalDecorators){const n=To(t,r);return ko(e,t.kind,[...c,...a],n,u)}return Oo(e,r,n,c,{kind:ce("method"),name:u,private:te(lo(t)),static:te(po(t))})}function _o(e,t,n){var r;const s=null!==(r=i.getDecorators(t))&&void 0!==r?r:[],o=s.map((t=>bo(e,t)));if(e.options.experimentalDecorators){const r=bi(e,t.name),i=To(t,n);return ko(e,t.kind,o,i,r)}for(const a of s){const n=e.checker.getResolvedSignature(a),r=null===n||void 0===n?void 0:n.getReturnType();r&&0===(r.flags&i.TypeFlags.Void)&&e.diagnostics.push(bt(t))}return Oo(e,n,ee(),o,{kind:ce("field"),name:ce(t.name.getText()),private:te(lo(t)),static:te(po(t))})}function Oo(e,t,n,r,i){const s=me(r.map((e=>fe(e)))),o=(a=i,me(Object.entries(a).map((e=>{let[t,n]=e;return fe(n,ce(t))}))));var a;return Rt(e,Le.Decorate,void 0,t,n,s,o)}function ko(e,t,n,r,s){const o=[me(n.map((e=>fe(e)))),r];if(s){o.push(s);const e=t===i.SyntaxKind.MethodDeclaration||t===i.SyntaxKind.GetAccessor||t===i.SyntaxKind.SetAccessor;o.push(e?te(!0):ee())}return Rt(e,Le.DecorateLegacy,void 0,...o)}function No(e,t){return t.parameters.flatMap(((n,r)=>{var s;return null===(s=i.getDecorators(n))||void 0===s?void 0:s.map((n=>Rt(e,Le.DecorateParam,t,oe(r),bo(e,n))))})).filter(y)}function wo(e,t,n){var r;const[s,o,a]=Ti(e,t.parameters,Fn()),c=pe(R(t.body?xi(e,t.parameters,t.body,a)[0]:[]),s,o,P.Declaration);return null!==(r=i.getDecorators(t))&&void 0!==r&&r.length?function(e,t,n,r){var s,o;const a=null!==(s=null===(o=i.getDecorators(t))||void 0===o?void 0:o.map((t=>bo(e,t))))&&void 0!==s?s:[],c=bi(e,t.name);if(e.options.experimentalDecorators){const n=To(t,r);return ko(e,t.kind,a,n,c)}return Oo(e,r,n,a,{kind:ce(t.kind===i.SyntaxKind.SetAccessor?"setter":"getter"),name:c,private:te(lo(t)),static:te(po(t))})}(e,t,c,n):c}function Fo(e,t,n){let{firstAccessor:r,getAccessor:i,setAccessor:s}=t;const o=bi(e,r.name),a=me([]);if(i){const t=wo(e,i,n);a.fields.push(fe(t,ce("get")))}if(s){const t=wo(e,s,n);a.fields.push(fe(t,ce("set")))}const c=po(r),u=c?be(n):yo(n),l=c?Le.ObjectDefineProperty:Le.SetDescriptor,p=[u,o,a];c||p.push(te(!0));return Z(Rt(e,l,void 0,...p))}function Lo(e,t,n,r,s){const o=[],a=Rt(e,Le.Class,t),c=Ss(t)?Oe(Ln(),Ts(t)):void 0;if(c?o.push(W(c,a,t)):o.push(...Bn(e,n,a,t)),c)o.push(V(r,c));else{const t=Es(e,n);t&&o.push(V(r,ws(e,be(n),t)))}if(o.push(W(Oe(be(r),ce("name")),function(e,t){if(e.name)return ce(e.name.text);if(i.isVariableDeclaration(e.parent)&&i.isIdentifier(e.parent.name))return ce(e.parent.name.text);if(Ss(e))return ce("default");if(mo(e))return Oe(t,ce("name"));return ce("")}(t,n),t)),s){const n=mo(t);o.push(Z(Rt(e,Le.ClassExtends,fo(t),be(r),e.transformExpression(n.expression))))}return o}function Io(e,t){const{statements:n,name:r}=Mo(e,t);return t.addPrecedingStatements(n),r}function Mo(e,t,n){let r;r=void 0!==n?n:void 0!==e.name?ps(t,e.name):Ee(t.createTempName("class"),e);const s=mo(e),o=function(e,t){const n=mo(t);return n&&e.checker.getTypeAtLocation(n)}(t,e);t.classSuperInfos.push({className:r,extendedTypeNode:s});const a=e.members.filter(i.isPropertyDeclaration).filter((e=>e.initializer)).filter((e=>!po(e))),c=[];let u;Cs(r.text,t.options)?(u=Ee(Rs(r.text),void 0,r.symbolId,r.text),D(u,r)):u=r,c.push(...Lo(t,e,r,u,o));const l=e.members.find((e=>i.isConstructorDeclaration(e)&&void 0!==e.body));if(l){const n=xo(t,l,u,a,e);n&&c.push(n);const r=function(e,t,n){const r=No(e,t);if(r.length>0)return Z(ko(e,t.kind,r,n))}(t,l,u);r&&c.push(r)}else if(o){if(a.length>0){const n=ho(t,a),r=t.luaTarget===F.Lua50?Te(Ee("unpack"),[ie()]):re(),s=Z(Te(Oe(t.transformExpression(i.factory.createSuper()),ce("____constructor")),[Fn(),r]));n.unshift(s);const o=pe(R(n),[Fn()],re(),P.Declaration);c.push(W(So(u),o,e))}}else{const n=xo(t,i.factory.createConstructorDeclaration([],[],i.factory.createBlock([],!0)),u,a,e);n&&c.push(n)}for(const d of e.members)if(i.isMethodDeclaration(d)){const e=Eo(t,d,u);c.push(...e)}for(const d of e.members)if(i.isAccessor(d)){const n=t.checker.getSymbolAtLocation(d.name);if(!n)continue;const r=Po(e,n,t);if(r.firstAccessor!==d)continue;const i=Fo(t,r,u);i&&c.push(i)}else if(i.isPropertyDeclaration(d)){var p;if(po(d)){const e=go(t,d,u);e&&c.push(e)}null!==(p=i.getDecorators(d))&&void 0!==p&&p.length&&c.push(Z(_o(t,d,r)))}else if(i.isClassStaticBlockDeclaration(d)&&d.body.statements.length>0){const e=Te(pe(R(t.transformStatements(d.body.statements)),[Ee("self")]),[r]);c.push(Z(e,d))}if(i.canHaveDecorators(e)&&i.getDecorators(e)){const n=function(e,t,n){var r,s,o,a;const c=null!==(r=null===(s=i.getDecorators(t))||void 0===s?void 0:s.map((t=>bo(e,t))))&&void 0!==r?r:[];return e.options.experimentalDecorators?ko(e,t.kind,c,n):Oo(e,n,n,c,{kind:ce("class"),name:ce(null!==(o=null===(a=t.name)||void 0===a?void 0:a.getText())&&void 0!==o?o:"")})}(t,e,u),s=W(u,n);if(c.push(s),xs(e)){const n=W(Ss(e)?Fs(e):ws(t,r),u);c.push(n)}}return t.classSuperInfos.pop(),{statements:c,name:r}}function Po(e,t,n){const r=e.members.find((e=>i.isGetAccessor(e)&&n.checker.getSymbolAtLocation(e.name)===t)),s=e.members.find((e=>i.isSetAccessor(e)&&n.checker.getSymbolAtLocation(e.name)===t));return{firstAccessor:r&&(!s||r.pos<s.pos)?r:s,setAccessor:s,getAccessor:r}}function Co(e,t){!1!==t.options.strictNullChecks&&(i.isElementAccessExpression(e)||Xt(t,t.checker.getTypeAtLocation(e))||t.diagnostics.push(mt(e)))}function Do(e,t){const[n,r]=uo(e,t.block,Tn.Catch),i=t.variableDeclaration?ps(e,t.variableDeclaration.name):void 0;return[pe(n,i?[be(i)]:[]),r]}function Ko(e,t){e.pushScope(Tn.Loop);const n=kn(e,co(e,t.statement)),r=e.popScope(),i=r.id;switch(r.loopContinued){case void 0:case vn.WithContinue:return n;case vn.WithGoto:return[j(n),H(`__continue${i}`)];case vn.WithRepeatBreak:const e=Ee(`__continue${i}`),t=te(!0),r=[];let s=!1;for(const i of n)if(r.push(i),i.kind===M.BreakStatement){s=!0;break}return s||r.push(W(e,t)),[j([V(e),U(R(r),t),q(ge(e,M.NotOperator),R([Y()]))])]}}function Bo(e,t){return fi(e,t),0===t.declarations.length?i.factory.createIdentifier("____"):t.declarations[0].name}function Ro(e,t,n){const r=Ee("____value");if(e.pushScope(Tn.LoopInitializer),i.isVariableDeclarationList(t)){const s=Bo(e,t);if(!i.isArrayBindingPattern(s)&&!i.isObjectBindingPattern(s))return e.popScope(),ps(e,s);{const{precedingStatements:t,result:i}=ur(e,(()=>pi(e,s,r)));n.statements.unshift(...t,...i)}}else n.statements.unshift(...jt(t)?yr(e,t,r,!1):Ar(e,t,r));return e.popScope(),r}function jo(e){if(he(e)&&e.operator===M.NotOperator)return e.operand;{const t=ge(e,M.NotOperator);return D(t,B(e)),t}}function $o(e,t,n,r,s){e.pushPrecedingStatements();let o=[];if(i.isVariableDeclarationList(t.initializer)){const n=Bo(e,t.initializer);i.isArrayBindingPattern(n)?o=n.elements.map((t=>li(e,t))):e.diagnostics.push(s(n))}else i.isArrayLiteralExpression(t.initializer)?(o=t.initializer.elements.map(((e,t)=>Ee(`____value${t}`))),o.length>0&&n.statements.unshift(W(t.initializer.elements.map((t=>S(e.transformExpression(t),ke))),o))):e.diagnostics.push(s(t.initializer));return 0===o.length&&o.push(Ae()),n.statements.unshift(...e.popPrecedingStatements()),z(n,o,[r],t)}function Vo(e,t){return function(e,t){return i.isIdentifier(t)&&"$range"===t.text&&Ft(e,t)===_t.RangeFunction}(e,t.expression)}function Wo(e,t,n){var r;i.isCallExpression(t.expression);const s=null!==(r=function(e,t){if(!i.isVariableDeclarationList(t.initializer))return void e.diagnostics.push(Xe(t.initializer));const n=Bo(e,t.initializer);if(i.isIdentifier(n))return ps(e,n);e.diagnostics.push(Xe(t.initializer))}(e,t))&&void 0!==r?r:Ae(t.initializer),[o=oe(0),a=oe(0),c]=Xi(e,t.expression.arguments,e.checker.getResolvedSignature(t.expression));return function(e,t,n,r,i,s){const o=C(M.ForStatement,s);return o.body=e,o.controlVariable=t,o.controlVariableInitializer=n,o.limitExpression=r,o.stepExpression=i,o}(n,s,o,a,c,t)}function qo(e,t){t.moduleSpecifier;const n=Yi(e,t.moduleSpecifier);if(t.exportClause&&i.isNamespaceExport(t.exportClause)){return W(Oe(Ln(),ce(t.exportClause.name.text)),n)}const r=[],s=Ee("____export"),o=V(s,n);r.push(o);const a=Ee("____exportKey"),c=Ee("____exportValue"),u=R([W(Oe(Ln(),a),c)]),l=q(Se(be(a),ce("default"),M.InequalityOperator),u),p=Ee("pairs"),d=z(R([l]),[be(a),be(c)],[Te(p,[be(s)])]);return r.push(d),j(r,t)}function Go(e,t){var n;const r=t.name,s=null!==(n=t.propertyName)&&void 0!==n?n:t.name;let o;if(i.isIdentifier(s)){const n=e.checker.getExportSpecifierLocalTargetSymbol(t);o=Ai(e,n,s)}else o=ce(r.text,s);if((e=>e.name&&i.isIdentifier(e.name)&&i.identifierToKeywordKind(e.name)===i.SyntaxKind.DefaultKeyword||e.propertyName&&i.isIdentifier(e.propertyName)&&i.identifierToKeywordKind(e.propertyName)===i.SyntaxKind.DefaultKeyword)(t)){return W(Fs(t),o,t)}return W(Oe(Ln(),ce(r.text),r),o,t)}const Uo=e=>{for(const t of e){if(i.isBreakStatement(t)||i.isReturnStatement(t))return!0;if(i.isBlock(t)&&Uo(t.statements))return!0;if(t.kind===i.SyntaxKind.SyntaxList){const e=[];if(i.forEachChild(t,(t=>e.push(t))),Uo(e))return!0}}return!1},zo=(e,t,n,r)=>r.length>0?Ur(e,t,n,r,i.SyntaxKind.BarBarToken):{precedingStatements:r,result:Se(t,n,M.OrOperator)},Ho=(e,t,n,r,i)=>{const{precedingStatements:s,result:o}=ur(i,(()=>i.transformExpression(r))),a=Se(n,o,M.EqualityOperator);return e?zo(i,e,a,s):{precedingStatements:[...t,...s],result:a}};function Jo(e){let t=e.getText();const n=e.kind===i.SyntaxKind.NoSubstitutionTemplateLiteral||e.kind===i.SyntaxKind.TemplateTail;return t=t.substring(1,t.length-(n?1:2)),t=t.replace(/\r\n?/g,"\n"),t}const Qo=(e,t)=>(i.isConstTypeReference(e.type)||cr(t,e,t.checker.getTypeAtLocation(e.expression),t.checker.getTypeAtLocation(e.type)),t.transformExpression(e.expression)),Yo={...Oi,...{[i.SyntaxKind.TypeAliasDeclaration]:()=>{},[i.SyntaxKind.InterfaceDeclaration]:()=>{},[i.SyntaxKind.NonNullExpression]:(e,t)=>t.transformExpression(e.expression),[i.SyntaxKind.ExpressionWithTypeArguments]:(e,t)=>t.transformExpression(e.expression),[i.SyntaxKind.SatisfiesExpression]:(e,t)=>t.transformExpression(e.expression),[i.SyntaxKind.AsExpression]:Qo,[i.SyntaxKind.TypeAssertionExpression]:Qo,[i.SyntaxKind.NotEmittedStatement]:()=>{}},[i.SyntaxKind.ArrowFunction]:Ei,[i.SyntaxKind.AwaitExpression]:(e,t)=>{Vt(e)||t.diagnostics.push(gt(e));const n=t.transformExpression(e.expression);return Rt(t,Le.Await,e,n)},[i.SyntaxKind.BinaryExpression]:(e,t)=>{const n=e.operatorToken.kind,r=function(e,t){const n=t.operatorToken.kind;if(n!==i.SyntaxKind.EqualsEqualsToken&&n!==i.SyntaxKind.EqualsEqualsEqualsToken&&n!==i.SyntaxKind.ExclamationEqualsToken&&n!==i.SyntaxKind.ExclamationEqualsEqualsToken)return;let r,s;if(i.isTypeOfExpression(t.left))s=t.left,r=t.right;else{if(!i.isTypeOfExpression(t.right))return;s=t.right,r=t.left}const o=e.transformExpression(r);if(!ae(o))return;"object"===o.value?o.value="table":"undefined"===o.value&&(o.value="nil");const a=e.transformExpression(s.expression),c=Te(Ee("type"),[a],s),{precedingStatements:u,result:l}=zr(e,c,o,[],n,t);return e.addPrecedingStatements(u),l}(t,e);if(r)return r;if(Dr(n)){const r=Kr(n);return Br(t,e,e.left,e.right,r,!1)}switch(n){case i.SyntaxKind.EqualsToken:return function(e,t){const n=e.checker.getTypeAtLocation(t.right),r=e.checker.getTypeAtLocation(t.left);if(cr(e,t.right,n,r),gr(e,t.left))return Rt(e,Le.ArraySetLength,t,e.transformExpression(t.left.expression),e.transformExpression(t.right));if($t(t)){const{statements:n,result:r}=Or(e,t);return e.addPrecedingStatements(n),r}if(i.isPropertyAccessExpression(t.left)||i.isElementAccessExpression(t.left)){const{precedingStatements:n,result:r}=ur(e,(()=>e.transformExpression(t.right))),i=br(e,t.left,n.length>0);e.addPrecedingStatements(n);const s=ii(e,r,t.right);return e.addPrecedingStatements(W(i,s,t.left)),s}{const n=e.transformExpression(t.left),r=e.transformExpression(t.right);return e.addPrecedingStatements(Ar(e,t.left,r)),n}}(t,e);case i.SyntaxKind.InKeyword:{const n=t.transformExpression(e.left);return Se(Oe(t.transformExpression(e.right),n),ee(),M.InequalityOperator,e)}case i.SyntaxKind.InstanceOfKeyword:{const n=t.transformExpression(e.left),r=t.transformExpression(e.right),i=t.checker.getTypeAtLocation(e.right);return on(t,i,"ObjectConstructor")?Rt(t,Le.InstanceOfObject,e,n):Rt(t,Le.InstanceOf,e,n,r)}case i.SyntaxKind.CommaToken:{const n=t.transformStatements(i.factory.createExpressionStatement(e.left)),{precedingStatements:r,result:s}=ur(t,(()=>t.transformExpression(e.right)));return n.push(...r),t.addPrecedingStatements(n),s}case i.SyntaxKind.QuestionQuestionToken:case i.SyntaxKind.AmpersandAmpersandToken:case i.SyntaxKind.BarBarToken:{const{precedingStatements:r,result:i}=function(e,t,n){const r=e.transformExpression(t.left),{precedingStatements:i,result:s}=ur(e,(()=>e.transformExpression(t.right)));return zr(e,r,s,i,n,t)}(t,e,n);return t.addPrecedingStatements(r),i}}const{precedingStatements:s,result:[o,a]}=ur(t,(()=>ui(t,[e.left,e.right]))),{precedingStatements:c,result:u}=zr(t,o,a,s,n,e);return t.addPrecedingStatements(c),u},[i.SyntaxKind.Block]:(e,t)=>{t.pushScope(Tn.Block);const n=kn(t,t.transformStatements(e.statements));return t.popScope(),j(n,e)},[i.SyntaxKind.BreakStatement]:(e,t)=>Y(e),[i.SyntaxKind.CallExpression]:(e,t)=>{var n;const r=rs(e);if(r.kind===i.SyntaxKind.ImportKeyword)return((e,t)=>{Bt(t,Le.Promise);const n=e.arguments.length>0?Yi(t,e.arguments[0],e):ee();return Te(Qi("resolve",e),[n],e)})(e,t);if(i.isOptionalChain(e))return ti(t,e);const s=i.isIdentifier(r)?ei(r):void 0,o=dn(t,e)&&mn(t,e),a=null!==(n=function(e,t){const n=e.checker.getTypeAtLocation(t.expression);if(i.isIdentifier(t.expression)&&on(e,n,void 0)){cs(e,n);const r=function(e,t,n){function r(){const n=e.checker.getResolvedSignature(t);return Xi(e,t.arguments,n)}const i=n.symbol.name;switch(i){case"SymbolConstructor":return Rt(e,Le.Symbol,t,...r());case"NumberConstructor":return Rt(e,Le.Number,t,...r());case"StringConstructor":return function(e){const t=Ee("tostring",e.expression);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Te(t,r,e)}(t,...r());case"isNaN":case"isFinite":const s=Ut(e,n)?r():[Rt(e,Le.Number,void 0,...r())];return Rt(e,"isNaN"===i?Le.NumberIsNaN:Le.NumberIsFinite,t,...s);case"parseFloat":return Rt(e,Le.ParseFloat,t,...r());case"parseInt":return Rt(e,Le.ParseInt,t,...r())}}(e,t,n);if(r)return r}const r=i.getOriginalNode(rs(t));if(i.isPropertyAccessExpression(r)){const n=function(e,t,n){const r=e.checker.getTypeAtLocation(n.expression),i=us(e,r);if(!i||i.parent)return;let s;switch(i.name){case"ArrayConstructor":s=function(e,t,n){const r=e.checker.getResolvedSignature(t),i=Xi(e,t.arguments,r),s=n.name.text;switch(s){case"from":return Rt(e,Le.ArrayFrom,t,...i);case"isArray":return Rt(e,Le.ArrayIsArray,t,...i);case"of":return Cn(...i);default:e.diagnostics.push(at(n.name,"Array",s))}}(e,t,n);break;case"Console":s=function(e,t,n){const r=n.name.text,i=e.checker.getResolvedSignature(t),s=Xi(e,t.arguments,i);switch(r){case"error":case"info":case"log":case"warn":if(t.arguments.length>0&&ss(t.arguments[0])){const e=Te(Oe(Ee("string"),ce("format")),s);return Te(Ee("print"),[e])}return Te(Ee("print"),s);case"assert":if(t.arguments.length>1&&ss(t.arguments[1])){const e=Te(Oe(Ee("string"),ce("format")),s.slice(1));return Te(Ee("assert"),[s[0],e])}return Te(Ee("assert"),s);case"trace":if(t.arguments.length>0&&ss(t.arguments[0])){const e=Te(Oe(Ee("string"),ce("format")),s),t=Te(Oe(Ee("debug"),ce("traceback")),[e]);return Te(Ee("print"),[t])}const i=Te(Oe(Ee("debug"),ce("traceback")),s);return Te(Ee("print"),[i]);default:e.diagnostics.push(at(n.name,"console",r))}}(e,t,n);break;case"MapConstructor":s=function(e,t,n){const r=Xi(e,t.arguments),i=n.name.text;if("groupBy"===i)return Rt(e,Le.MapGroupBy,t,...r);e.diagnostics.push(at(n.name,"Map",i))}(e,t,n);break;case"Math":s=function(e,t,n){const r=e.checker.getResolvedSignature(t),i=Xi(e,t.arguments,r),s=Ee("math"),o=n.name.text;switch(o){case"atan2":if(e.luaTarget===F.Universal)return Rt(e,Le.MathAtan2,t,...i);return Te(Oe(s,ce(e.luaTarget===F.Lua53?"atan":"atan2")),i,t);case"log10":case"log2":return Se(Te(Oe(s,ce("log")),i),oe("log10"===o?Math.LN10:Math.LN2),M.DivisionOperator,t);case"log1p":{var a;const e=ce("log"),n=Se(oe(1),null!==(a=i[0])&&void 0!==a?a:ee(),M.AdditionOperator);return Te(Oe(s,e),[n],t)}case"pow":var c,u;return Se(null!==(c=i[0])&&void 0!==c?c:ee(),null!==(u=i[1])&&void 0!==u?u:ee(),M.PowerOperator,t);case"round":{var l;const e=ce("floor"),n=oe(.5),r=Se(null!==(l=i[0])&&void 0!==l?l:ee(),n,M.AdditionOperator);return Te(Oe(s,e),[r],t)}case"sign":return Rt(e,Le.MathSign,t,...i);case"trunc":return Rt(e,Le.MathTrunc,t,...i);case"abs":case"acos":case"asin":case"atan":case"ceil":case"cos":case"exp":case"floor":case"log":case"max":case"min":case"random":case"sin":case"sqrt":case"tan":return Te(Oe(s,ce(o)),i,t);default:e.diagnostics.push(at(n.name,"Math",o))}}(e,t,n);break;case"StringConstructor":s=function(e,t,n){const r=e.checker.getResolvedSignature(t),i=Xi(e,t.arguments,r),s=n.name.text;if("fromCharCode"===s)return Te(Oe(Ee("string"),ce("char")),i,t);e.diagnostics.push(at(n.name,"String",s))}(e,t,n);break;case"ObjectConstructor":s=function(e,t,n){const r=Xi(e,t.arguments),i=n.name.text;switch(i){case"assign":return Rt(e,Le.ObjectAssign,t,...r);case"defineProperty":return Rt(e,Le.ObjectDefineProperty,t,...r);case"entries":return Rt(e,Le.ObjectEntries,t,...r);case"fromEntries":return Rt(e,Le.ObjectFromEntries,t,...r);case"getOwnPropertyDescriptor":return Rt(e,Le.ObjectGetOwnPropertyDescriptor,t,...r);case"getOwnPropertyDescriptors":return Rt(e,Le.ObjectGetOwnPropertyDescriptors,t,...r);case"groupBy":return Rt(e,Le.ObjectGroupBy,t,...r);case"keys":return Rt(e,Le.ObjectKeys,t,...r);case"values":return Rt(e,Le.ObjectValues,t,...r);default:e.diagnostics.push(at(n.name,"Object",i))}}(e,t,n);break;case"SymbolConstructor":s=function(e,t,n){const r=e.checker.getResolvedSignature(t),i=Xi(e,t.arguments,r),s=n.name.text;switch(s){case"for":case"keyFor":Bt(e,Le.SymbolRegistry);return Te(Ee(`__TS__SymbolRegistry${s[0].toUpperCase()+s.slice(1)}`),i,t);default:e.diagnostics.push(at(n.name,"Symbol",s))}}(e,t,n);break;case"NumberConstructor":s=function(e,t,n){const r=Xi(e,t.arguments),i=n.name.text;switch(i){case"isInteger":return Rt(e,Le.NumberIsInteger,t,...r);case"isNaN":return Rt(e,Le.NumberIsNaN,t,...r);case"isFinite":return Rt(e,Le.NumberIsFinite,t,...r);case"parseInt":return Rt(e,Le.NumberParseInt,t,...r);case"parseFloat":return Rt(e,Le.NumberParseFloat,t,...r);default:e.diagnostics.push(at(n.name,"Number",i))}}(e,t,n);break;case"PromiseConstructor":s=function(e,t,n){const r=e.checker.getResolvedSignature(t),i=Xi(e,t.arguments,r),s=n.name.text;switch(s){case"all":return Rt(e,Le.PromiseAll,t,...i);case"allSettled":return Rt(e,Le.PromiseAllSettled,t,...i);case"any":return Rt(e,Le.PromiseAny,t,...i);case"race":return Rt(e,Le.PromiseRace,t,...i);case"resolve":return Bt(e,Le.Promise),Te(Qi("resolve",n),i,t);case"reject":return Bt(e,Le.Promise),Te(Qi("reject",n),i,t);default:e.diagnostics.push(at(n.name,"Promise",s))}}(e,t,n)}s&&n.questionDotToken&&e.diagnostics.push(yt(n));return s}(e,t,r);if(n)return n;const s=function(e,t,n){const r=e.checker.getTypeAtLocation(t.expression),s=us(e,r);if(!s)return;const o=s.parent;if(!o||o.parent)return;switch(o.name){case"String":return function(e,t,n){var r;const i=e.checker.getResolvedSignature(t),[s,o]=ts(e,n.expression,t.arguments,i),a=n.name.text;switch(a){case"replace":return Rt(e,Le.StringReplace,t,s,...o);case"replaceAll":return Rt(e,Le.StringReplaceAll,t,s,...o);case"concat":return Te(Oe(Ee("table"),ce("concat")),[Cn(s,...o)],t);case"indexOf":var c;return Se(Se(os("find",t,s,null!==(c=o[0])&&void 0!==c?c:ee(),o[1]?Te(Oe(Ee("math"),ce("max")),[In(o[1],1),oe(1)]):ee(),te(!0)),oe(0),M.OrOperator),oe(1),M.SubtractionOperator,t);case"substr":return Rt(e,Le.StringSubstr,t,s,...o);case"substring":return Rt(e,Le.StringSubstring,t,s,...o);case"slice":{const n=Mn(o[0]);if(o[0]&&void 0!==n){let e=[In(o[0],n<0?0:1)];if(o[1]){const t=Mn(o[1]);void 0!==t?e.push(In(o[1],t<0?-1:0)):e=void 0}if(e)return os("sub",t,s,...e)}return Rt(e,Le.StringSlice,t,s,...o)}case"toLowerCase":return os("lower",t,s);case"toUpperCase":return os("upper",t,s);case"trim":return Rt(e,Le.StringTrim,t,s);case"trimEnd":case"trimRight":return Rt(e,Le.StringTrimEnd,t,s);case"trimStart":case"trimLeft":return Rt(e,Le.StringTrimStart,t,s);case"split":return Rt(e,Le.StringSplit,t,s,...o);case"charAt":{const n=Mn(o[0]);if(void 0!==n&&n>=0){var u;const e=In(null!==(u=o[0])&&void 0!==u?u:ee(),1);return os("sub",t,s,e,e)}return Rt(e,Le.StringCharAt,t,s,...o)}case"charCodeAt":{const n=Mn(o[0]);var l;return void 0!==n&&n>=0?Se(os("byte",t,s,In(null!==(l=o[0])&&void 0!==l?l:ee(),1)),Rn(),M.OrOperator):Rt(e,Le.StringCharCodeAt,t,s,...o)}case"startsWith":return Rt(e,Le.StringStartsWith,t,s,...o);case"endsWith":return Rt(e,Le.StringEndsWith,t,s,...o);case"includes":return Rt(e,Le.StringIncludes,t,s,...o);case"repeat":return os("rep",t,s,Te(Oe(Ee("math"),ce("floor")),[null!==(r=o[0])&&void 0!==r?r:ee()]));case"padStart":return Rt(e,Le.StringPadStart,t,s,...o);case"padEnd":return Rt(e,Le.StringPadEnd,t,s,...o);case"toString":return;default:e.diagnostics.push(at(n.name,"string",a))}}(e,t,n);case"Number":return function(e,t,n){const r=e.checker.getResolvedSignature(t),i=Xi(e,t.arguments,r),s=e.transformExpression(n.expression),o=n.name.text;switch(o){case"toString":return 0===i.length?Te(Ee("tostring"),[s],t):Rt(e,Le.NumberToString,t,s,...i);case"toFixed":return Rt(e,Le.NumberToFixed,t,s,...i);default:e.diagnostics.push(at(n.name,"number",o))}}(e,t,n);case"Array":case"ReadonlyArray":return function(e,t,n){const r=e.checker.getResolvedSignature(t),[s,o]=ts(e,n.expression,t.arguments,r),a=n.name.text;switch(a){case"at":return Rt(e,Le.ArrayAt,t,s,...o);case"concat":return Rt(e,Le.ArrayConcat,t,s,...o);case"entries":return Rt(e,Le.ArrayEntries,t,s);case"fill":return Rt(e,Le.ArrayFill,t,s,...o);case"push":if(1===t.arguments.length){var c;const n=null!==(c=o[0])&&void 0!==c?c:ee();var u;if(function(e){return xe(e)&&0!==(e.flags&P.TableUnpackCall)}(n))return Rt(e,Le.ArrayPushArray,t,s,null!==(u=n.params[0])&&void 0!==u?u:ee());if(!ne(n))return function(e,t,n,r){const i=ve(n)?n:ii(e,n);let s=Se(is(e,i),oe(1),M.AdditionOperator);const o=rn(t);o&&(s=ii(e,s));const a=W(Oe(i,s),r,t);return e.addPrecedingStatements(a),o?s:ee()}(e,t,s,n)}return Rt(e,Le.ArrayPush,t,s,...o);case"reverse":return Rt(e,Le.ArrayReverse,t,s);case"shift":return Te(Oe(Ee("table"),ce("remove")),[s,oe(1)],t);case"unshift":return Rt(e,Le.ArrayUnshift,t,s,...o);case"sort":return Rt(e,Le.ArraySort,t,s,...o);case"pop":return Te(Oe(Ee("table"),ce("remove")),[s],t);case"forEach":return Rt(e,Le.ArrayForEach,t,s,...o);case"find":return Rt(e,Le.ArrayFind,t,s,...o);case"findIndex":return Rt(e,Le.ArrayFindIndex,t,s,...o);case"includes":return Rt(e,Le.ArrayIncludes,t,s,...o);case"indexOf":return Rt(e,Le.ArrayIndexOf,t,s,...o);case"map":return Rt(e,Le.ArrayMap,t,s,...o);case"filter":return Rt(e,Le.ArrayFilter,t,s,...o);case"reduce":return Rt(e,Le.ArrayReduce,t,s,...o);case"reduceRight":return Rt(e,Le.ArrayReduceRight,t,s,...o);case"some":return Rt(e,Le.ArraySome,t,s,...o);case"every":return Rt(e,Le.ArrayEvery,t,s,...o);case"slice":return Rt(e,Le.ArraySlice,t,s,...o);case"splice":return Rt(e,Le.ArraySplice,t,s,...o);case"join":const r=e.checker.getTypeAtLocation(n.expression),p=e.checker.getElementTypeOfArrayType(r);if(p&&Wt(e,p,i.TypeFlags.StringLike|i.TypeFlags.NumberLike)){var l;const e=ce(","),n=null!==(l=o[0])&&void 0!==l?l:ee(),r=[s,0===t.arguments.length?e:ae(n)?n:Se(n,e,M.OrOperator)];return Te(Oe(Ee("table"),ce("concat")),r,t)}return Rt(e,Le.ArrayJoin,t,s,...o);case"flat":return Rt(e,Le.ArrayFlat,t,s,...o);case"flatMap":return Rt(e,Le.ArrayFlatMap,t,s,...o);case"toReversed":return Rt(e,Le.ArrayToReversed,t,s,...o);case"toSorted":return Rt(e,Le.ArrayToSorted,t,s,...o);case"toSpliced":return Rt(e,Le.ArrayToSpliced,t,s,...o);case"with":return Rt(e,Le.ArrayWith,t,s,...o);default:e.diagnostics.push(at(n.name,"array",a))}}(e,t,n);case"Function":case"CallableFunction":case"NewableFunction":return function(e,t,n){const r=e.checker.getTypeAtLocation(n.expression);or(e,r)===Yn.Void&&e.diagnostics.push(ze(t));const i=e.checker.getResolvedSignature(t),[s,o]=ts(e,n.expression,t.arguments,i),a=n.name.text;switch(a){case"apply":const r=o.length>1?[Pn(e,o[1],t.arguments[1])]:[];return Te(s,[o[0],...r],t);case"bind":return Rt(e,Le.FunctionBind,t,s,...o);case"call":return Te(s,o,t);case"toString":e.diagnostics.push(at(n.name,"function",a))}}(e,t,n)}}(e,t,r);if(s)return s;const o=function(e,t,n){switch(n.name.text){case"toString":return Te(Ee("tostring"),[e.transformExpression(n.expression)],t);case"hasOwnProperty":const r=e.transformExpression(n.expression),i=e.checker.getResolvedSignature(t),s=Xi(e,t.arguments,i);return Se(Te(Ee("rawget"),[r,...s]),ee(),M.InequalityOperator,t)}}(e,t,r);if(o)return o}}(t,e))&&void 0!==n?n:function(e,t){const n=Ft(e,t.expression);if(!n)return;const r=qi[n];return r?r(e,t,n):void 0}(t,e);if(a)return void 0!==s&&t.diagnostics.push(yt(e)),o?Cn(a):a;if(i.isPropertyAccessExpression(r)){const n=function(e,t,n){const r=e.checker.getResolvedSignature(t);if(n.expression.kind===i.SyntaxKind.SuperKeyword){const n=Xi(e,t.arguments,r,i.factory.createThis());return Te(e.transformExpression(t.expression),n,t)}if(tr(e,t)!==Yn.Void)return ns(e,t,t.arguments);{const[n,i]=ts(e,t.expression,t.arguments,r);return Te(n,i,t)}}(t,e,r);return o?Cn(n):n}if(i.isElementAccessExpression(r)){const n=function(e,t){if(tr(e,t)!==Yn.Void)return ns(e,t,t.arguments);{const[n,r]=ts(e,t.expression,t.arguments);return Te(n,r,t)}}(t,e);return o?Cn(n):n}const c=t.checker.getResolvedSignature(e);if(r.kind===i.SyntaxKind.SuperKeyword){const n=Xi(t,e.arguments,c,i.factory.createThis());return Te(Oe(t.transformExpression(i.factory.createSuper()),ce("____constructor")),n,e)}let u,l;const p=tr(t,e)!==Yn.Void;if(p){const n=!t.isStrict&&void 0===s?i.factory.createIdentifier("_G"):i.factory.createNull();[u,l]=ts(t,r,e.arguments,c,n)}else[u,l]=ts(t,r,e.arguments,c);const d=Te(u,l,e);return s&&p&&(s.contextualCall=d),o?Cn(d):d},[i.SyntaxKind.ClassDeclaration]:(e,t)=>{if(Ss(e)){const{precedingStatements:n}=ur(t,(()=>(Io(e,t),[])));return n}const{statements:n}=Mo(e,t);return n},[i.SyntaxKind.ClassExpression]:Io,[i.SyntaxKind.ConditionalExpression]:(e,t)=>{if(t.luaTarget===F.Luau)return function(e,t,n,r){const i=C(M.ConditionalExpression,r);return i.condition=e,i.whenTrue=t,i.whenFalse=n,i}(t.transformExpression(e.condition),t.transformExpression(e.whenTrue),t.transformExpression(e.whenFalse),e);Co(e.condition,t);const n=ur(t,(()=>t.transformExpression(e.condition))),r=ur(t,(()=>t.transformExpression(e.whenTrue))),i=ur(t,(()=>t.transformExpression(e.whenFalse)));if(r.precedingStatements.length>0||i.precedingStatements.length>0||Xt(t,t.checker.getTypeAtLocation(e.whenTrue)))return function(e,t,n,r,i){const s=e.createTempNameForNode(t.condition),o=r.precedingStatements.concat(W(be(s),r.result,t.whenTrue)),a=i.precedingStatements.concat(W(be(s),i.result,t.whenFalse));return e.addPrecedingStatements([V(s,void 0,t.condition),...n.precedingStatements,q(n.result,R(o,t.whenTrue),R(a,t.whenFalse),t)]),be(s)}(t,e,n,r,i);t.addPrecedingStatements(n.precedingStatements);const s=Se(n.result,r.result,M.AndOperator);return Se(s,i.result,M.OrOperator,e)},[i.SyntaxKind.ContinueStatement]:(e,t)=>{var n;const r=bn(t,Tn.Loop),i={[F.Universal]:vn.WithRepeatBreak,[F.Lua50]:vn.WithRepeatBreak,[F.Lua51]:vn.WithRepeatBreak,[F.Lua52]:vn.WithGoto,[F.Lua53]:vn.WithGoto,[F.Lua54]:vn.WithGoto,[F.LuaJIT]:vn.WithGoto,[F.Luau]:vn.WithContinue}[t.luaTarget];r&&(r.loopContinued=i);const s=`__continue${null!==(n=null===r||void 0===r?void 0:r.id)&&void 0!==n?n:""}`;switch(i){case vn.WithGoto:return function(e,t){const n=C(M.GotoStatement,t);return n.label=e,n}(s,e);case vn.WithContinue:return o=e,C(M.ContinueStatement,o);case vn.WithRepeatBreak:return[W(Ee(s),te(!0),e),Y(e)]}var o},[i.SyntaxKind.DeleteExpression]:(e,t)=>{if(i.isOptionalChain(e.expression))return function(e,t,n){return ni(e,n,void 0,t),te(!0,t)}(t,e,e.expression);let n,r;if(i.isPropertyAccessExpression(e.expression)){if(i.isPrivateIdentifier(e.expression.name))throw new Error("PrivateIdentifier is not supported");n=t.transformExpression(e.expression.expression),r=ce(e.expression.name.text)}else if(i.isElementAccessExpression(e.expression)){n=t.transformExpression(e.expression.expression),r=t.transformExpression(e.expression.argumentExpression);const i=t.checker.getTypeAtLocation(e.expression.expression),s=t.checker.getTypeAtLocation(e.expression.argumentExpression);Qt(t,i)&&Ut(t,s)&&(r=In(r,1))}return n&&r?Rt(t,Le.Delete,e,n,r):(t.diagnostics.push(at(e,"delete",i.SyntaxKind[e.kind])),ee())},[i.SyntaxKind.DoStatement]:(e,t)=>{Co(e.expression,t);const n=j(Ko(t,e));let{precedingStatements:r,result:i}=ur(t,(()=>jo(t.transformExpression(e.expression))));return r.length>0&&(r.push(q(i,R([Y()]),void 0,e.expression)),i=te(!1)),U(R([n,...r]),i,e)},[i.SyntaxKind.ElementAccessExpression]:(e,t)=>Hi(t,e,void 0).expression,[i.SyntaxKind.EmptyStatement]:()=>{},[i.SyntaxKind.EnumDeclaration]:(e,t)=>{if(i.getCombinedModifierFlags(e)&i.ModifierFlags.Const&&!t.options.preserveConstEnums)return;const n=qn(t.checker.getTypeAtLocation(e)).has(jn.CompileMembersOnly),r=[];if(!n&&function(e,t){const n=function(e,t){var n;return null!==(n=t.symbol)&&void 0!==n?n:e.checker.getSymbolAtLocation(t)}(e,t);return!n||n.valueDeclaration===t}(t,e)){const n=ps(t,e.name),i=Se(be(n),me(),M.OrOperator);r.push(...Bn(t,n,i,e))}const s=t.transformExpression(e.name);for(const o of e.members){const a=bi(t,o.name);let c;const u=ki(t,o);if(u)c=u;else if(o.initializer){if(i.isIdentifier(o.initializer)){const n=t.checker.getSymbolAtLocation(o.initializer);if(null!==n&&void 0!==n&&n.valueDeclaration&&i.isEnumMember(n.valueDeclaration)&&n.valueDeclaration.parent===e){c=Oe(s,bi(t,n.valueDeclaration.name))}}c||(c=t.transformExpression(o.initializer))}else c=ee();if(n){const n=t.checker.getSymbolAtLocation(e.name),i=n?bs(t,n):void 0;r.push(...Bn(t,ve(a)?a:Ee(o.name.getText(),o.name),c,e,i))}else{const e=Oe(s,a);if(r.push(W(e,c,o)),!ae(c)&&!X(c)){const t=Oe(s,e);r.push(W(t,a,o))}}}return r},[i.SyntaxKind.ExportAssignment]:(e,t)=>{if(!t.resolver.isValueAliasDeclaration(e))return;const n=t.transformExpression(e.expression);return e.isExportEquals?V(Ln(),n,e):W(Oe(Ln(),Ts(e)),n,e)},[i.SyntaxKind.ExportDeclaration]:(e,t)=>{if(!e.exportClause)return qo(t,e);if(!t.resolver.isValueAliasDeclaration(e))return;if(i.isNamespaceExport(e.exportClause))return qo(t,e);const n=((e,t)=>t.elements.filter((t=>e.resolver.isValueAliasDeclaration(t))))(t,e.exportClause);return e.moduleSpecifier?function(e,t,n,r){const s=[],a=i.isStringLiteral(n)?n.text.replace(/"/g,""):"module",c=Ee(Rs(o.A.path.basename(a))),u=Yi(e,n);s.push(V(c,u,t));for(const i of r){var l;const t=Ln(),n=i.name,r=Oe(t,bi(e,n),n),o=null!==(l=i.propertyName)&&void 0!==l?l:i.name,a=Oe(be(c),bi(e,o),i);s.push(W(r,a,i))}return j(s,t)}(t,e,e.moduleSpecifier,n):n.map((e=>Go(t,e)))},[i.SyntaxKind.ExpressionStatement]:(e,t)=>{const n=function(e,t){const n=i.isExpressionStatement(t)?t.expression:t;if(i.isPrefixUnaryExpression(n)&&(n.operator===i.SyntaxKind.PlusPlusToken||n.operator===i.SyntaxKind.MinusMinusToken)){const t=n.operator===i.SyntaxKind.PlusPlusToken?i.SyntaxKind.PlusToken:i.SyntaxKind.MinusToken;return Rr(e,n,n.operand,i.factory.createNumericLiteral(1),t)}if(i.isPostfixUnaryExpression(n)){const t=n.operator===i.SyntaxKind.PlusPlusToken?i.SyntaxKind.PlusToken:i.SyntaxKind.MinusToken;return Rr(e,n,n.operand,i.factory.createNumericLiteral(1),t)}}(t,e);if(n)return n;const r=function(e,t){const n=t.expression;if(!i.isBinaryExpression(n))return;const r=n.operatorToken.kind;if(Dr(r)){const t=Kr(r);return Rr(e,n,n.left,n.right,t)}if(r===i.SyntaxKind.EqualsToken)return Nr(e,n);if(r===i.SyntaxKind.CommaToken)return j([...e.transformStatements(i.factory.createExpressionStatement(n.left)),...e.transformStatements(i.factory.createExpressionStatement(n.right))],n)}(t,e);return r||Hr(t.transformExpression(e.expression))},[i.SyntaxKind.ExternalModuleReference]:(e,t)=>Yi(t,e.expression,e),[i.SyntaxKind.ForInStatement]:(e,t)=>{Qt(t,t.checker.getTypeAtLocation(e.expression))&&t.diagnostics.push(Ge(e));const n=Te(Ee("pairs"),[t.transformExpression(e.expression)]),r=R(Ko(t,e));return z(r,[Ro(t,e.initializer,r)],[n],e)},[i.SyntaxKind.ForOfStatement]:(e,t)=>{const n=R(Ko(t,e));if(i.isCallExpression(e.expression)&&Vo(t,e.expression))return Wo(t,e,n);const r=Mt(t,e.expression);if(r){if(r===It.Iterable)return function(e,t,n){const r=e.checker.getTypeAtLocation(t.expression),i=r.isIntersection()&&r.types.find((e=>"Iterable"===e.symbol.escapedName)),s=null===i||void 0===i?void 0:i.typeArguments;if(s&&s.length>0&&cn(s[0])){const r=e.transformExpression(t.expression);return $o(e,t,n,r,et)}const o=e.transformExpression(t.expression);return z(n,[Ro(e,t.initializer,n)],[o],t)}(t,e,n);if(r===It.Pairs)return function(e,t,n){const r=Te(Ee("pairs"),[e.transformExpression(t.expression)]);return $o(e,t,n,r,tt)}(t,e,n);if(r===It.PairsKey)return function(e,t,n){const r=Te(Ee("pairs"),[e.transformExpression(t.expression)]);return z(n,[Ro(e,t.initializer,n)],[r],t)}(t,e,n);x()}return Qt(t,t.checker.getTypeAtLocation(e.expression))?function(e,t,n){const r=Ro(e,t.initializer,n),i=Te(Ee("ipairs"),[e.transformExpression(t.expression)]);return z(n,[Ae(),r],[i],t)}(t,e,n):function(e,t,n){const r=Ro(e,t.initializer,n),i=Rt(e,Le.Iterator,t.expression,e.transformExpression(t.expression));return z(n,[Ae(),r],[i],t)}(t,e,n)},[i.SyntaxKind.ForStatement]:(e,t)=>{const n=[];t.pushScope(Tn.Loop),e.initializer&&(i.isVariableDeclarationList(e.initializer)?(fi(t,e.initializer),n.push(...e.initializer.declarations.flatMap((e=>di(t,e))))):n.push(...t.transformStatements(i.factory.createExpressionStatement(e.initializer))));const r=Ko(t,e);let s;if(e.condition){const n=e.condition,{precedingStatements:i,result:o}=ur(t,(()=>t.transformExpression(n)));s=o,i.length>0&&(i.push(q(jo(s),R([Y()]),void 0,e.condition)),r.unshift(...i),s=te(!0))}else s=te(!0);return e.incrementor&&r.push(...t.transformStatements(i.factory.createExpressionStatement(e.incrementor))),n.push(G(R(r),s,e)),t.popScope(),j(n,e)},[i.SyntaxKind.FunctionDeclaration]:(e,t)=>{if(void 0===e.body)return;if(Ss(e))return W(Oe(Ln(),Ts(e)),Ei(e,t));const[n,r]=vi(t,e),i=e.name?ps(t,e.name):Ae();if(void 0!==i.symbolId){var s;const e=En(t);e.functionDefinitions||(e.functionDefinitions=new Map);const n={referencedSymbols:null!==(s=r.referencedSymbols)&&void 0!==s?s:new Map};e.functionDefinitions.set(i.symbolId,n)}const o=e.name&&gi(t,t.checker.getTypeAtLocation(e.name))?hi(n):n;return Bn(t,i,o,e)},[i.SyntaxKind.FunctionExpression]:Ei,[i.SyntaxKind.Identifier]:(e,t)=>{if(i.identifierToKeywordKind(e)===i.SyntaxKind.UndefinedKeyword)return ee(e);const n=t.checker.getSymbolAtLocation(e);return ms(t,e,n)},[i.SyntaxKind.IfStatement]:function e(t,n){n.pushScope(Tn.Conditional),Co(t.expression,n);const r=n.transformExpression(t.expression),s=kn(n,co(n,t.thenStatement));n.popScope();const o=R(s);if(t.elseStatement){if(i.isIfStatement(t.elseStatement)){const i=t.elseStatement,{precedingStatements:s,result:a}=ur(n,(()=>e(i,n)));if(s.length>0){return q(r,o,R([...s,a]))}return q(r,o,a)}{n.pushScope(Tn.Conditional);const e=kn(n,co(n,t.elseStatement));n.popScope();return q(r,o,R(e))}}return q(r,o)},[i.SyntaxKind.ImportDeclaration]:(e,t)=>{const n=En(t);n.importStatements||(n.importStatements=[]);const r=[],o=Yi(t,e.moduleSpecifier);if(void 0===e.importClause)return r.push(Z(o)),void n.importStatements.push(...r);const a=i.isStringLiteral(e.moduleSpecifier)?e.moduleSpecifier.text.replace(/"/g,""):"module",c=Ee(Rs(s.default.basename(a)));let u=!1;if(e.importClause.name&&Zi(t,e.importClause)){const n=Ts(e.importClause.name),i=V(ps(t,e.importClause.name),Oe(c,n),e.importClause.name);r.push(i),u=!0}if(e.importClause.namedBindings&&i.isNamespaceImport(e.importClause.namedBindings)&&t.resolver.isReferencedAliasDeclaration(e.importClause.namedBindings)){const n=V(ps(t,e.importClause.namedBindings.name),o,e);r.push(n)}if(e.importClause.namedBindings&&i.isNamedImports(e.importClause.namedBindings)){const n=e.importClause.namedBindings.elements.filter((e=>Zi(t,e))).map((e=>function(e,t,n){var r;return V(ps(e,t.name),Oe(n,bi(e,null!==(r=t.propertyName)&&void 0!==r?r:t.name)),t)}(t,e,c)));n.length>0&&(u=!0),r.push(...n)}0!==r.length&&(u&&r.unshift(V(c,o,e)),n.importStatements.push(...r))},[i.SyntaxKind.ImportEqualsDeclaration]:(e,t)=>{if(!t.resolver.isReferencedAliasDeclaration(e)&&(i.isExternalModuleReference(e.moduleReference)||i.isExternalModule(t.sourceFile)||!t.resolver.isTopLevelValueImportEqualsWithEntityName(e)))return;const n=ps(t,e.name),r=t.transformExpression(e.moduleReference);return Kn(t,n,r,e)},[i.SyntaxKind.ModuleDeclaration]:(e,t)=>{var n,r;const s=t.currentNamespaces,o=[],a=t.checker.getSymbolAtLocation(e.name),c=void 0!==a&&t.checker.getExportsOfModule(a).length>0,u=ps(t,e.name),l=Es(t,u),p=!t.isModule&&(!s||l),d=void 0===a||!(null!==(n=a.declarations)&&void 0!==n&&n.some((e=>i.isClassLike(e)||i.isFunctionDeclaration(e))))&&i.getOriginalNode(e)===(null===(r=a.declarations)||void 0===r?void 0:r.find(i.isModuleDeclaration));if(p){const e=Bn(t,u,Se(Ns(t,u),me(),M.OrOperator));o.push(...e)}else if(d){const e=Bn(t,u,me());o.push(...e)}if((p||d)&&l&&c&&ys(e)){const n=Kn(t,gs(t,e),ws(t,u,l));o.push(n)}if(t.currentNamespaces=e,ys(e)){t.pushScope(Tn.Block);const n=kn(t,t.transformStatements(i.isModuleBlock(e.body)?e.body.statements:e.body));t.popScope(),o.push(j(n))}return t.currentNamespaces=s,o},[i.SyntaxKind.NewExpression]:(e,t)=>{var n,r;if(function(e,t){return Ft(e,t.expression)===_t.TableNewType}(t,e))return me(void 0,e);const i=t.checker.getTypeAtLocation(e.expression);if("ArrayConstructor"===(null===(n=us(t,i))||void 0===n?void 0:n.name)){if(void 0===e.arguments||0===e.arguments.length)return me([],e);{const n=t.checker.getResolvedSignature(e),r=null===n||void 0===n?void 0:n.getDeclaration();if(1===(null===r||void 0===r?void 0:r.parameters.length)&&void 0===r.parameters[0].dotDotDotToken)return t.diagnostics.push(At(e)),me([],e);return me(Xi(t,e.arguments,n).map((e=>fe(e))),e)}}const s=t.checker.getResolvedSignature(e),[o,a]=ts(t,e.expression,null!==(r=e.arguments)&&void 0!==r?r:[],s),c=qn(t.checker.getTypeAtLocation(e)).get(jn.CustomConstructor);if(c){var u;if(1===c.args.length)return Te(Ee(c.args[0]),Xi(t,null!==(u=e.arguments)&&void 0!==u?u:[]),e);t.diagnostics.push(Qe(e,jn.CustomConstructor,c.args.length,1))}return Rt(t,Le.New,e,o,...a)},[i.SyntaxKind.ParenthesizedExpression]:(e,t)=>t.transformExpression(e.expression),[i.SyntaxKind.PostfixUnaryExpression]:(e,t)=>{switch(e.operator){case i.SyntaxKind.PlusPlusToken:return Br(t,e,e.operand,i.factory.createNumericLiteral(1),i.SyntaxKind.PlusToken,!0);case i.SyntaxKind.MinusMinusToken:return Br(t,e,e.operand,i.factory.createNumericLiteral(1),i.SyntaxKind.MinusToken,!0);default:x(e.operator)}},[i.SyntaxKind.PrefixUnaryExpression]:(e,t)=>{switch(e.operator){case i.SyntaxKind.PlusPlusToken:return Br(t,e,e.operand,i.factory.createNumericLiteral(1),i.SyntaxKind.PlusToken,!1);case i.SyntaxKind.MinusMinusToken:return Br(t,e,e.operand,i.factory.createNumericLiteral(1),i.SyntaxKind.MinusToken,!1);case i.SyntaxKind.PlusToken:{const n=t.transformExpression(e.operand),r=t.checker.getTypeAtLocation(e.operand);return Ut(t,r)?n:Rt(t,Le.Number,e,n)}case i.SyntaxKind.MinusToken:{const n=t.transformExpression(e.operand),r=t.checker.getTypeAtLocation(e.operand);return Ut(t,r)?ge(n,M.NegationOperator):Rt(t,Le.Number,e,ge(n,M.NegationOperator))}case i.SyntaxKind.ExclamationToken:return ge(t.transformExpression(e.operand),M.NotOperator);case i.SyntaxKind.TildeToken:return function(e,t,n,r){switch(e.luaTarget){case F.Universal:case F.Lua50:case F.Lua51:return e.diagnostics.push(st(t,"Bitwise operations",e.luaTarget)),Mr(t,n,r,"bit");case F.LuaJIT:return Mr(t,n,r,"bit");case F.Lua52:return Mr(t,n,r,"bit32");default:return ge(n,r,t)}}(t,e,t.transformExpression(e.operand),M.BitwiseNotOperator);default:x(e.operator)}},[i.SyntaxKind.PropertyAccessExpression]:(e,t)=>Ji(t,e,void 0).expression,[i.SyntaxKind.QualifiedName]:(e,t)=>{const n=ce(e.right.text,e.right);return Oe(t.transformExpression(e.left),n,e)},[i.SyntaxKind.ReturnStatement]:(e,t)=>{let n;if(e.expression){const r=t.checker.getTypeAtLocation(e.expression),i=t.checker.getContextualType(e.expression);i&&cr(t,e,r,i),n=pr(t,e.expression,fr(t))}else n=[];return dr(t,n,e)},[i.SyntaxKind.SourceFile]:(e,t)=>{var n,r;let s=[];if(e.flags&i.NodeFlags.JsonFile){const[n]=e.statements;if(n){i.isExpressionStatement(n);const{precedingStatements:e,result:r}=ur(t,(()=>t.transformExpression(n.expression)));s.push(...e),s.push(Q([r]))}else{const e=Te(Ee("error"),[ce("Unexpected end of JSON input")]);s.push(Z(e))}}else t.pushScope(Tn.File),s=kn(t,t.transformStatements(e.statements)),t.popScope(),t.isModule&&(e.statements.some((e=>i.isExportAssignment(e)&&e.isExportEquals))||s.unshift(V(Ln(),me())),s.push(Q([Ln()])));const o=null!==(n=null===(r=e.getFullText().match(/^#!.*\r?\n/))||void 0===r?void 0:r[0])&&void 0!==n?n:"";return function(e,t,n,r){const i=C(M.File,r);return i.statements=e,i.luaLibFeatures=t,i.trivia=n,i}(s,t.usedLuaLibFeatures,o,e)},[i.SyntaxKind.SpreadElement]:(e,t)=>{const n=i.skipOuterExpressions(e.expression);if(i.isIdentifier(n)){const r=t.checker.getSymbolAtLocation(n);if(r&&gn(t,r,n))return t.luaTarget===F.Lua50?Pn(t,ie(),e):re(e)}const r=t.transformExpression(e.expression);if(dn(t,n))return r;const s=Mt(t,e.expression);if(s){if(s===It.Iterable)return Rt(t,Le.LuaIteratorSpread,e,r);if(s===It.Pairs){return Pn(t,Rt(t,Le.ObjectEntries,e,r),e)}if(s===It.PairsKey){return Pn(t,Rt(t,Le.ObjectKeys,e,r),e)}x()}const o=t.checker.getTypeAtLocation(e.expression);return Yt(t,o)?Pn(t,r,e):Rt(t,Le.Spread,e,r)},[i.SyntaxKind.SuperKeyword]:(e,t)=>{const n=t.classSuperInfos,r=n[n.length-1];if(!r)return Ae(e);const{className:s,extendedTypeNode:o}=r,a=null===o||void 0===o?void 0:o.expression;let c;if(a&&i.isIdentifier(a)){const e=t.checker.getSymbolAtLocation(a);e&&!Os(t,e)&&(c=ps(t,a))}c||(c=Oe(s,ce("____super"),e));const u=tn(e,i.isFunctionLike);return u&&i.canHaveModifiers(u)&&po(u)?c:Oe(c,ce("prototype"))},[i.SyntaxKind.SwitchStatement]:(e,t)=>{const n=t.pushScope(Tn.Switch),r=`____switch${n.id}`,s=`____cond${n.id}`,o=Ee(r),a=Ee(s),c=[],u=[],l=[],p=e.caseBlock.clauses;if(1===p.length&&i.isDefaultClause(p[0])){const e=p[0].statements;if(e.length){const{statements:n,hoistedStatements:r,hoistedIdentifiers:i}=On(t,t.transformStatements(e));u.push(...r),l.push(...i),c.push(j(n))}}else{let e,n=!1,r=!0,s=[];for(let m=0;m<p.length;m++){const f=p[m],h=p[m-1];if(0===m&&i.isDefaultClause(f))continue;if(i.isDefaultClause(f)&&h&&Uo(h.statements))continue;if(i.isDefaultClause(f)){var d;if(r)c.push(...s,V(a,null!==(d=e)&&void 0!==d?d:te(!1))),e=void 0,s=[],r=!1;if(m===p.length-1){if(e){const{precedingStatements:n,result:r}=zo(t,a,e,s);s=n,e=r,c.push(...s,W(a,e))}continue}}else{const{precedingStatements:n,result:i}=Ho(e,s,o,f.expression,t);if(s=n,e=i,m!==p.length-1&&0===f.statements.length)continue;if(r)c.push(...s,V(a,e));else{const{precedingStatements:n,result:r}=zo(t,a,e,s);s=n,e=r,c.push(...s,W(a,e))}r=!1}const{statements:g,hoistedStatements:y,hoistedIdentifiers:S}=On(t,t.transformStatements(f.statements));m!==p.length-1||Uo(f.statements)||g.push(Y()),u.push(...y),l.push(...S),i.isDefaultClause(f)&&(n=!0),c.push(q(a,R(g))),e=void 0,s=[]}const f=p.findIndex((e=>i.isDefaultClause(e)));if(f>=0){const e=p.findIndex(((e,t)=>t>=f&&Uo(e.statements))),{statements:r,hoistedStatements:i,hoistedIdentifiers:s}=On(t,t.transformStatements(p[f].statements));n||(u.push(...i),l.push(...s));for(const n of p.slice(f+1,e>=0?e+1:void 0)){let e=t.transformStatements(n.statements);({statements:e}=On(t,e)),r.push(...e)}r.length&&c.push(j(r))}}c.unshift(...u),l.length>0&&c.unshift(V(l)),t.popScope();const f=t.transformExpression(e.expression);return c.unshift(V(o,f)),U(R(c),te(!0))},[i.SyntaxKind.TaggedTemplateExpression]:(e,t)=>{const n=[],r=[],s=[];i.isTemplateExpression(e.template)?(n.push(e.template.head.text),r.push(Jo(e.template.head)),n.push(...e.template.templateSpans.map((e=>e.literal.text))),r.push(...e.template.templateSpans.map((e=>Jo(e.literal)))),s.push(...e.template.templateSpans.map((e=>e.expression)))):(n.push(e.template.text),r.push(Jo(e.template)));const o=i.factory.createArrayLiteralExpression(r.map((e=>i.factory.createStringLiteral(e)))),a=i.factory.createObjectLiteralExpression([...n.map(((e,t)=>i.factory.createPropertyAssignment(i.factory.createNumericLiteral(t+1),i.factory.createStringLiteral(e)))),i.factory.createPropertyAssignment("raw",o)]);s.unshift(a);if(tr(t,e)!==Yn.Void)return ns(t,e,s);const c=Xi(t,s);return Te(t.transformExpression(e.tag),c)},[i.SyntaxKind.TemplateExpression]:(e,t)=>{const n=[],r=e.head.text;r.length>0&&n.push(ce(r,e.head));const i=ui(t,e.templateSpans.map((e=>e.expression)));for(let s=0;s<e.templateSpans.length;++s){const r=e.templateSpans[s],o=i[s],a=t.checker.getTypeAtLocation(r.expression);Gt(t,a)?n.push(o):n.push(Dn(o));const c=r.literal.text;c.length>0&&n.push(ce(c,r.literal))}return n.reduce(((e,t)=>Se(e,t,M.ConcatOperator)))},[i.SyntaxKind.ThisKeyword]:e=>Fn(e),[i.SyntaxKind.ThrowStatement]:(e,t)=>{const n=[];return e.expression&&(n.push(t.transformExpression(e.expression)),n.push(oe(0))),Z(Te(Ee("error"),n),e)},[i.SyntaxKind.TryStatement]:(e,t)=>{if(Vt(e))return((e,t)=>{const[n]=uo(t,e.tryBlock,Tn.Try);if((t.options.luaTarget===F.Lua50||t.options.luaTarget===F.Lua51)&&!t.options.lua51AllowTryCatchInAsyncAwait)return t.diagnostics.push(ot(e,"try/catch inside async functions",F.Lua51,"lua51AllowTryCatchInAsyncAwait")),n.statements;const r=lr(t,n.statements,!1),i=Ee("____try"),s=[V(i,r)];if(e.finallyBlock){const n=Te(Oe(i,ce("finally")),[i,pe(R(t.transformStatements(e.finallyBlock.statements)))],e.finallyBlock);s.push(Z(n))}if(e.catchClause){const[n]=Do(t,e.catchClause);n.params&&n.params.unshift(Ae());const r=Te(Oe(i,ce("catch")),[i,n]),o=Rt(t,Le.Await,e,r);s.push(Z(o,e))}else{const n=Rt(t,Le.Await,e,i);s.push(Z(n,e))}return s})(e,t);const[n,r]=uo(t,e.tryBlock,Tn.Try);if((t.options.luaTarget===F.Lua50||t.options.luaTarget===F.Lua51)&&function(e){const t=tn(e,i.isFunctionDeclaration);return!!t&&void 0!==t.asteriskToken}(e))return t.diagnostics.push(st(e,"try/catch inside generator functions",F.Lua51)),n.statements;const s=Ee("____try"),o=Ee("____returnValue"),a=[],c=Ee("____hasReturned");let u;const l=Te(Ee("pcall"),[pe(n)]);if(e.catchClause&&e.catchClause.block.statements.length>0){var p;const[n,i]=Do(t,e.catchClause),d=Ee("____catch");a.push(V(d,n));const f=null!==(p=r.functionReturned)&&void 0!==p?p:i.functionReturned,m=[s];(f||e.catchClause.variableDeclaration)&&(m.push(c),f&&(m.push(o),u=be(c))),a.push(V(m,l));const h=Te(d,e.catchClause.variableDeclaration?[be(c)]:[]),g=f?W([be(c),be(o)],h):Z(h),y=ge(s,M.NotOperator);a.push(q(y,R([g])))}else if(r.functionReturned){const e=[s,c,o];a.push(V(e,l)),u=Se(be(s),c,M.AndOperator)}else a.push(Z(l));if(e.finallyBlock&&e.finallyBlock.statements.length>0&&a.push(...t.transformStatements(e.finallyBlock)),u&&c){const n=[];fn(t,e)?n.push(Pn(t,be(o))):n.push(be(o));const r=q(u,R([dr(t,n,e)]));a.push(r)}return j(a,e)},[i.SyntaxKind.TypeOfExpression]:(e,t)=>{const n=t.transformExpression(e.expression);return Rt(t,Le.TypeOf,e,n)},[i.SyntaxKind.VariableStatement]:(e,t)=>(fi(t,e.declarationList),e.declarationList.declarations.flatMap((e=>di(t,e)))),[i.SyntaxKind.WhileStatement]:(e,t)=>{Co(e.expression,t);const n=Ko(t,e);let{precedingStatements:r,result:i}=ur(t,(()=>t.transformExpression(e.expression)));return r.length>0&&(r.push(q(jo(i),R([Y()]),void 0,e.expression)),n.unshift(...r),i=te(!0)),G(R(n),i,e)},[i.SyntaxKind.YieldExpression]:(e,t)=>{const n=e.expression?[t.transformExpression(e.expression)]:[];return e.asteriskToken?Rt(t,Le.DelegatedYield,e,...n):Te(Oe(Ee("coroutine"),ce("yield")),n,e)},[i.SyntaxKind.VoidExpression]:(e,t)=>{if(!i.isLiteralExpression(e.expression)){const n=Hr(t.transformExpression(e.expression));n&&t.addPrecedingStatements(n)}return ee()}};function Zo(e){return t=>n=>{function r(n){if(i.isBlock(n)||i.isSourceFile(n)){const[s,o]=Xo(e,n.statements,n);if(s){const a=i.isBlock(n)?i.factory.updateBlock(n,o):i.factory.updateSourceFile(n,o),c=i.visitEachChild(a,r,t),u=[a];function l(e){return i.setParent(e,u[u.length-1]),u.push(e),i.visitEachChild(e,l,t),u.pop(),e}return i.visitEachChild(a,l,t),i.setParent(a,n.parent),c}}return i.visitEachChild(n,r,t)}return r(i.visitEachChild(n,r,t))}}function Xo(e,t,n){const r=[];for(let o=0;o<t.length;o++){const a=t[o];if(s=a,i.isVariableStatement(s)&&0!==(s.declarationList.flags&i.NodeFlags.Using)){const s=0!==(a.declarationList.flags&i.NodeFlags.AwaitContext);Bt(e,s?Le.UsingAsync:Le.Using);const c=a.declarationList.declarations.map((e=>i.factory.createParameterDeclaration(void 0,void 0,e.name)));c.unshift(ea(e.checker));const u=t.slice(o+1),[l,p]=Xo(e,u,n),d=i.factory.createBlock(l?p:u),f=i.factory.createFunctionExpression(s?[i.factory.createModifier(i.SyntaxKind.AsyncKeyword)]:void 0,void 0,void 0,void 0,c,i.factory.createKeywordTypeNode(i.SyntaxKind.AnyKeyword),d),m=i.factory.createIdentifier(s?"__TS__UsingAsync":"__TS__Using");let h=i.factory.createCallExpression(m,[],[f,...a.declarationList.declarations.map((e=>{var t;return null!==(t=e.initializer)&&void 0!==t?t:i.factory.createIdentifier("unidentified")}))]);return s&&(h=i.factory.createAwaitExpression(h)),i.isSourceFile(n)||n.parent&&i.isBlock(n.parent)&&n.parent.statements[n.parent.statements.length-1]!==n?r.push(i.factory.createExpressionStatement(h)):r.push(i.factory.createReturnStatement(h)),[!0,r]}r.push(a)}var s;return[!1]}function ea(e){const t=e.typeToTypeNode(e.getVoidType(),void 0,void 0);return i.factory.createParameterDeclaration(void 0,void 0,i.factory.createIdentifier("this"),void 0,t)}function ta(e,t,n,r){var s,o,a,c,u,l;const p=function(e){const t={before:[],after:[],afterDeclarations:[]},n=e.getCompilerOptions();n.jsx===i.JsxEmit.React&&t.before.push((e=>{const t={...e,getCompilerOptions:()=>({...e.getCompilerOptions(),target:i.ScriptTarget.ESNext})};return i.transformJsx(t)}));return t}(e),d=[...null!==(s=p.afterDeclarations)&&void 0!==s?s:[],...null!==(o=n.afterDeclarations)&&void 0!==o?o:[]];return e.getCompilerOptions().noImplicitSelf&&d.unshift(na),{afterDeclarations:d,before:[...null!==(a=n.before)&&void 0!==a?a:[],...null!==(c=p.before)&&void 0!==c?c:[],...null!==(u=p.after)&&void 0!==u?u:[],...null!==(l=n.after)&&void 0!==l?l:[],ra,()=>e=>(r(e),i.createSourceFile(e.fileName,"",i.ScriptTarget.ESNext))]}}const na=()=>e=>{const t=e=>{const t=i.factory.createNotEmittedStatement(void 0);return i.addSyntheticLeadingComment(t,i.SyntaxKind.MultiLineCommentTrivia,"* @noSelfInFile ",!0),i.factory.updateSourceFile(e,[t,...e.statements],e.isDeclarationFile)};return i.isBundle(e)?i.factory.updateBundle(e,e.sourceFiles.map(t)):t(e)},ra=e=>t=>{function n(e){for(;i.isParenthesizedExpression(e)&&!i.isOptionalChain(e.expression);)e=e.expression;return e}return i.visitEachChild(t,(function t(r){return i.isCallExpression(r)?i.factory.updateCallExpression(r,n(r.expression),r.typeArguments,r.arguments):i.isVoidExpression(r)?i.factory.updateVoidExpression(r,n(r.expression)):i.isDeleteExpression(r)?i.factory.updateDeleteExpression(r,n(r.expression)):i.visitEachChild(r,t,e)}),e)};function ia(e,t,n){let{program:r,sourceFiles:o,customTransformers:a={}}=n;const c=r.getCompilerOptions();c.tstlVerbose&&console.log("Parsing project settings");const u=function(e){const t=[];return e.luaBundle&&!e.luaBundleEntry&&t.push(A()),e.luaBundle&&e.luaLibImport===w.Inline&&t.push(_()),e.luaBundle&&e.buildMode===L.Library&&t.push(O()),e.jsx&&e.jsx!==i.JsxEmit.React&&t.push(k()),e.paths&&!e.baseUrl&&t.push(N()),t}(c);let l=[];if(c.noEmitOnError){const e=[...u,...r.getOptionsDiagnostics(),...r.getGlobalDiagnostics()];if(o)for(const t of o)e.push(...r.getSyntacticDiagnostics(t)),e.push(...r.getSemanticDiagnostics(t));else e.push(...r.getSyntacticDiagnostics()),e.push(...r.getSemanticDiagnostics());if(0===e.length&&(c.declaration||c.composite)&&e.push(...r.getDeclarationDiagnostics()),e.length>0)return{diagnostics:e,transpiledFiles:l}}const p=function(e){const t=new Map;for(const r of[Yo,...e]){const e=r===Yo?-1/0:0;for(const[n,i]of Object.entries(r)){if(!i)continue;const r="function"===typeof i?{transform:i,priority:e}:i;g(t,Number(n),(()=>[])).push(r)}}const n=new Map;for(const[r,i]of t)n.set(r,i.sort(((e,t)=>{var n,r;return(null!==(n=e.priority)&&void 0!==n?n:0)-(null!==(r=t.priority)&&void 0!==r?r:0)})).map((e=>e.transform)));return n}([]),d=function(e){if(0===e.length)return(e,t,n,r)=>new ga(t,e,n).print(r);if(1===e.length)return e[0];throw new Error("Only one plugin can specify 'printer'")}([]),f=t=>{c.tstlVerbose&&console.log(`Transforming ${t.fileName}`);const{file:n,diagnostics:o}=function(e,t,n){const r=new hr(e,t,n),s=[Zo(r)],o=i.transform(t,s),[a]=r.transformNode(o.transformed[0]);return{file:a,diagnostics:r.diagnostics}}(r,t,p);if(u.push(...o),!c.noEmit&&!c.emitDeclarationOnly){c.tstlVerbose&&console.log(`Printing ${t.fileName}`);const i=d(r,e,t.fileName,n);l.push({sourceFiles:[t],fileName:s.default.normalize(t.fileName),luaAst:n,...i})}},m=ta(r,0,a,f),h=e=>e.flags&i.NodeFlags.JsonFile&&!c.emitDeclarationOnly&&!r.isSourceFileFromExternalLibrary(e),y=c.noEmit;c.noEmit=!1;const S=function(e){if(!e.endsWith(".js")&&!e.endsWith(".js.map")&&!e.endsWith(".json")){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t(e,...r)}};if(o)for(const i of o)h(i)?f(i):u.push(...r.emit(i,S,void 0,!1,m).diagnostics);else u.push(...r.emit(void 0,S,void 0,!1,m).diagnostics),r.getSourceFiles().filter(h).forEach(f);return c.noEmit=y,(c.noEmit||c.noEmitOnError&&u.length>0)&&(l=[]),{diagnostics:u,transpiledFiles:l}}class sa{constructor(){let{emitHost:e=i.sys}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.emitHost=void 0,this.emitHost=e}emit(e){const{program:t,writeFile:n=this.emitHost.writeFile}=e,{diagnostics:r,transpiledFiles:i}=ia(this.emitHost,n,{...e}),{emitPlan:s}=this.getEmitPlan(t,r,i),o=this.emitFiles(t,s,n);return{diagnostics:r.concat(o),emitSkipped:0===s.length}}emitFiles(e,t,n){var r;const i=e.getCompilerOptions();i.tstlVerbose&&console.log("Emitting output");const s=null!==(r=i.emitBOM)&&void 0!==r&&r;for(const{outputPath:o,code:a,sourceMap:c,sourceFiles:u}of t)i.tstlVerbose&&console.log(`Emitting ${f(o)}`),n(o,a,s,void 0,u),i.sourceMap&&void 0!==c&&n(o+".map",c,s,void 0,u);return i.tstlVerbose&&console.log("Emit finished!"),[]}getEmitPlan(e,t,n){const r=e.getCompilerOptions();r.tstlVerbose&&console.log("Constructing emit plan");const i=function(e,t,n){const r=e.getCompilerOptions(),i=new Xs(e,r,n);for(const s of t)r.tstlVerbose&&console.log(`Resolving dependencies for ${f(s.fileName)}`),i.addAndResolveDependencies(s);return{resolvedFiles:[...i.resolvedFiles.values()],diagnostics:i.diagnostics}}(e,n,this.emitHost);t.push(...i.diagnostics);let s;if(i.resolvedFiles.some((e=>"lualib_bundle"===e.fileName))&&(i.resolvedFiles=i.resolvedFiles.filter((e=>"lualib_bundle"!==e.fileName))),I(r)){const[n,r]=qs(e,i.resolvedFiles);t.push(...n),s=[r]}else s=i.resolvedFiles.map((t=>({...t,outputPath:oa(t.fileName,e)})));return{emitPlan:s}}getLuaLibBundleContent(e,t){var n;const r=null!==(n=e.luaTarget)&&void 0!==n?n:F.Universal;if(e.luaLibImport===w.RequireMinimal){return function(e,t,n){const r=Ke(e,t,n),i=Pe(t),s=Array.from(e).flatMap((e=>i[e].exports));return r+`\nreturn {\n${s.map((e=>`  ${e} = ${e}`)).join(",\n")}\n}\n`}(Re(r,this.emitHost,t.map((e=>e.code))),r,this.emitHost)}return function(e,t){const n=s.default.join(Ie(e),"lualib_bundle.lua");if(!Be.has(n)){const e=t.readFile(n);if(void 0===e)throw new Error(`Could not load lualib bundle from '${n}'`);Be.set(n,e)}return Be.get(n)}(r,this.emitHost)}}function oa(e,t){const n=aa(e,t),r=ua(t);return s.default.join(r,n)}function aa(e,t){var n;const r=ca(t);let i;i=""===r?e.split(s.default.sep):s.default.relative(r,e).split(s.default.sep),i=i.filter((e=>".."!==e)),"node_modules"===i[0]&&(i[0]="lua_modules");const o=(null!==(n=t.getCompilerOptions().extension)&&void 0!==n?n:"lua").trim(),a=o.startsWith(".")?o.substring(1):o;return i[i.length-1]=m(i[i.length-1])+"."+a,s.default.join(...i)}function ca(e){const t=e.getCompilerOptions().rootDir;return t&&t.length>0?s.default.isAbsolute(t)?t:s.default.resolve(la(e),t):la(e)}function ua(e){const t=e.getCompilerOptions().outDir;return t&&t.length>0?s.default.isAbsolute(t)?t:s.default.resolve(la(e),t):la(e)}function la(e){const t=e.getCompilerOptions().configFilePath;return t?s.default.dirname(t):e.getCommonSourceDirectory()}const pa=/[\b\f\n\r\t\v\\"\0]/g,da={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\\":"\\\\",'"':'\\"',"\0":"\\0"},fa=e=>`"${e.replace(pa,(e=>da[e]))}"`,ma="--[[ Generated with https://github.com/TypeScriptToLua/TypeScriptToLua ]]\n";function ha(e){switch(e.kind){case M.CallExpression:case M.MethodCallExpression:case M.FunctionExpression:return!1;case M.TableExpression:return e.fields.every((e=>ha(e)));case M.TableFieldExpression:const t=e;return(!t.key||ha(t.key))&&ha(t.value);case M.TableIndexExpression:const n=e;return ha(n.table)&&ha(n.index);case M.UnaryExpression:return ha(e.operand);case M.BinaryExpression:const r=e;return ha(r.left)&&ha(r.right)}return!0}class ga{constructor(e,t,n){this.emitHost=e,this.program=t,this.sourceFile=n,this.currentIndent="",this.luaFile=void 0,this.relativeSourcePath=void 0,this.options=void 0,this.options=t.getCompilerOptions(),this.luaFile=f(oa(this.sourceFile,this.program)),"."===s.default.dirname(this.luaFile)||""===this.sourceFile?this.relativeSourcePath=f(s.default.dirname(this.luaFile)):this.relativeSourcePath=f(s.default.relative(s.default.dirname(this.luaFile),this.sourceFile))}print(e){this.options.sourceMapTraceback&&e.luaLibFeatures.add(Le.SourceMapTraceBack);const t=this.options.sourceRoot?`${this.options.sourceRoot.replace(/[\\/]+$/,"")}/`:"",n=this.printFile(e),r=this.buildSourceMap(t,n);let i=n.toString();if(this.options.inlineSourceMap&&(i+="\n"+this.printInlineSourceMap(r)),this.options.sourceMapTraceback){const e=this.printStackTraceOverride(n);i=i.replace(ga.sourceMapTracebackPlaceholder,e)}return{code:i,sourceMap:r.toString(),sourceMapNode:n}}printInlineSourceMap(e){const t=e.toString();return`--# sourceMappingURL=data:application/json;base64,${Buffer.from(t).toString("base64")}\n`}printStackTraceOverride(e){let t=1;const n={};e.walk(((e,r)=>{void 0!==r.line&&r.line>0&&(void 0===n[t]?n[t]=r.line:n[t]=Math.min(n[t],r.line)),t+=e.split("\n").length-1}));return`__TS__SourceMapTraceBack(debug.getinfo(1).short_src, ${"{"+Object.entries(n).map((e=>{let[t,n]=e;return`["${t}"] = ${n}`})).join(",")+"}"});`}printFile(e){var t,n;let r=[e.trivia];this.options.noHeader||r.push(ma);const i=null!==(t=this.options.luaTarget)&&void 0!==t?t:F.Universal,s=null!==(n=this.options.luaLibImport)&&void 0!==n?n:w.Require;return(s===w.Require||s===w.RequireMinimal)&&e.luaLibFeatures.size>0?r=this.printStatementArray(function(e,t){const n=Pe(t),r=Array.from(e).flatMap((e=>n[e].exports));if(0===r.length)return[];const i=Te(Ee("require"),[ce("lualib_bundle")]),s=Ee("____lualib"),o=[V(s,i)];for(const a of r)o.push(V(Ee(a),Oe(s,ce(a))));return o}(e.luaLibFeatures,i,this.emitHost)):s===w.Inline&&e.luaLibFeatures.size>0&&(r.push("-- Lua Library inline imports\n"),r.push(Ke(e.luaLibFeatures,i,this.emitHost)),r.push("-- End of Lua Library inline imports\n")),this.options.sourceMapTraceback&&!I(this.options)&&r.push(`${ga.sourceMapTracebackPlaceholder}\n`),r.push(...this.printStatementArray(e.statements)),this.concatNodes(...r)}pushIndent(){this.currentIndent+="\t"}popIndent(){this.currentIndent=this.currentIndent.slice(1)}indent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.concatNodes(this.currentIndent,e)}createSourceNode(e,t,n){const{line:r,column:i}=B(e);return void 0!==r&&void 0!==i?new je.SourceNode(r+1,i,this.relativeSourcePath,t,n):new je.SourceNode(null,null,this.relativeSourcePath,t,n)}concatNodes(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new je.SourceNode(null,null,this.relativeSourcePath,t)}printBlock(e){return this.concatNodes(...this.printStatementArray(e.statements))}statementMayRequireSemiColon(e){return $(e)||e.kind===M.AssignmentStatement||function(e){return e.kind===M.ExpressionStatement}(e)}nodeStartsWithParenthesis(e){var t;let n;return e.walk((e=>{void 0===n&&(e=e.trimLeft()).length>0&&(n=e.startsWith("("))})),null!==(t=n)&&void 0!==t&&t}printStatementArray(e){const t=[];for(const[n,r]of e.entries()){const i=this.printStatement(r);if(n>0&&this.statementMayRequireSemiColon(e[n-1])&&this.nodeStartsWithParenthesis(i)&&t[n-1].add(";"),t.push(i),J(r))break}return t.length>0?[...c(t,"\n"),"\n"]:[]}printStatement(e){let t=this.printStatementExcludingComments(e);return e.leadingComments&&(t=this.concatNodes(e.leadingComments.map((e=>this.printComment(e))).join("\n"),"\n",t)),e.trailingComments&&(t=this.concatNodes(t,"\n",e.trailingComments.map((e=>this.printComment(e))).join("\n"))),t}printComment(e){if(Array.isArray(e)){if(0===e.length)return this.indent("--[[]]");{const[t,...n]=e,r=this.concatNodes(...n.map((e=>this.concatNodes("\n",this.indent(e)))));return this.concatNodes(this.indent("--[["),t,r,"]]")}}return this.indent(`--${e}`)}printStatementExcludingComments(e){switch(e.kind){case M.DoStatement:return this.printDoStatement(e);case M.VariableDeclarationStatement:return this.printVariableDeclarationStatement(e);case M.AssignmentStatement:return this.printVariableAssignmentStatement(e);case M.IfStatement:return this.printIfStatement(e);case M.WhileStatement:return this.printWhileStatement(e);case M.RepeatStatement:return this.printRepeatStatement(e);case M.ForStatement:return this.printForStatement(e);case M.ForInStatement:return this.printForInStatement(e);case M.GotoStatement:return this.printGotoStatement(e);case M.LabelStatement:return this.printLabelStatement(e);case M.ReturnStatement:return this.printReturnStatement(e);case M.BreakStatement:return this.printBreakStatement(e);case M.ContinueStatement:return this.printContinueStatement(e);case M.ExpressionStatement:return this.printExpressionStatement(e);default:throw new Error(`Tried to print unknown statement kind: ${M[e.kind]}`)}}printDoStatement(e){const t=[];return t.push(this.indent("do\n")),this.pushIndent(),t.push(...this.printStatementArray(e.statements)),this.popIndent(),t.push(this.indent("end")),this.concatNodes(...t)}printVariableDeclarationStatement(e){const t=[];return t.push(this.indent("local ")),Ne(e)?t.push(this.printFunctionDefinition(e)):(t.push(...this.joinChunksWithComma(e.left.map((e=>this.printExpression(e))))),e.right&&(t.push(" = "),t.push(...this.joinChunksWithComma(e.right.map((e=>this.printExpression(e))))))),this.createSourceNode(e,t)}printVariableAssignmentStatement(e){const t=[];if(t.push(this.indent()),Ne(e)&&0!==(e.right[0].flags&P.Declaration)){if(((e,t)=>(Ls(t)?/^[a-zA-Z0-9_\u00FF-\uFFFD.]+$/:/^[a-zA-Z0-9_.]+$/).test(e))(this.printExpression(e.left[0]).toString(),this.options))return t.push(this.printFunctionDefinition(e)),this.createSourceNode(e,t)}return t.push(...this.joinChunksWithComma(e.left.map((e=>this.printExpression(e))))),t.push(" = "),t.push(...this.joinChunksWithComma(e.right.map((e=>this.printExpression(e))))),this.createSourceNode(e,t)}printIfStatement(e){const t=[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"elseif":"if";return t.push(this.indent(n+" "),this.printExpression(e.condition)," then\n"),this.pushIndent(),t.push(this.printBlock(e.ifBlock)),this.popIndent(),e.elseBlock?e.elseBlock.kind===M.IfStatement?t.push(this.printIfStatement(e.elseBlock,!0)):(t.push(this.indent("else\n")),this.pushIndent(),t.push(this.printBlock(e.elseBlock)),this.popIndent(),t.push(this.indent("end"))):t.push(this.indent("end")),this.concatNodes(...t)}printWhileStatement(e){const t=[];return t.push(this.indent("while "),this.printExpression(e.condition)," do\n"),this.pushIndent(),t.push(this.printBlock(e.body)),this.popIndent(),t.push(this.indent("end")),this.concatNodes(...t)}printRepeatStatement(e){const t=[];return t.push(this.indent("repeat\n")),this.pushIndent(),t.push(this.printBlock(e.body)),this.popIndent(),t.push(this.indent("until "),this.printExpression(e.condition)),this.concatNodes(...t)}printForStatement(e){const t=this.printExpression(e.controlVariable),n=this.printExpression(e.controlVariableInitializer),r=this.printExpression(e.limitExpression),i=[];return i.push(this.indent("for "),t," = ",n,", ",r),e.stepExpression&&i.push(", ",this.printExpression(e.stepExpression)),i.push(" do\n"),this.pushIndent(),i.push(this.printBlock(e.body)),this.popIndent(),i.push(this.indent("end")),this.concatNodes(...i)}printForInStatement(e){const t=this.joinChunksWithComma(e.names.map((e=>this.printIdentifier(e)))),n=this.joinChunksWithComma(e.expressions.map((e=>this.printExpression(e)))),r=[];return r.push(this.indent("for "),...t," in ",...n," do\n"),this.pushIndent(),r.push(this.printBlock(e.body)),this.popIndent(),r.push(this.indent("end")),this.createSourceNode(e,r)}printGotoStatement(e){return this.createSourceNode(e,[this.indent("goto "),e.label])}printLabelStatement(e){return this.createSourceNode(e,[this.indent("::"),e.name,"::"])}printReturnStatement(e){if(0===e.expressions.length)return this.createSourceNode(e,this.indent("return"));const t=[];return t.push(...this.joinChunksWithComma(e.expressions.map((e=>this.printExpression(e))))),this.createSourceNode(e,[this.indent(),"return ",...t])}printBreakStatement(e){return this.createSourceNode(e,this.indent("break"))}printContinueStatement(e){return this.createSourceNode(e,this.indent("continue"))}printExpressionStatement(e){return this.createSourceNode(e,[this.indent(),this.printExpression(e.expression)])}printExpression(e){switch(e.kind){case M.StringLiteral:return this.printStringLiteral(e);case M.NumericLiteral:return this.printNumericLiteral(e);case M.NilKeyword:return this.printNilLiteral(e);case M.DotsKeyword:return this.printDotsLiteral(e);case M.ArgKeyword:return this.printArgLiteral(e);case M.TrueKeyword:case M.FalseKeyword:return this.printBooleanLiteral(e);case M.FunctionExpression:return this.printFunctionExpression(e);case M.TableFieldExpression:return this.printTableFieldExpression(e);case M.TableExpression:return this.printTableExpression(e);case M.UnaryExpression:return this.printUnaryExpression(e);case M.BinaryExpression:return this.printBinaryExpression(e);case M.CallExpression:return this.printCallExpression(e);case M.MethodCallExpression:return this.printMethodCallExpression(e);case M.Identifier:return this.printIdentifier(e);case M.TableIndexExpression:return this.printTableIndexExpression(e);case M.ParenthesizedExpression:return this.printParenthesizedExpression(e);case M.ConditionalExpression:return this.printConditionalExpression(e);default:throw new Error(`Tried to print unknown statement kind: ${M[e.kind]}`)}}printStringLiteral(e){return this.createSourceNode(e,fa(e.value))}printNumericLiteral(e){return this.createSourceNode(e,String(e.value))}printNilLiteral(e){return this.createSourceNode(e,"nil")}printDotsLiteral(e){return this.createSourceNode(e,"...")}printArgLiteral(e){return this.createSourceNode(e,"arg")}printBooleanLiteral(e){return this.createSourceNode(e,e.kind===M.TrueKeyword?"true":"false")}printFunctionParameters(e){var t;const n=(null!==(t=e.params)&&void 0!==t?t:[]).map((e=>this.printIdentifier(e)));return e.dots&&n.push(this.printDotsLiteral(e.dots)),this.joinChunksWithComma(n)}printFunctionExpression(e){const t=[];if(t.push("function("),t.push(...this.printFunctionParameters(e)),t.push(")"),function(e){var t;return 1===(null===(t=e.body.statements)||void 0===t?void 0:t.length)&&J(e.body.statements[0])&&void 0!==e.body.statements[0].expressions&&0!==(e.flags&P.Inline)}(e)){const n=e.body.statements[0];t.push(" ");const r=["return ",...this.joinChunksWithComma(n.expressions.map((e=>this.printExpression(e))))];t.push(this.createSourceNode(n,r)),t.push(this.createSourceNode(e," end"))}else t.push("\n"),this.pushIndent(),t.push(this.printBlock(e.body)),this.popIndent(),t.push(this.indent(this.createSourceNode(e,"end")));return this.createSourceNode(e,t)}printFunctionDefinition(e){const t=e.right[0],n=[];return n.push("function "),n.push(this.printExpression(e.left[0])),n.push("("),n.push(...this.printFunctionParameters(t)),n.push(")\n"),this.pushIndent(),n.push(this.printBlock(t.body)),this.popIndent(),n.push(this.indent(this.createSourceNode(e,"end"))),this.createSourceNode(t,n)}printTableFieldExpression(e){const t=[],n=this.printExpression(e.value);return e.key?ae(e.key)&&Is(e.key.value,this.options)?t.push(e.key.value," = ",n):t.push("[",this.printExpression(e.key),"] = ",n):t.push(n),this.createSourceNode(e,t)}printTableExpression(e){return this.createSourceNode(e,["{",...this.printExpressionList(e.fields),"}"])}printUnaryExpression(e){const t=[];return t.push(this.printOperator(e.operator)),t.push(this.printExpressionInParenthesesIfNeeded(e.operand,ga.operatorPrecedence[e.operator])),this.createSourceNode(e,t)}printBinaryExpression(e){const t=[],n=ga.rightAssociativeOperators.has(e.operator),r=ga.operatorPrecedence[e.operator];return t.push(this.printExpressionInParenthesesIfNeeded(e.left,n?r+1:r)),t.push(" ",this.printOperator(e.operator)," "),t.push(this.printExpressionInParenthesesIfNeeded(e.right,n?r:r+1)),this.createSourceNode(e,t)}printExpressionInParenthesesIfNeeded(e,t){return this.needsParenthesis(e,t)?this.createSourceNode(e,["(",this.printExpression(e),")"]):this.printExpression(e)}needsParenthesis(e,t){return ye(e)||he(e)?void 0===t||ga.operatorPrecedence[e.operator]<t:le(e)||e.kind===M.TableExpression}printCallExpression(e){const t=[];return t.push(this.printExpressionInParenthesesIfNeeded(e.expression),"("),e.params&&t.push(...this.printExpressionList(e.params)),t.push(")"),this.createSourceNode(e,t)}printMethodCallExpression(e){const t=[],n=this.needsParenthesis(e.prefixExpression)||ae(e.prefixExpression)?["(",this.printExpression(e.prefixExpression),")"]:[this.printExpression(e.prefixExpression)],r=this.printIdentifier(e.name);return t.push(...n,":",r,"("),e.params&&t.push(...this.printExpressionList(e.params)),t.push(")"),this.createSourceNode(e,t)}printIdentifier(e){return this.createSourceNode(e,e.text,e.originalName!==e.text?e.originalName:void 0)}printTableIndexExpression(e){const t=[];return t.push(this.printExpressionInParenthesesIfNeeded(e.table)),ae(e.index)&&Is(e.index.value,this.options)?t.push(".",this.createSourceNode(e.index,e.index.value)):t.push("[",this.printExpression(e.index),"]"),this.createSourceNode(e,t)}printParenthesizedExpression(e){return this.createSourceNode(e,["(",this.printExpression(e.expression),")"])}printConditionalExpression(e){return this.createSourceNode(e,["if ",this.printExpression(e.condition)," then ",this.printExpression(e.whenTrue)," else ",this.printExpression(e.whenFalse)])}printOperator(e){return new je.SourceNode(null,null,this.relativeSourcePath,ga.operatorMap[e])}joinChunksWithComma(e){return c(e,", ")}isSimpleExpressionList(e){return e.length<=1||!(e.length>4)&&e.every(ha)}printExpressionList(e){const t=[];if(this.isSimpleExpressionList(e))t.push(...this.joinChunksWithComma(e.map((e=>this.printExpression(e)))));else{t.push("\n"),this.pushIndent();for(const[n,r]of e.entries()){const i=n<e.length-1?",\n":"\n";t.push(this.indent(),this.printExpression(r),i)}this.popIndent(),t.push(this.indent())}return t}buildSourceMap(e,t){const n=new je.SourceMapGenerator({file:s.default.basename(this.luaFile),sourceRoot:e});let r,i=1,o=0;const a=e=>{(e=>null!==e.line&&(void 0===r||(r.generated.line!==i||r.generated.column!==o||r.name!==e.name)&&(r.original.line!==e.line||r.original.column!==e.column||r.name!==e.name)))(e)&&(r={source:e.source,original:{line:e.line,column:e.column},generated:{line:i,column:o},name:e.name},n.addMapping(r));for(const t of e.children)if("string"===typeof t){const e=t.split("\n");e.length>1&&(i+=e.length-1,o=0,r=void 0),o+=e[e.length-1].length}else a(t)};return a(t),n}}ga.operatorMap={[M.AdditionOperator]:"+",[M.SubtractionOperator]:"-",[M.MultiplicationOperator]:"*",[M.DivisionOperator]:"/",[M.FloorDivisionOperator]:"//",[M.ModuloOperator]:"%",[M.PowerOperator]:"^",[M.NegationOperator]:"-",[M.ConcatOperator]:"..",[M.LengthOperator]:"#",[M.EqualityOperator]:"==",[M.InequalityOperator]:"~=",[M.LessThanOperator]:"<",[M.LessEqualOperator]:"<=",[M.GreaterThanOperator]:">",[M.GreaterEqualOperator]:">=",[M.AndOperator]:"and",[M.OrOperator]:"or",[M.NotOperator]:"not ",[M.BitwiseAndOperator]:"&",[M.BitwiseOrOperator]:"|",[M.BitwiseExclusiveOrOperator]:"~",[M.BitwiseRightShiftOperator]:">>",[M.BitwiseLeftShiftOperator]:"<<",[M.BitwiseNotOperator]:"~"},ga.operatorPrecedence={[M.OrOperator]:1,[M.AndOperator]:2,[M.EqualityOperator]:3,[M.InequalityOperator]:3,[M.LessThanOperator]:3,[M.LessEqualOperator]:3,[M.GreaterThanOperator]:3,[M.GreaterEqualOperator]:3,[M.BitwiseOrOperator]:4,[M.BitwiseExclusiveOrOperator]:5,[M.BitwiseAndOperator]:6,[M.BitwiseLeftShiftOperator]:7,[M.BitwiseRightShiftOperator]:7,[M.ConcatOperator]:8,[M.AdditionOperator]:9,[M.SubtractionOperator]:9,[M.MultiplicationOperator]:10,[M.DivisionOperator]:10,[M.FloorDivisionOperator]:10,[M.ModuloOperator]:10,[M.NotOperator]:11,[M.LengthOperator]:11,[M.NegationOperator]:11,[M.BitwiseNotOperator]:11,[M.PowerOperator]:12},ga.rightAssociativeOperators=new Set([M.ConcatOperator,M.PowerOperator]),ga.sourceMapTracebackPlaceholder="{#SourceMapTraceback}";var ya=n(59852);const Sa=i.ScriptTarget.ESNext,xa=i.ModuleKind.ESNext,Ta={strict:!0,jsx:i.JsxEmit.React,luaTarget:F.Lua54,luaLibImport:w.Require,noHeader:!0,sourceMap:!0,noImplicitSelf:!0,moduleResolution:i.ModuleResolutionKind.Classic,target:Sa,module:xa};function va(e,t){const n=o.A.path.dirname(e),s=new Map,a=new Map,c=new Set;return[{fileExists:t=>{if(t.search("node_modules")>0)return!1;t=o.A.path.normalize(t);const i=a.get(t);if(void 0!==i){if(null!==r.editor.getModel(i))return!0}const s=o.A.path.basename(t);if(s.startsWith("Dora.d."))return!1;if(s.startsWith("Dora."))return!0;if(s.toLowerCase().startsWith("dora."))return!1;if("lib.Dora.d.ts"===s)return!0;if(o.A.path.isAbsolute(t)){const i=o.A.path.relative(n,t);if(!i.startsWith("..")){const n=o.A.path.extname(i);let s=o.A.path.basename(i,n);s=".d"===o.A.path.extname(s)?o.A.path.basename(s,".d"):s;const u=s,l=o.A.path.dirname(i),p=o.A.path.join(l,u);for(const e of[".d.ts",".ts",".tsx"]){const n=r.Uri.file(p+e);if(null!==r.editor.getModel(n))return a.set(t,n),!0}if(c.has(p))return!1;const d=ya.Wf({path:p,exts:[".d.ts",".ts",".tsx"],projFile:e});if(null!==d&&void 0!==d&&d.success){const e=r.Uri.file(d.fullPath);return null===r.editor.getModel(e)&&r.editor.createModel(d.content,"typescript",e),a.set(t,e),!0}a.delete(t),c.add(p)}}const u=o.A.path.extname(t);let l=o.A.path.basename(t,u);l=".d"===o.A.path.extname(l)?o.A.path.basename(l,".d"):l;for(const e of[".d.ts",".ts",".tsx"]){const n=r.Uri.file(o.A.path.join(o.A.path.dirname(t),l+e));if(null!==r.editor.getModel(n))return a.set(t,n),!0}return!1},getCanonicalFileName:e=>o.A.path.normalize(e),getCurrentDirectory:()=>n,getDefaultLibFileName:()=>"lib.Dora.d.ts",readFile:e=>{e=o.A.path.normalize(e);const n=r.Uri.file(e),i=r.editor.getModel(n);if(null!==i)return i.getValue();const s=ya.Wf({path:e});return null!==s&&void 0!==s&&s.success&&null===r.editor.getModel(n)&&r.editor.createModel(s.content,"typescript",n),t},getNewLine:()=>"\n",useCaseSensitiveFileNames:()=>!0,writeFile:(e,t)=>{s.set(e,t)},getSourceFile(n){n=o.A.path.normalize(n);const s=o.A.path.basename(n);if(s.startsWith("Dora."))return i.createSourceFile("dummy.d.ts","",Sa,!1);if("jsx.d.ts"===s){const t=r.Uri.file(s),n=r.editor.getModel(t);if(null!==n)return i.createSourceFile(s,n.getValue(),Sa,!1);{const n=ya.Wf({path:s,projFile:e});if(null!==n&&void 0!==n&&n.success)return r.editor.createModel(n.content,"typescript",t),i.createSourceFile(s,n.content,Sa,!1)}}if("lib.Dora.d.ts"===s){const e=r.Uri.file("Dora.d.ts"),t=r.editor.getModel(e);if(null!==t)return i.createSourceFile("Dora.d.ts",t.getValue(),Sa,!1);{const t=ya.Wf({path:"Dora.d.ts"});if(null!==t&&void 0!==t&&t.success)return r.editor.createModel(t.content,"typescript",e),i.createSourceFile("Dora.d.ts",t.content,Sa,!1)}}const c=r.languages.typescript.typescriptDefaults.getExtraLibs()[n];if(c)return i.createSourceFile(n,c.content,Sa,!1);if(!o.A.path.isAbsolute(n)||""===o.A.path.relative(e,n))return i.createSourceFile(n,t,Sa,!1);{const e=a.get(n);if(void 0!==e){const t=r.editor.getModel(e);if(null!==t)return i.createSourceFile(e.fsPath,t.getValue(),Sa,!1)}}}},s]}async function Ea(e,t){const n=function(e,t){const[n]=va(e,t);return Ta.baseUrl=o.A.path.dirname(e),i.createProgram([e],Ta,n)}(e,t);let r=i.getPreEmitDiagnostics(n);const s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".lua";const t=[];return{writeFile:function(n,r,i,s){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=t.find((e=>l(e.sourceFiles,o).length>0));a?a.sourceFiles=u(a.sourceFiles,o):(a={outPath:n,sourceFiles:[...o]},t.push(a)),n.endsWith(e)?a.lua=r:n.endsWith(`${e}.map`)?a.luaSourceMap=r:n.endsWith(".js")?a.js=r:n.endsWith(".js.map")?a.jsSourceMap=r:n.endsWith(".d.ts")?a.declaration=r:n.endsWith(".d.ts.map")&&(a.declarationMap=r)},files:t}}(),a=new sa({emitHost:{directoryExists:()=>!1,fileExists:()=>!0,getCurrentDirectory:()=>o.A.path.dirname(e),readFile:()=>"",writeFile:()=>{}}}).emit({program:n,writeFile:s.writeFile});r=[...r,...a.diagnostics].filter((e=>2497!==e.code&&2666!==e.code));const c=r.filter((t=>{try{var n,r;return""!==o.A.path.relative(null!==(n=null===(r=t.file)||void 0===r?void 0:r.fileName)&&void 0!==n?n:"",e)}catch{return!0}}));Oa(e,c);const p=0===r.length,d=s.files.find((t=>{let{sourceFiles:n}=t;return n.some((t=>""===o.A.path.relative(t.fileName,e)))}));if(void 0!==d){const t=d.luaSourceMap;if(void 0!==t&&void 0!==d.lua){const n=d.lua.split("\n");let i;return await je.SourceMapConsumer.with(t,null,(t=>{let r=null;i=`-- [${o.A.path.extname(e).substring(1).toLowerCase()}]: ${o.A.path.basename(e)}\n`+n.map(((e,n)=>{var i;const s=e.search(/\S|$/),o=t.originalPositionFor({line:n+1,column:s});null!=o.line&&(r=o.line);const a=null!==(i=r)&&void 0!==i?i:1;return""===e.trim()?"":e.match("--")?e:e+` -- ${a}`})).filter((e=>""!==e)).join("\n")})),{success:p,luaCode:i,diagnostics:r,extraError:c.length>0}}}return{success:p,luaCode:void 0,diagnostics:r,extraError:c.length>0}}async function ba(e){if(!e||e.isDisposed())return;const t=await r.languages.typescript.getTypeScriptWorker(),n=await t(e.uri),s=(await Promise.all([n.getSyntacticDiagnostics(e.uri.toString()),n.getSemanticDiagnostics(e.uri.toString())])).reduce(((e,t)=>e.concat(t))).filter((e=>2497!==e.code&&2666!==e.code)).map((t=>{let{start:n=0,length:s=0}=t;const o=e.getPositionAt(n),a=e.getPositionAt(n+s);return{severity:r.MarkerSeverity.Error,startLineNumber:o.lineNumber,startColumn:o.column,endLineNumber:a.lineNumber,endColumn:a.column,message:i.flattenDiagnosticMessageText(t.messageText,"\n")}}));r.editor.setModelMarkers(e,e.getLanguageId(),s)}function Aa(e,t){const n=t.filter((t=>{var n,r;const i=null!==(n=null===(r=t.file)||void 0===r?void 0:r.fileName)&&void 0!==n?n:"";if(!o.A.path.isAbsolute(i))return!1;if(!o.A.path.isAbsolute(e.uri.fsPath))return!1;try{return""===o.A.path.relative(i,e.uri.fsPath)&&"typescript-to-lua"===t.source}catch{return!1}})).map((t=>{let{start:n=0,length:s=0}=t;const o=e.getPositionAt(n),a=e.getPositionAt(n+s);return{severity:r.MarkerSeverity.Error,startLineNumber:o.lineNumber,startColumn:o.column,endLineNumber:a.lineNumber,endColumn:a.column,message:i.flattenDiagnosticMessageText(t.messageText,"\n")}}));r.editor.setModelMarkers(e,"tstl",n)}function _a(e,t){return 0===t.length?"":`Compiling error: ${e}\n`+i.formatDiagnostics(t,{getCanonicalFileName:e=>o.A.path.normalize(e),getCurrentDirectory:()=>o.A.path.dirname(e),getNewLine:()=>"\n"})}function Oa(e,t){if(0===t.length)return;const n=_a(e,t);ya.G5({code:`Log "Error", "${n.replace('"','\\"')}"`,log:!1})}je.SourceMapConsumer.initialize({"lib/mappings.wasm":"/mappings.wasm"});const ka={declaration:!0,emitDeclarationOnly:!0,strict:!0,jsx:i.JsxEmit.React,sourceMap:!0,moduleResolution:i.ModuleResolutionKind.Classic,target:Sa,module:xa};function Na(e,t){const[n,r]=va(e,t);Oa(e,i.createProgram([e],ka,n).emit().diagnostics);const s=o.A.path.basename(e,o.A.path.extname(e));for(const[i,a]of r.entries()){if(o.A.path.basename(i,".d.ts")===s&&i.endsWith(".d.ts"))return{fileName:i,content:a}}return null}},66247:()=>{},72615:()=>{},82202:()=>{},84021:()=>{},84351:()=>{},89387:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=89387,e.exports=t},97664:()=>{}}]);