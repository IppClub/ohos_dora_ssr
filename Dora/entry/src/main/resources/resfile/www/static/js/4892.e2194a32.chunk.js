"use strict";(self.webpackChunkdora_dora=self.webpackChunkdora_dora||[]).push([[4892],{64892:(t,e,s)=>{s.r(e),s.d(e,{default:()=>yi});var i,n,r,a=s(64467);class o{constructor(){(0,a.A)(this,"entries",{}),(0,a.A)(this,"size",0)}add(t){let e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}addAll(t){let e=this.size;for(var s=0,i=t.length;s<i;s++)this.add(t[s]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}class h{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,a.A)(this,"r",void 0),(0,a.A)(this,"g",void 0),(0,a.A)(this,"b",void 0),(0,a.A)(this,"a",void 0),this.r=t,this.g=e,this.b=s,this.a=i}set(t,e,s,i){return this.r=t,this.g=e,this.b=s,this.a=i,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,s,i){return this.r+=t,this.g+=e,this.b+=s,this.a+=i,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}toRgb888(){const t=t=>("0"+(255*t).toString(16)).slice(-2);return Number("0x"+t(this.r)+t(this.g)+t(this.b))}static fromString(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new h).setFromString(t)}}i=h,(0,a.A)(h,"WHITE",new i(1,1,1,1)),(0,a.A)(h,"RED",new i(1,0,0,1)),(0,a.A)(h,"GREEN",new i(0,1,0,1)),(0,a.A)(h,"BLUE",new i(0,0,1,1)),(0,a.A)(h,"MAGENTA",new i(1,0,1,1));class l{static clamp(t,e,s){return t<e?e:t>s?s:t}static cosDeg(t){return Math.cos(t*l.degRad)}static sinDeg(t){return Math.sin(t*l.degRad)}static atan2Deg(t,e){return Math.atan2(t,e)*l.degRad}static signum(t){return t>0?1:t<0?-1:0}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){let e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(t,e){return l.randomTriangularWith(t,e,.5*(t+e))}static randomTriangularWith(t,e,s){let i=Math.random(),n=e-t;return i<=(s-t)/n?t+Math.sqrt(i*n*(s-t)):e-Math.sqrt((1-i)*n*(e-s))}static isPowerOfTwo(t){return t&&0===(t&t-1)}}n=l,(0,a.A)(l,"PI",3.1415927),(0,a.A)(l,"PI2",2*n.PI),(0,a.A)(l,"invPI2",1/n.PI2),(0,a.A)(l,"radiansToDegrees",180/n.PI),(0,a.A)(l,"radDeg",n.radiansToDegrees),(0,a.A)(l,"degreesToRadians",n.PI/180),(0,a.A)(l,"degRad",n.degreesToRadians);class c{static arrayCopy(t,e,s,i,n){for(let r=e,a=i;r<e+n;r++,a++)s[a]=t[r]}static arrayFill(t,e,s,i){for(let n=e;n<s;n++)t[n]=i}static setArraySize(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.length;if(i==e)return t;if(t.length=e,i<e)for(let n=i;n<e;n++)t[n]=s;return t}static ensureArrayCapacity(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.length>=e?t:c.setArraySize(t,e,s)}static newArray(t,e){let s=new Array(t);for(let i=0;i<t;i++)s[i]=e;return s}static newFloatArray(t){if(c.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);{let e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}}static newShortArray(t){if(c.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);{let e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}}static toFloatArray(t){return c.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return c.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e){for(var s=0;s<t.length;s++)if(t[s]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}}(0,a.A)(c,"SUPPORTS_TYPED_ARRAYS","undefined"!==typeof Float32Array);class d{constructor(t){(0,a.A)(this,"items",new Array),(0,a.A)(this,"instantiator",void 0),this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class u{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,a.A)(this,"x",void 0),(0,a.A)(this,"y",void 0),this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){let t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}class m{constructor(){(0,a.A)(this,"maxDelta",.064),(0,a.A)(this,"framesPerSecond",0),(0,a.A)(this,"delta",0),(0,a.A)(this,"totalTime",0),(0,a.A)(this,"lastTime",Date.now()/1e3),(0,a.A)(this,"frameCount",0),(0,a.A)(this,"frameTime",0)}update(){let t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}class p{constructor(t){if((0,a.A)(this,"name",void 0),!t)throw new Error("name cannot be null.");this.name=t}}class g extends p{constructor(t){super(t),(0,a.A)(this,"id",g.nextID++),(0,a.A)(this,"bones",null),(0,a.A)(this,"vertices",[]),(0,a.A)(this,"worldVerticesLength",0),(0,a.A)(this,"timelineAttachment",this)}computeWorldVertices(t,e,s,i,n,r){s=n+(s>>1)*r;let a=t.bone.skeleton,o=t.deform,h=this.vertices,l=this.bones;if(!l){o.length>0&&(h=o);let a=t.bone,l=a.worldX,c=a.worldY,d=a.a,u=a.b,m=a.c,p=a.d;for(let t=e,o=n;o<s;t+=2,o+=r){let e=h[t],s=h[t+1];i[o]=e*d+s*u+l,i[o+1]=e*m+s*p+c}return}let c=0,d=0;for(let m=0;m<e;m+=2){let t=l[c];c+=t+1,d+=t}let u=a.bones;if(0==o.length)for(let m=n,p=3*d;m<s;m+=r){let t=0,e=0,s=l[c++];for(s+=c;c<s;c++,p+=3){let s=u[l[c]],i=h[p],n=h[p+1],r=h[p+2];t+=(i*s.a+n*s.b+s.worldX)*r,e+=(i*s.c+n*s.d+s.worldY)*r}i[m]=t,i[m+1]=e}else{let t=o;for(let e=n,a=3*d,o=d<<1;e<s;e+=r){let s=0,n=0,r=l[c++];for(r+=c;c<r;c++,a+=3,o+=2){let e=u[l[c]],i=h[a]+t[o],r=h[a+1]+t[o+1],d=h[a+2];s+=(i*e.a+r*e.b+e.worldX)*d,n+=(i*e.c+r*e.d+e.worldY)*d}i[e]=s,i[e+1]=n}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),c.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=c.newFloatArray(this.vertices.length),c.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}}(0,a.A)(g,"nextID",0);class f{constructor(t){(0,a.A)(this,"id",f.nextID()),(0,a.A)(this,"regions",void 0),(0,a.A)(this,"start",0),(0,a.A)(this,"digits",0),(0,a.A)(this,"setupIndex",0),this.regions=new Array(t)}copy(){let t=new f(this.regions.length);return c.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let s=t.sequenceIndex;-1==s&&(s=this.setupIndex),s>=this.regions.length&&(s=this.regions.length-1);let i=this.regions[s];e.region!=i&&(e.region=i,e.updateRegion())}getPath(t,e){let s=t,i=(this.start+e).toString();for(let n=this.digits-i.length;n>0;n--)s+="0";return s+=i,s}static nextID(){return f._nextID++}}(0,a.A)(f,"_nextID",0),function(t){t[t.hold=0]="hold",t[t.once=1]="once",t[t.loop=2]="loop",t[t.pingpong=3]="pingpong",t[t.onceReverse=4]="onceReverse",t[t.loopReverse=5]="loopReverse",t[t.pingpongReverse=6]="pingpongReverse"}(r||(r={}));const w=[r.hold,r.once,r.loop,r.pingpong,r.onceReverse,r.loopReverse,r.pingpongReverse];class A{constructor(t,e,s){if((0,a.A)(this,"name",void 0),(0,a.A)(this,"timelines",[]),(0,a.A)(this,"timelineIds",new o),(0,a.A)(this,"duration",void 0),!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=s}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,s,i,n,r,a,o){if(!t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(s%=this.duration,e>0&&(e%=this.duration));let h=this.timelines;for(let l=0,c=h.length;l<c;l++)h[l].apply(t,e,s,n,r,a,o)}}var x,b;!function(t){t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add"}(x||(x={})),function(t){t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut"}(b||(b={}));const v={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class y{constructor(t,e){(0,a.A)(this,"propertyIds",void 0),(0,a.A)(this,"frames",void 0),this.propertyIds=e,this.frames=c.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){let s=t.length;for(let i=1;i<s;i++)if(t[i]>e)return i-1;return s-1}static search(t,e,s){let i=t.length;for(let n=s;n<i;n+=s)if(t[n]>e)return n-s;return i-s}}class k extends y{constructor(t,e,s){super(t,s),(0,a.A)(this,"curves",void 0),this.curves=c.newFloatArray(t+18*e),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){let e=this.getFrameCount()+18*t;if(this.curves.length>e){let t=c.newFloatArray(e);c.arrayCopy(this.curves,0,t,0,e),this.curves=t}}setBezier(t,e,s,i,n,r,a,o,h,l,c){let d=this.curves,u=this.getFrameCount()+18*t;0==s&&(d[e]=2+u);let m=.03*(i-2*r+o),p=.03*(n-2*a+h),g=.006*(3*(r-o)-i+l),f=.006*(3*(a-h)-n+c),w=2*m+g,A=2*p+f,x=.3*(r-i)+m+.16666667*g,b=.3*(a-n)+p+.16666667*f,v=i+x,y=n+b;for(let k=u+18;u<k;u+=2)d[u]=v,d[u+1]=y,x+=w,b+=A,w+=g,A+=f,v+=x,y+=b}getBezierValue(t,e,s,i){let n=this.curves;if(n[i]>t){let r=this.frames[e],a=this.frames[e+s];return a+(t-r)/(n[i]-r)*(n[i+1]-a)}let r=i+18;for(i+=2;i<r;i+=2)if(n[i]>=t){let e=n[i-2],s=n[i-1];return s+(t-e)/(n[i]-e)*(n[i+1]-s)}e+=this.getFrameEntries();let a=n[r-2],o=n[r-1];return o+(t-a)/(this.frames[e]-a)*(this.frames[e+s]-o)}}class C extends k{constructor(t,e,s){super(t,e,[s])}getFrameEntries(){return 2}setFrame(t,e,s){t<<=1,this.frames[t]=e,this.frames[t+1]=s}getCurveValue(t){let e=this.frames,s=e.length-2;for(let n=2;n<=s;n+=2)if(e[n]>t){s=n-2;break}let i=this.curves[s>>1];switch(i){case 0:let i=e[s],n=e[s+1];return n+(t-i)/(e[s+2]-i)*(e[s+2+1]-n);case 1:return e[s+1]}return this.getBezierValue(t,s,1,i-2)}getRelativeValue(t,e,s,i,n){if(t<this.frames[0]){switch(s){case x.setup:return n;case x.first:return i+(n-i)*e}return i}let r=this.getCurveValue(t);switch(s){case x.setup:return n+r*e;case x.first:case x.replace:r+=n-i}return i+r*e}getAbsoluteValue(t,e,s,i,n){if(t<this.frames[0]){switch(s){case x.setup:return n;case x.first:return i+(n-i)*e}return i}let r=this.getCurveValue(t);return s==x.setup?n+(r-n)*e:i+(r-i)*e}getAbsoluteValue2(t,e,s,i,n,r){if(t<this.frames[0]){switch(s){case x.setup:return n;case x.first:return i+(n-i)*e}return i}return s==x.setup?n+(r-n)*e:i+(r-i)*e}getScaleValue(t,e,s,i,n,r){if(t<this.frames[0]){switch(s){case x.setup:return r;case x.first:return n+(r-n)*e}return n}let a=this.getCurveValue(t)*r;if(1==e)return s==x.add?n+a-r:a;if(i==b.mixOut)switch(s){case x.setup:return r+(Math.abs(a)*l.signum(r)-r)*e;case x.first:case x.replace:return n+(Math.abs(a)*l.signum(n)-n)*e}else{let t=0;switch(s){case x.setup:return t=Math.abs(r)*l.signum(a),t+(a-t)*e;case x.first:case x.replace:return t=Math.abs(n)*l.signum(a),t+(a-t)*e}}return n+(a-r)*e}}class S extends k{constructor(t,e,s,i){super(t,e,[s,i])}getFrameEntries(){return 3}setFrame(t,e,s,i){t*=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i}}class I extends C{constructor(t,e,s){super(t,e,v.rotate+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];o.active&&(o.rotation=this.getRelativeValue(s,n,r,o.rotation,o.data.rotation))}}class E extends S{constructor(t,e,s){super(t,e,v.x+"|"+s,v.y+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(s<h[0]){switch(r){case x.setup:return o.x=o.data.x,void(o.y=o.data.y);case x.first:o.x+=(o.data.x-o.x)*n,o.y+=(o.data.y-o.y)*n}return}let l=0,c=0,d=y.search(h,s,3),u=this.curves[d/3];switch(u){case 0:let t=h[d];l=h[d+1],c=h[d+2];let e=(s-t)/(h[d+3]-t);l+=(h[d+3+1]-l)*e,c+=(h[d+3+2]-c)*e;break;case 1:l=h[d+1],c=h[d+2];break;default:l=this.getBezierValue(s,d,1,u-2),c=this.getBezierValue(s,d,2,u+18-2)}switch(r){case x.setup:o.x=o.data.x+l*n,o.y=o.data.y+c*n;break;case x.first:case x.replace:o.x+=(o.data.x+l-o.x)*n,o.y+=(o.data.y+c-o.y)*n;break;case x.add:o.x+=l*n,o.y+=c*n}}}class T extends C{constructor(t,e,s){super(t,e,v.x+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];o.active&&(o.x=this.getRelativeValue(s,n,r,o.x,o.data.x))}}class M extends C{constructor(t,e,s){super(t,e,v.y+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];o.active&&(o.y=this.getRelativeValue(s,n,r,o.y,o.data.y))}}class R extends S{constructor(t,e,s){super(t,e,v.scaleX+"|"+s,v.scaleY+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h,c,d=this.frames;if(s<d[0]){switch(r){case x.setup:return o.scaleX=o.data.scaleX,void(o.scaleY=o.data.scaleY);case x.first:o.scaleX+=(o.data.scaleX-o.scaleX)*n,o.scaleY+=(o.data.scaleY-o.scaleY)*n}return}let u=y.search(d,s,3),m=this.curves[u/3];switch(m){case 0:let t=d[u];h=d[u+1],c=d[u+2];let e=(s-t)/(d[u+3]-t);h+=(d[u+3+1]-h)*e,c+=(d[u+3+2]-c)*e;break;case 1:h=d[u+1],c=d[u+2];break;default:h=this.getBezierValue(s,u,1,m-2),c=this.getBezierValue(s,u,2,m+18-2)}if(h*=o.data.scaleX,c*=o.data.scaleY,1==n)r==x.add?(o.scaleX+=h-o.data.scaleX,o.scaleY+=c-o.data.scaleY):(o.scaleX=h,o.scaleY=c);else{let t=0,e=0;if(a==b.mixOut)switch(r){case x.setup:t=o.data.scaleX,e=o.data.scaleY,o.scaleX=t+(Math.abs(h)*l.signum(t)-t)*n,o.scaleY=e+(Math.abs(c)*l.signum(e)-e)*n;break;case x.first:case x.replace:t=o.scaleX,e=o.scaleY,o.scaleX=t+(Math.abs(h)*l.signum(t)-t)*n,o.scaleY=e+(Math.abs(c)*l.signum(e)-e)*n;break;case x.add:o.scaleX+=(h-o.data.scaleX)*n,o.scaleY+=(c-o.data.scaleY)*n}else switch(r){case x.setup:t=Math.abs(o.data.scaleX)*l.signum(h),e=Math.abs(o.data.scaleY)*l.signum(c),o.scaleX=t+(h-t)*n,o.scaleY=e+(c-e)*n;break;case x.first:case x.replace:t=Math.abs(o.scaleX)*l.signum(h),e=Math.abs(o.scaleY)*l.signum(c),o.scaleX=t+(h-t)*n,o.scaleY=e+(c-e)*n;break;case x.add:o.scaleX+=(h-o.data.scaleX)*n,o.scaleY+=(c-o.data.scaleY)*n}}}}class F extends C{constructor(t,e,s){super(t,e,v.scaleX+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];o.active&&(o.scaleX=this.getScaleValue(s,n,r,a,o.scaleX,o.data.scaleX))}}class Y extends C{constructor(t,e,s){super(t,e,v.scaleY+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];o.active&&(o.scaleY=this.getScaleValue(s,n,r,a,o.scaleY,o.data.scaleY))}}class L extends S{constructor(t,e,s){super(t,e,v.shearX+"|"+s,v.shearY+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(s<h[0]){switch(r){case x.setup:return o.shearX=o.data.shearX,void(o.shearY=o.data.shearY);case x.first:o.shearX+=(o.data.shearX-o.shearX)*n,o.shearY+=(o.data.shearY-o.shearY)*n}return}let l=0,c=0,d=y.search(h,s,3),u=this.curves[d/3];switch(u){case 0:let t=h[d];l=h[d+1],c=h[d+2];let e=(s-t)/(h[d+3]-t);l+=(h[d+3+1]-l)*e,c+=(h[d+3+2]-c)*e;break;case 1:l=h[d+1],c=h[d+2];break;default:l=this.getBezierValue(s,d,1,u-2),c=this.getBezierValue(s,d,2,u+18-2)}switch(r){case x.setup:o.shearX=o.data.shearX+l*n,o.shearY=o.data.shearY+c*n;break;case x.first:case x.replace:o.shearX+=(o.data.shearX+l-o.shearX)*n,o.shearY+=(o.data.shearY+c-o.shearY)*n;break;case x.add:o.shearX+=l*n,o.shearY+=c*n}}}class B extends C{constructor(t,e,s){super(t,e,v.shearX+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];o.active&&(o.shearX=this.getRelativeValue(s,n,r,o.shearX,o.data.shearX))}}class X extends C{constructor(t,e,s){super(t,e,v.shearY+"|"+s),(0,a.A)(this,"boneIndex",0),this.boneIndex=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];o.active&&(o.shearY=this.getRelativeValue(s,n,r,o.shearY,o.data.shearY))}}class P extends y{constructor(t,e){super(t,[v.inherit+"|"+e]),(0,a.A)(this,"boneIndex",0),this.boneIndex=e}getFrameEntries(){return 2}setFrame(t,e,s){t*=2,this.frames[t]=e,this.frames[t+1]=s}apply(t,e,s,i,n,r,a){let o=t.bones[this.boneIndex];if(!o.active)return;if(a==b.mixOut)return void(r==x.setup&&(o.inherit=o.data.inherit));let h=this.frames;s<h[0]?r!=x.setup&&r!=x.first||(o.inherit=o.data.inherit):o.inherit=this.frames[y.search(h,s,2)+1]}}class V extends k{constructor(t,e,s){super(t,e,[v.rgb+"|"+s,v.alpha+"|"+s]),(0,a.A)(this,"slotIndex",0),this.slotIndex=s}getFrameEntries(){return 5}setFrame(t,e,s,i,n,r){t*=5,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=r}apply(t,e,s,i,n,r,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,l=o.color;if(s<h[0]){let t=o.data.color;switch(r){case x.setup:return void l.setFromColor(t);case x.first:l.add((t.r-l.r)*n,(t.g-l.g)*n,(t.b-l.b)*n,(t.a-l.a)*n)}return}let c=0,d=0,u=0,m=0,p=y.search(h,s,5),g=this.curves[p/5];switch(g){case 0:let t=h[p];c=h[p+1],d=h[p+2],u=h[p+3],m=h[p+4];let e=(s-t)/(h[p+5]-t);c+=(h[p+5+1]-c)*e,d+=(h[p+5+2]-d)*e,u+=(h[p+5+3]-u)*e,m+=(h[p+5+4]-m)*e;break;case 1:c=h[p+1],d=h[p+2],u=h[p+3],m=h[p+4];break;default:c=this.getBezierValue(s,p,1,g-2),d=this.getBezierValue(s,p,2,g+18-2),u=this.getBezierValue(s,p,3,g+36-2),m=this.getBezierValue(s,p,4,g+54-2)}1==n?l.set(c,d,u,m):(r==x.setup&&l.setFromColor(o.data.color),l.add((c-l.r)*n,(d-l.g)*n,(u-l.b)*n,(m-l.a)*n))}}class D extends k{constructor(t,e,s){super(t,e,[v.rgb+"|"+s]),(0,a.A)(this,"slotIndex",0),this.slotIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,i,n){t<<=2,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=n}apply(t,e,s,i,n,r,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,l=o.color;if(s<h[0]){let t=o.data.color;switch(r){case x.setup:return l.r=t.r,l.g=t.g,void(l.b=t.b);case x.first:l.r+=(t.r-l.r)*n,l.g+=(t.g-l.g)*n,l.b+=(t.b-l.b)*n}return}let c=0,d=0,u=0,m=y.search(h,s,4),p=this.curves[m>>2];switch(p){case 0:let t=h[m];c=h[m+1],d=h[m+2],u=h[m+3];let e=(s-t)/(h[m+4]-t);c+=(h[m+4+1]-c)*e,d+=(h[m+4+2]-d)*e,u+=(h[m+4+3]-u)*e;break;case 1:c=h[m+1],d=h[m+2],u=h[m+3];break;default:c=this.getBezierValue(s,m,1,p-2),d=this.getBezierValue(s,m,2,p+18-2),u=this.getBezierValue(s,m,3,p+36-2)}if(1==n)l.r=c,l.g=d,l.b=u;else{if(r==x.setup){let t=o.data.color;l.r=t.r,l.g=t.g,l.b=t.b}l.r+=(c-l.r)*n,l.g+=(d-l.g)*n,l.b+=(u-l.b)*n}}}class O extends C{constructor(t,e,s){super(t,e,v.alpha+"|"+s),(0,a.A)(this,"slotIndex",0),this.slotIndex=s}apply(t,e,s,i,n,r,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=o.color;if(s<this.frames[0]){let t=o.data.color;switch(r){case x.setup:return void(h.a=t.a);case x.first:h.a+=(t.a-h.a)*n}return}let l=this.getCurveValue(s);1==n?h.a=l:(r==x.setup&&(h.a=o.data.color.a),h.a+=(l-h.a)*n)}}class N extends k{constructor(t,e,s){super(t,e,[v.rgb+"|"+s,v.alpha+"|"+s,v.rgb2+"|"+s]),(0,a.A)(this,"slotIndex",0),this.slotIndex=s}getFrameEntries(){return 8}setFrame(t,e,s,i,n,r,a,o,h){t<<=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=r,this.frames[t+5]=a,this.frames[t+6]=o,this.frames[t+7]=h}apply(t,e,s,i,n,r,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,l=o.color,c=o.darkColor;if(s<h[0]){let t=o.data.color,e=o.data.darkColor;switch(r){case x.setup:return l.setFromColor(t),c.r=e.r,c.g=e.g,void(c.b=e.b);case x.first:l.add((t.r-l.r)*n,(t.g-l.g)*n,(t.b-l.b)*n,(t.a-l.a)*n),c.r+=(e.r-c.r)*n,c.g+=(e.g-c.g)*n,c.b+=(e.b-c.b)*n}return}let d=0,u=0,m=0,p=0,g=0,f=0,w=0,A=y.search(h,s,8),b=this.curves[A>>3];switch(b){case 0:let t=h[A];d=h[A+1],u=h[A+2],m=h[A+3],p=h[A+4],g=h[A+5],f=h[A+6],w=h[A+7];let e=(s-t)/(h[A+8]-t);d+=(h[A+8+1]-d)*e,u+=(h[A+8+2]-u)*e,m+=(h[A+8+3]-m)*e,p+=(h[A+8+4]-p)*e,g+=(h[A+8+5]-g)*e,f+=(h[A+8+6]-f)*e,w+=(h[A+8+7]-w)*e;break;case 1:d=h[A+1],u=h[A+2],m=h[A+3],p=h[A+4],g=h[A+5],f=h[A+6],w=h[A+7];break;default:d=this.getBezierValue(s,A,1,b-2),u=this.getBezierValue(s,A,2,b+18-2),m=this.getBezierValue(s,A,3,b+36-2),p=this.getBezierValue(s,A,4,b+54-2),g=this.getBezierValue(s,A,5,b+72-2),f=this.getBezierValue(s,A,6,b+90-2),w=this.getBezierValue(s,A,7,b+108-2)}if(1==n)l.set(d,u,m,p),c.r=g,c.g=f,c.b=w;else{if(r==x.setup){l.setFromColor(o.data.color);let t=o.data.darkColor;c.r=t.r,c.g=t.g,c.b=t.b}l.add((d-l.r)*n,(u-l.g)*n,(m-l.b)*n,(p-l.a)*n),c.r+=(g-c.r)*n,c.g+=(f-c.g)*n,c.b+=(w-c.b)*n}}}class U extends k{constructor(t,e,s){super(t,e,[v.rgb+"|"+s,v.rgb2+"|"+s]),(0,a.A)(this,"slotIndex",0),this.slotIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,i,n,r,a,o){t*=7,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=r,this.frames[t+5]=a,this.frames[t+6]=o}apply(t,e,s,i,n,r,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,l=o.color,c=o.darkColor;if(s<h[0]){let t=o.data.color,e=o.data.darkColor;switch(r){case x.setup:return l.r=t.r,l.g=t.g,l.b=t.b,c.r=e.r,c.g=e.g,void(c.b=e.b);case x.first:l.r+=(t.r-l.r)*n,l.g+=(t.g-l.g)*n,l.b+=(t.b-l.b)*n,c.r+=(e.r-c.r)*n,c.g+=(e.g-c.g)*n,c.b+=(e.b-c.b)*n}return}let d=0,u=0,m=0,p=0,g=0,f=0,w=y.search(h,s,7),A=this.curves[w/7];switch(A){case 0:let t=h[w];d=h[w+1],u=h[w+2],m=h[w+3],p=h[w+4],g=h[w+5],f=h[w+6];let e=(s-t)/(h[w+7]-t);d+=(h[w+7+1]-d)*e,u+=(h[w+7+2]-u)*e,m+=(h[w+7+3]-m)*e,p+=(h[w+7+4]-p)*e,g+=(h[w+7+5]-g)*e,f+=(h[w+7+6]-f)*e;break;case 1:d=h[w+1],u=h[w+2],m=h[w+3],p=h[w+4],g=h[w+5],f=h[w+6];break;default:d=this.getBezierValue(s,w,1,A-2),u=this.getBezierValue(s,w,2,A+18-2),m=this.getBezierValue(s,w,3,A+36-2),p=this.getBezierValue(s,w,4,A+54-2),g=this.getBezierValue(s,w,5,A+72-2),f=this.getBezierValue(s,w,6,A+90-2)}if(1==n)l.r=d,l.g=u,l.b=m,c.r=p,c.g=g,c.b=f;else{if(r==x.setup){let t=o.data.color,e=o.data.darkColor;l.r=t.r,l.g=t.g,l.b=t.b,c.r=e.r,c.g=e.g,c.b=e.b}l.r+=(d-l.r)*n,l.g+=(u-l.g)*n,l.b+=(m-l.b)*n,c.r+=(p-c.r)*n,c.g+=(g-c.g)*n,c.b+=(f-c.b)*n}}}class W extends y{constructor(t,e){super(t,[v.attachment+"|"+e]),(0,a.A)(this,"slotIndex",0),(0,a.A)(this,"attachmentNames",void 0),this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,i,n,r,a){let o=t.slots[this.slotIndex];o.bone.active&&(a!=b.mixOut?s<this.frames[0]?r!=x.setup&&r!=x.first||this.setAttachment(t,o,o.data.attachmentName):this.setAttachment(t,o,this.attachmentNames[y.search1(this.frames,s)]):r==x.setup&&this.setAttachment(t,o,o.data.attachmentName))}setAttachment(t,e,s){e.setAttachment(s?t.getAttachment(this.slotIndex,s):null)}}class z extends k{constructor(t,e,s,i){super(t,e,[v.deform+"|"+s+"|"+i.id]),(0,a.A)(this,"slotIndex",0),(0,a.A)(this,"attachment",void 0),(0,a.A)(this,"vertices",void 0),this.slotIndex=s,this.attachment=i,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.vertices[t]=s}setBezier(t,e,s,i,n,r,a,o,h,l,c){let d=this.curves,u=this.getFrameCount()+18*t;0==s&&(d[e]=2+u);let m=.03*(i-2*r+o),p=.03*h-.06*a,g=.006*(3*(r-o)-i+l),f=.018*(a-h+.33333333),w=2*m+g,A=2*p+f,x=.3*(r-i)+m+.16666667*g,b=.3*a+p+.16666667*f,v=i+x,y=b;for(let k=u+18;u<k;u+=2)d[u]=v,d[u+1]=y,x+=w,b+=A,w+=g,A+=f,v+=x,y+=b}getCurvePercent(t,e){let s=this.curves,i=s[e];switch(i){case 0:let s=this.frames[e];return(t-s)/(this.frames[e+this.getFrameEntries()]-s);case 1:return 0}if(i-=2,s[i]>t){let n=this.frames[e];return s[i+1]*(t-n)/(s[i]-n)}let n=i+18;for(i+=2;i<n;i+=2)if(s[i]>=t){let e=s[i-2],n=s[i-1];return n+(t-e)/(s[i]-e)*(s[i+1]-n)}let r=s[n-2],a=s[n-1];return a+(1-a)*(t-r)/(this.frames[e+this.getFrameEntries()]-r)}apply(t,e,s,i,n,r,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=o.getAttachment();if(!h)return;if(!(h instanceof g)||h.timelineAttachment!=this.attachment)return;let l=o.deform;0==l.length&&(r=x.setup);let d=this.vertices,u=d[0].length,m=this.frames;if(s<m[0]){switch(r){case x.setup:return void(l.length=0);case x.first:if(1==n)return void(l.length=0);l.length=u;let t=h;if(t.bones){n=1-n;for(p=0;p<u;p++)l[p]*=n}else{let e=t.vertices;for(var p=0;p<u;p++)l[p]+=(e[p]-l[p])*n}}return}if(l.length=u,s>=m[m.length-1]){let t=d[m.length-1];if(1==n)if(r==x.add){let e=h;if(e.bones)for(let s=0;s<u;s++)l[s]+=t[s];else{let s=e.vertices;for(let e=0;e<u;e++)l[e]+=t[e]-s[e]}}else c.arrayCopy(t,0,l,0,u);else switch(r){case x.setup:{let e=h;if(e.bones)for(let s=0;s<u;s++)l[s]=t[s]*n;else{let s=e.vertices;for(let e=0;e<u;e++){let i=s[e];l[e]=i+(t[e]-i)*n}}break}case x.first:case x.replace:for(let s=0;s<u;s++)l[s]+=(t[s]-l[s])*n;break;case x.add:let e=h;if(e.bones)for(let s=0;s<u;s++)l[s]+=t[s]*n;else{let s=e.vertices;for(let e=0;e<u;e++)l[e]+=(t[e]-s[e])*n}}return}let f=y.search1(m,s),w=this.getCurvePercent(s,f),A=d[f],b=d[f+1];if(1==n)if(r==x.add){let t=h;if(t.bones)for(let e=0;e<u;e++){let t=A[e];l[e]+=t+(b[e]-t)*w}else{let e=t.vertices;for(let t=0;t<u;t++){let s=A[t];l[t]+=s+(b[t]-s)*w-e[t]}}}else for(let c=0;c<u;c++){let t=A[c];l[c]=t+(b[c]-t)*w}else switch(r){case x.setup:{let t=h;if(t.bones)for(let e=0;e<u;e++){let t=A[e];l[e]=(t+(b[e]-t)*w)*n}else{let e=t.vertices;for(let t=0;t<u;t++){let s=A[t],i=e[t];l[t]=i+(s+(b[t]-s)*w-i)*n}}break}case x.first:case x.replace:for(let e=0;e<u;e++){let t=A[e];l[e]+=(t+(b[e]-t)*w-l[e])*n}break;case x.add:let t=h;if(t.bones)for(let e=0;e<u;e++){let t=A[e];l[e]+=(t+(b[e]-t)*w)*n}else{let e=t.vertices;for(let t=0;t<u;t++){let s=A[t];l[t]+=(s+(b[t]-s)*w-e[t])*n}}}}}class q extends y{constructor(t){super(t,q.propertyIds),(0,a.A)(this,"events",void 0),this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,s,i,n,r,a){if(!i)return;let o=this.frames,h=this.frames.length;if(e>s)this.apply(t,e,Number.MAX_VALUE,i,n,r,a),e=-1;else if(e>=o[h-1])return;if(s<o[0])return;let l=0;if(e<o[0])l=0;else{l=y.search1(o,e)+1;let t=o[l];for(;l>0&&o[l-1]==t;)l--}for(;l<h&&s>=o[l];l++)i.push(this.events[l])}}(0,a.A)(q,"propertyIds",[""+v.event]);class G extends y{constructor(t){super(t,G.propertyIds),(0,a.A)(this,"drawOrders",void 0),this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.drawOrders[t]=s}apply(t,e,s,i,n,r,a){if(a==b.mixOut)return void(r==x.setup&&c.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));if(s<this.frames[0])return void(r!=x.setup&&r!=x.first||c.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));let o=y.search1(this.frames,s),h=this.drawOrders[o];if(h){let e=t.drawOrder,s=t.slots;for(let t=0,i=h.length;t<i;t++)e[t]=s[h[t]]}else c.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}}(0,a.A)(G,"propertyIds",[""+v.drawOrder]);class _ extends k{constructor(t,e,s){super(t,e,[v.ikConstraint+"|"+s]),(0,a.A)(this,"constraintIndex",0),this.constraintIndex=s}getFrameEntries(){return 6}setFrame(t,e,s,i,n,r,a){t*=6,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=n,this.frames[t+4]=r?1:0,this.frames[t+5]=a?1:0}apply(t,e,s,i,n,r,a){let o=t.ikConstraints[this.constraintIndex];if(!o.active)return;let h=this.frames;if(s<h[0]){switch(r){case x.setup:return o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,void(o.stretch=o.data.stretch);case x.first:o.mix+=(o.data.mix-o.mix)*n,o.softness+=(o.data.softness-o.softness)*n,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}let l=0,c=0,d=y.search(h,s,6),u=this.curves[d/6];switch(u){case 0:let t=h[d];l=h[d+1],c=h[d+2];let e=(s-t)/(h[d+6]-t);l+=(h[d+6+1]-l)*e,c+=(h[d+6+2]-c)*e;break;case 1:l=h[d+1],c=h[d+2];break;default:l=this.getBezierValue(s,d,1,u-2),c=this.getBezierValue(s,d,2,u+18-2)}r==x.setup?(o.mix=o.data.mix+(l-o.data.mix)*n,o.softness=o.data.softness+(c-o.data.softness)*n,a==b.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=h[d+3],o.compress=0!=h[d+4],o.stretch=0!=h[d+5])):(o.mix+=(l-o.mix)*n,o.softness+=(c-o.softness)*n,a==b.mixIn&&(o.bendDirection=h[d+3],o.compress=0!=h[d+4],o.stretch=0!=h[d+5]))}}class j extends k{constructor(t,e,s){super(t,e,[v.transformConstraint+"|"+s]),(0,a.A)(this,"constraintIndex",0),this.constraintIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,i,n,r,a,o){let h=this.frames;h[t*=7]=e,h[t+1]=s,h[t+2]=i,h[t+3]=n,h[t+4]=r,h[t+5]=a,h[t+6]=o}apply(t,e,s,i,n,r,a){let o=t.transformConstraints[this.constraintIndex];if(!o.active)return;let h,l,c,d,u,m,p=this.frames;if(s<p[0]){let t=o.data;switch(r){case x.setup:return o.mixRotate=t.mixRotate,o.mixX=t.mixX,o.mixY=t.mixY,o.mixScaleX=t.mixScaleX,o.mixScaleY=t.mixScaleY,void(o.mixShearY=t.mixShearY);case x.first:o.mixRotate+=(t.mixRotate-o.mixRotate)*n,o.mixX+=(t.mixX-o.mixX)*n,o.mixY+=(t.mixY-o.mixY)*n,o.mixScaleX+=(t.mixScaleX-o.mixScaleX)*n,o.mixScaleY+=(t.mixScaleY-o.mixScaleY)*n,o.mixShearY+=(t.mixShearY-o.mixShearY)*n}return}let g=y.search(p,s,7),f=this.curves[g/7];switch(f){case 0:let t=p[g];h=p[g+1],l=p[g+2],c=p[g+3],d=p[g+4],u=p[g+5],m=p[g+6];let e=(s-t)/(p[g+7]-t);h+=(p[g+7+1]-h)*e,l+=(p[g+7+2]-l)*e,c+=(p[g+7+3]-c)*e,d+=(p[g+7+4]-d)*e,u+=(p[g+7+5]-u)*e,m+=(p[g+7+6]-m)*e;break;case 1:h=p[g+1],l=p[g+2],c=p[g+3],d=p[g+4],u=p[g+5],m=p[g+6];break;default:h=this.getBezierValue(s,g,1,f-2),l=this.getBezierValue(s,g,2,f+18-2),c=this.getBezierValue(s,g,3,f+36-2),d=this.getBezierValue(s,g,4,f+54-2),u=this.getBezierValue(s,g,5,f+72-2),m=this.getBezierValue(s,g,6,f+90-2)}if(r==x.setup){let t=o.data;o.mixRotate=t.mixRotate+(h-t.mixRotate)*n,o.mixX=t.mixX+(l-t.mixX)*n,o.mixY=t.mixY+(c-t.mixY)*n,o.mixScaleX=t.mixScaleX+(d-t.mixScaleX)*n,o.mixScaleY=t.mixScaleY+(u-t.mixScaleY)*n,o.mixShearY=t.mixShearY+(m-t.mixShearY)*n}else o.mixRotate+=(h-o.mixRotate)*n,o.mixX+=(l-o.mixX)*n,o.mixY+=(c-o.mixY)*n,o.mixScaleX+=(d-o.mixScaleX)*n,o.mixScaleY+=(u-o.mixScaleY)*n,o.mixShearY+=(m-o.mixShearY)*n}}class H extends C{constructor(t,e,s){super(t,e,v.pathConstraintPosition+"|"+s),(0,a.A)(this,"constraintIndex",0),this.constraintIndex=s}apply(t,e,s,i,n,r,a){let o=t.pathConstraints[this.constraintIndex];o.active&&(o.position=this.getAbsoluteValue(s,n,r,o.position,o.data.position))}}class Z extends C{constructor(t,e,s){super(t,e,v.pathConstraintSpacing+"|"+s),(0,a.A)(this,"constraintIndex",0),this.constraintIndex=s}apply(t,e,s,i,n,r,a){let o=t.pathConstraints[this.constraintIndex];o.active&&(o.spacing=this.getAbsoluteValue(s,n,r,o.spacing,o.data.spacing))}}class J extends k{constructor(t,e,s){super(t,e,[v.pathConstraintMix+"|"+s]),(0,a.A)(this,"constraintIndex",0),this.constraintIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,i,n){let r=this.frames;r[t<<=2]=e,r[t+1]=s,r[t+2]=i,r[t+3]=n}apply(t,e,s,i,n,r,a){let o=t.pathConstraints[this.constraintIndex];if(!o.active)return;let h,l,c,d=this.frames;if(s<d[0]){switch(r){case x.setup:return o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,void(o.mixY=o.data.mixY);case x.first:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*n,o.mixX+=(o.data.mixX-o.mixX)*n,o.mixY+=(o.data.mixY-o.mixY)*n}return}let u=y.search(d,s,4),m=this.curves[u>>2];switch(m){case 0:let t=d[u];h=d[u+1],l=d[u+2],c=d[u+3];let e=(s-t)/(d[u+4]-t);h+=(d[u+4+1]-h)*e,l+=(d[u+4+2]-l)*e,c+=(d[u+4+3]-c)*e;break;case 1:h=d[u+1],l=d[u+2],c=d[u+3];break;default:h=this.getBezierValue(s,u,1,m-2),l=this.getBezierValue(s,u,2,m+18-2),c=this.getBezierValue(s,u,3,m+36-2)}if(r==x.setup){let t=o.data;o.mixRotate=t.mixRotate+(h-t.mixRotate)*n,o.mixX=t.mixX+(l-t.mixX)*n,o.mixY=t.mixY+(c-t.mixY)*n}else o.mixRotate+=(h-o.mixRotate)*n,o.mixX+=(l-o.mixX)*n,o.mixY+=(c-o.mixY)*n}}class K extends C{constructor(t,e,s,i){super(t,e,i+"|"+s),(0,a.A)(this,"constraintIndex",0),this.constraintIndex=s}apply(t,e,s,i,n,r,a){let o;if(-1==this.constraintIndex){const e=s>=this.frames[0]?this.getCurveValue(s):0;for(const i of t.physicsConstraints)i.active&&this.global(i.data)&&this.set(i,this.getAbsoluteValue2(s,n,r,this.get(i),this.setup(i),e))}else o=t.physicsConstraints[this.constraintIndex],o.active&&this.set(o,this.getAbsoluteValue(s,n,r,this.get(o),this.setup(o)))}}class Q extends K{constructor(t,e,s){super(t,e,s,v.physicsConstraintInertia)}setup(t){return t.data.inertia}get(t){return t.inertia}set(t,e){t.inertia=e}global(t){return t.inertiaGlobal}}class $ extends K{constructor(t,e,s){super(t,e,s,v.physicsConstraintStrength)}setup(t){return t.data.strength}get(t){return t.strength}set(t,e){t.strength=e}global(t){return t.strengthGlobal}}class tt extends K{constructor(t,e,s){super(t,e,s,v.physicsConstraintDamping)}setup(t){return t.data.damping}get(t){return t.damping}set(t,e){t.damping=e}global(t){return t.dampingGlobal}}class et extends K{constructor(t,e,s){super(t,e,s,v.physicsConstraintMass)}setup(t){return 1/t.data.massInverse}get(t){return 1/t.massInverse}set(t,e){t.massInverse=1/e}global(t){return t.massGlobal}}class st extends K{constructor(t,e,s){super(t,e,s,v.physicsConstraintWind)}setup(t){return t.data.wind}get(t){return t.wind}set(t,e){t.wind=e}global(t){return t.windGlobal}}class it extends K{constructor(t,e,s){super(t,e,s,v.physicsConstraintGravity)}setup(t){return t.data.gravity}get(t){return t.gravity}set(t,e){t.gravity=e}global(t){return t.gravityGlobal}}class nt extends K{constructor(t,e,s){super(t,e,s,v.physicsConstraintMix)}setup(t){return t.data.mix}get(t){return t.mix}set(t,e){t.mix=e}global(t){return t.mixGlobal}}class rt extends y{constructor(t,e){super(t,rt.propertyIds),(0,a.A)(this,"constraintIndex",void 0),this.constraintIndex=e}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e}apply(t,e,s,i,n,r,a){let o;if(-1!=this.constraintIndex&&(o=t.physicsConstraints[this.constraintIndex],!o.active))return;const h=this.frames;if(e>s)this.apply(t,e,Number.MAX_VALUE,[],n,r,a),e=-1;else if(e>=h[h.length-1])return;if(!(s<h[0])&&(e<h[0]||s>=h[y.search1(h,e)+1]))if(null!=o)o.reset();else for(const l of t.physicsConstraints)l.active&&l.reset()}}(0,a.A)(rt,"propertyIds",[v.physicsConstraintReset.toString()]);class at extends y{constructor(t,e,s){super(t,[v.sequence+"|"+e+"|"+s.sequence.id]),(0,a.A)(this,"slotIndex",void 0),(0,a.A)(this,"attachment",void 0),this.slotIndex=e,this.attachment=s}getFrameEntries(){return at.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,e,s,i,n){let r=this.frames;r[t*=at.ENTRIES]=e,r[t+at.MODE]=s|i<<4,r[t+at.DELAY]=n}apply(t,e,s,i,n,a,o){let h=t.slots[this.slotIndex];if(!h.bone.active)return;let l=h.attachment,c=this.attachment;if(l!=c&&(!(l instanceof g)||l.timelineAttachment!=c))return;if(o==b.mixOut)return void(a==x.setup&&(h.sequenceIndex=-1));let d=this.frames;if(s<d[0])return void(a!=x.setup&&a!=x.first||(h.sequenceIndex=-1));let u=y.search(d,s,at.ENTRIES),m=d[u],p=d[u+at.MODE],f=d[u+at.DELAY];if(!this.attachment.sequence)return;let A=p>>4,v=this.attachment.sequence.regions.length,k=w[15&p];if(k!=r.hold)switch(A+=(s-m)/f+1e-5|0,k){case r.once:A=Math.min(v-1,A);break;case r.loop:A%=v;break;case r.pingpong:{let t=(v<<1)-2;A=0==t?0:A%t,A>=v&&(A=t-A);break}case r.onceReverse:A=Math.max(v-1-A,0);break;case r.loopReverse:A=v-1-A%v;break;case r.pingpongReverse:{let t=(v<<1)-2;A=0==t?0:(A+v-1)%t,A>=v&&(A=t-A)}}h.sequenceIndex=A}}(0,a.A)(at,"ENTRIES",3),(0,a.A)(at,"MODE",1),(0,a.A)(at,"DELAY",2);class ot{static emptyAnimation(){return ot._emptyAnimation}constructor(t){(0,a.A)(this,"data",void 0),(0,a.A)(this,"tracks",new Array),(0,a.A)(this,"timeScale",1),(0,a.A)(this,"unkeyedState",0),(0,a.A)(this,"events",new Array),(0,a.A)(this,"listeners",new Array),(0,a.A)(this,"queue",new lt(this)),(0,a.A)(this,"propertyIDs",new o),(0,a.A)(this,"animationsChanged",!1),(0,a.A)(this,"trackEntryPool",new d(()=>new ht)),this.data=t}update(t){t*=this.timeScale;let e=this.tracks;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(!i)continue;i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast;let n=t*i.timeScale;if(i.delay>0){if(i.delay-=n,i.delay>0)continue;n=-i.delay,i.delay=0}let r=i.next;if(r){let e=i.trackLast-r.delay;if(e>=0){for(r.delay=0,r.trackTime+=0==i.timeScale?0:(e/i.timeScale+t)*r.timeScale,i.trackTime+=n,this.setCurrent(s,r,!0);r.mixingFrom;)r.mixTime+=t,r=r.mixingFrom;continue}}else if(i.trackLast>=i.trackEnd&&!i.mixingFrom){e[s]=null,this.queue.end(i),this.clearNext(i);continue}if(i.mixingFrom&&this.updateMixingFrom(i,t)){let t=i.mixingFrom;for(i.mixingFrom=null,t&&(t.mixingTo=null);t;)this.queue.end(t),t=t.mixingFrom}i.trackTime+=n}this.queue.drain()}updateMixingFrom(t,e){let s=t.mixingFrom;if(!s)return!0;let i=this.updateMixingFrom(s,e);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,-1!=t.nextTrackLast&&t.mixTime>=t.mixDuration?(0!=s.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=s.mixingFrom,null!=s.mixingFrom&&(s.mixingFrom.mixingTo=t),t.interruptAlpha=s.interruptAlpha,this.queue.end(s)),i):(s.trackTime+=e*s.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let e=this.events,s=this.tracks,i=!1;for(let u=0,m=s.length;u<m;u++){let r=s[u];if(!r||r.delay>0)continue;i=!0;let a=0==u?x.first:r.mixBlend,o=r.alpha;r.mixingFrom?o*=this.applyMixingFrom(r,t,a):r.trackTime>=r.trackEnd&&!r.next&&(o=0);let h=o>=r.alphaAttachmentThreshold,l=r.animationLast,d=r.getAnimationTime(),m=d,p=e;r.reverse&&(m=r.animation.duration-m,p=null);let g=r.animation.timelines,f=g.length;if(0==u&&1==o||a==x.add){0==u&&(h=!0);for(let e=0;e<f;e++){c.webkit602BugfixHelper(o,a);var n=g[e];n instanceof W?this.applyAttachmentTimeline(n,t,m,a,h):n.apply(t,l,m,p,o,a,b.mixIn)}}else{let e=r.timelineMode,s=r.shortestRotation,i=!s&&r.timelinesRotation.length!=f<<1;i&&(r.timelinesRotation.length=f<<1);for(let n=0;n<f;n++){let d=g[n],u=e[n]==dt?a:x.setup;!s&&d instanceof I?this.applyRotateTimeline(d,t,m,o,u,r.timelinesRotation,n<<1,i):d instanceof W?this.applyAttachmentTimeline(d,t,m,a,h):(c.webkit602BugfixHelper(o,a),d.apply(t,l,m,p,o,u,b.mixIn))}}this.queueEvents(r,d),e.length=0,r.nextAnimationLast=d,r.nextTrackLast=r.trackTime}for(var r=this.unkeyedState+ft,a=t.slots,o=0,h=t.slots.length;o<h;o++){var l=a[o];if(l.attachmentState==r){var d=l.data.attachmentName;l.setAttachment(d?t.getAttachment(l.data.index,d):null)}}return this.unkeyedState+=2,this.queue.drain(),i}applyMixingFrom(t,e,s){let i=t.mixingFrom;i.mixingFrom&&this.applyMixingFrom(i,e,s);let n=0;0==t.mixDuration?(n=1,s==x.first&&(s=x.setup)):(n=t.mixTime/t.mixDuration,n>1&&(n=1),s!=x.first&&(s=i.mixBlend));let r=n<i.mixAttachmentThreshold,a=n<i.mixDrawOrderThreshold,o=i.animation.timelines,h=o.length,l=i.alpha*t.interruptAlpha,d=l*(1-n),u=i.animationLast,m=i.getAnimationTime(),p=m,g=null;if(i.reverse?p=i.animation.duration-p:n<i.eventThreshold&&(g=this.events),s==x.add)for(let c=0;c<h;c++)o[c].apply(e,u,p,g,d,s,b.mixOut);else{let t=i.timelineMode,n=i.timelineHoldMix,m=i.shortestRotation,f=!m&&i.timelinesRotation.length!=h<<1;f&&(i.timelinesRotation.length=h<<1),i.totalAlpha=0;for(let w=0;w<h;w++){let h,A=o[w],v=b.mixOut,y=0;switch(t[w]){case dt:if(!a&&A instanceof G)continue;h=s,y=d;break;case ut:h=x.setup,y=d;break;case mt:h=s,y=l;break;case pt:h=x.setup,y=l;break;default:h=x.setup;let t=n[w];y=l*Math.max(0,1-t.mixTime/t.mixDuration)}i.totalAlpha+=y,!m&&A instanceof I?this.applyRotateTimeline(A,e,p,y,h,i.timelinesRotation,w<<1,f):A instanceof W?this.applyAttachmentTimeline(A,e,p,h,r&&y>=i.alphaAttachmentThreshold):(c.webkit602BugfixHelper(y,s),a&&A instanceof G&&h==x.setup&&(v=b.mixIn),A.apply(e,u,p,g,y,h,v))}}return t.mixDuration>0&&this.queueEvents(i,m),this.events.length=0,i.nextAnimationLast=m,i.nextTrackLast=i.trackTime,n}applyAttachmentTimeline(t,e,s,i,n){var r=e.slots[t.slotIndex];r.bone.active&&(s<t.frames[0]?i!=x.setup&&i!=x.first||this.setAttachment(e,r,r.data.attachmentName,n):this.setAttachment(e,r,t.attachmentNames[y.search1(t.frames,s)],n),r.attachmentState<=this.unkeyedState&&(r.attachmentState=this.unkeyedState+ft))}setAttachment(t,e,s,i){e.setAttachment(s?t.getAttachment(e.data.index,s):null),i&&(e.attachmentState=this.unkeyedState+wt)}applyRotateTimeline(t,e,s,i,n,r,a,o){if(o&&(r[a]=0),1==i)return void t.apply(e,0,s,null,1,n,b.mixIn);let h=e.bones[t.boneIndex];if(!h.active)return;let c=0,d=0;if(s<t.frames[0])switch(n){case x.setup:h.rotation=h.data.rotation;default:return;case x.first:c=h.rotation,d=h.data.rotation}else c=n==x.setup?h.data.rotation:h.rotation,d=h.data.rotation+t.getCurveValue(s);let u=0,m=d-c;if(m-=360*Math.ceil(m/360-.5),0==m)u=r[a];else{let t=0,e=0;o?(t=0,e=m):(t=r[a],e=r[a+1]);let s=t-t%360;u=m+s;let i=m>=0,n=t>=0;Math.abs(e)<=90&&l.signum(e)!=l.signum(m)&&(Math.abs(t-s)>180?(u+=360*l.signum(t),n=i):0!=s?u-=360*l.signum(t):n=i),n!=i&&(u+=360*l.signum(t)),r[a]=u}r[a+1]=m,h.rotation=c+u*i}queueEvents(t,e){let s=t.animationStart,i=t.animationEnd,n=i-s,r=t.trackLast%n,a=this.events,o=0,h=a.length;for(;o<h;o++){let e=a[o];if(e.time<r)break;e.time>i||this.queue.event(t,e)}let l=!1;if(t.loop)if(0==n)l=!0;else{const e=Math.floor(t.trackTime/n);l=e>0&&e>Math.floor(t.trackLast/n)}else l=e>=i&&t.animationLast<i;for(l&&this.queue.complete(t);o<h;o++){let e=a[o];e.time<s||this.queue.event(t,e)}}clearTracks(){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;let e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let s=e;for(;;){let t=s.mixingFrom;if(!t)break;this.queue.end(t),s.mixingFrom=null,s.mixingTo=null,s=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,s){let i=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,i&&(s&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.data.skeletonData.findAnimation(e);if(!i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,s)}setAnimationWith(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)throw new Error("animation cannot be null.");let i=!0,n=this.expandToIndex(t);n&&(-1==n.nextTrackLast?(this.tracks[t]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.clearNext(n),n=n.mixingFrom,i=!1):this.clearNext(n));let r=this.trackEntry(t,e,s,n);return this.setCurrent(t,r,i),this.queue.drain(),r}addAnimation(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=this.data.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,n,s,i)}addAnimationWith(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!e)throw new Error("animation cannot be null.");let n=this.expandToIndex(t);if(n)for(;n.next;)n=n.next;let r=this.trackEntry(t,e,s,n);return n?(n.next=r,r.previous=n,i<=0&&(i=Math.max(i+n.getTrackComplete()-r.mixDuration,0))):(this.setCurrent(t,r,!0),this.queue.drain(),i<0&&(i=0)),r.delay=i,r}setEmptyAnimation(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=this.setAnimationWith(t,ot.emptyAnimation(),!1);return s.mixDuration=e,s.trackEnd=e,s}addEmptyAnimation(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.addAnimationWith(t,ot.emptyAnimation(),!1,s);return s<=0&&(i.delay=Math.max(i.delay+i.mixDuration-e,0)),i.mixDuration=e,i.trackEnd=e,i}setEmptyAnimations(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let s=0,i=this.tracks.length;s<i;s++){let e=this.tracks[s];e&&this.setEmptyAnimation(e.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(c.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,s,i){let n=this.trackEntryPool.obtain();return n.reset(),n.trackIndex=t,n.animation=e,n.loop=s,n.holdPrevious=!1,n.reverse=!1,n.shortestRotation=!1,n.eventThreshold=0,n.alphaAttachmentThreshold=0,n.mixAttachmentThreshold=0,n.mixDrawOrderThreshold=0,n.animationStart=0,n.animationEnd=e.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.mixTime=0,n.mixDuration=i?this.data.getMix(i.animation,e):0,n.interruptAlpha=1,n.totalAlpha=0,n.mixBlend=x.replace,n}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let t=this.tracks;for(let e=0,s=t.length;e<s;e++){let s=t[e];if(s){for(;s.mixingFrom;)s=s.mixingFrom;do{s.mixingTo&&s.mixBlend==x.add||this.computeHold(s),s=s.mixingTo}while(s)}}}computeHold(t){let e=t.mixingTo,s=t.animation.timelines,i=t.animation.timelines.length,n=t.timelineMode;n.length=i;let r=t.timelineHoldMix;r.length=0;let a=this.propertyIDs;if(e&&e.holdPrevious)for(let o=0;o<i;o++)n[o]=a.addAll(s[o].getPropertyIds())?pt:mt;else t:for(let o=0;o<i;o++){let i=s[o],h=i.getPropertyIds();if(a.addAll(h))if(!e||i instanceof W||i instanceof G||i instanceof q||!e.animation.hasTimeline(h))n[o]=ut;else{for(let s=e.mixingTo;s;s=s.mixingTo)if(!s.animation.hasTimeline(h)){if(t.mixDuration>0){n[o]=gt,r[o]=s;continue t}break}n[o]=pt}else n[o]=dt}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}(0,a.A)(ot,"_emptyAnimation",new A("<empty>",[],0));class ht{constructor(){(0,a.A)(this,"animation",null),(0,a.A)(this,"previous",null),(0,a.A)(this,"next",null),(0,a.A)(this,"mixingFrom",null),(0,a.A)(this,"mixingTo",null),(0,a.A)(this,"listener",null),(0,a.A)(this,"trackIndex",0),(0,a.A)(this,"loop",!1),(0,a.A)(this,"holdPrevious",!1),(0,a.A)(this,"reverse",!1),(0,a.A)(this,"shortestRotation",!1),(0,a.A)(this,"eventThreshold",0),(0,a.A)(this,"mixAttachmentThreshold",0),(0,a.A)(this,"alphaAttachmentThreshold",0),(0,a.A)(this,"mixDrawOrderThreshold",0),(0,a.A)(this,"animationStart",0),(0,a.A)(this,"animationEnd",0),(0,a.A)(this,"animationLast",0),(0,a.A)(this,"nextAnimationLast",0),(0,a.A)(this,"delay",0),(0,a.A)(this,"trackTime",0),(0,a.A)(this,"trackLast",0),(0,a.A)(this,"nextTrackLast",0),(0,a.A)(this,"trackEnd",0),(0,a.A)(this,"timeScale",0),(0,a.A)(this,"alpha",0),(0,a.A)(this,"mixTime",0),(0,a.A)(this,"_mixDuration",0),(0,a.A)(this,"interruptAlpha",0),(0,a.A)(this,"totalAlpha",0),(0,a.A)(this,"mixBlend",x.replace),(0,a.A)(this,"timelineMode",new Array),(0,a.A)(this,"timelineHoldMix",new Array),(0,a.A)(this,"timelinesRotation",new Array)}get mixDuration(){return this._mixDuration}set mixDuration(t){this._mixDuration=t}setMixDurationWithDelay(t,e){this._mixDuration=t,e<=0&&(e=null!=this.previous?Math.max(e+this.previous.getTrackComplete()-t,0):0),this.delay=e}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}wasApplied(){return-1!=this.nextTrackLast}isNextReady(){return null!=this.next&&this.nextTrackLast-this.next.delay>=0}}class lt{constructor(t){(0,a.A)(this,"objects",[]),(0,a.A)(this,"drainDisabled",!1),(0,a.A)(this,"animState",void 0),this.animState=t}start(t){this.objects.push(ct.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(ct.interrupt),this.objects.push(t)}end(t){this.objects.push(ct.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(ct.dispose),this.objects.push(t)}complete(t){this.objects.push(ct.complete),this.objects.push(t)}event(t,e){this.objects.push(ct.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,e=this.animState.listeners;for(let s=0;s<t.length;s+=2){let i=t[s],n=t[s+1];switch(i){case ct.start:n.listener&&n.listener.start&&n.listener.start(n);for(let t=0;t<e.length;t++){let s=e[t];s.start&&s.start(n)}break;case ct.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let t=0;t<e.length;t++){let s=e[t];s.interrupt&&s.interrupt(n)}break;case ct.end:n.listener&&n.listener.end&&n.listener.end(n);for(let t=0;t<e.length;t++){let s=e[t];s.end&&s.end(n)}case ct.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let t=0;t<e.length;t++){let s=e[t];s.dispose&&s.dispose(n)}this.animState.trackEntryPool.free(n);break;case ct.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(let t=0;t<e.length;t++){let s=e[t];s.complete&&s.complete(n)}break;case ct.event:let i=t[2+s++];n.listener&&n.listener.event&&n.listener.event(n,i);for(let t=0;t<e.length;t++){let s=e[t];s.event&&s.event(n,i)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var ct;!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(ct||(ct={}));const dt=0,ut=1,mt=2,pt=3,gt=4,ft=1,wt=2;class At{constructor(t){if((0,a.A)(this,"skeletonData",void 0),(0,a.A)(this,"animationToMixTime",{}),(0,a.A)(this,"defaultMix",0),!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){let i=this.skeletonData.findAnimation(t);if(!i)throw new Error("Animation not found: "+t);let n=this.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);this.setMixWith(i,n,s)}setMixWith(t,e,s){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");let i=t.name+"."+e.name;this.animationToMixTime[i]=s}getMix(t,e){let s=t.name+"."+e.name,i=this.animationToMixTime[s];return void 0===i?this.defaultMix:i}}class xt extends g{constructor(t){super(t),(0,a.A)(this,"color",new h(1,1,1,1))}copy(){let t=new xt(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class bt extends g{constructor(t){super(t),(0,a.A)(this,"endSlot",null),(0,a.A)(this,"color",new h(.2275,.2275,.8078,1))}copy(){let t=new bt(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class vt{constructor(t){(0,a.A)(this,"_image",void 0),this._image=t}getImage(){return this._image}}var yt,kt,Ct,St,It,Et,Tt,Mt,Rt;!function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(yt||(yt={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(kt||(kt={}));class Ft{constructor(){(0,a.A)(this,"texture",void 0),(0,a.A)(this,"u",0),(0,a.A)(this,"v",0),(0,a.A)(this,"u2",0),(0,a.A)(this,"v2",0),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"degrees",0),(0,a.A)(this,"offsetX",0),(0,a.A)(this,"offsetY",0),(0,a.A)(this,"originalWidth",0),(0,a.A)(this,"originalHeight",0)}}class Yt{constructor(t){(0,a.A)(this,"pages",new Array),(0,a.A)(this,"regions",new Array);let e=new Lt(t),s=new Array(4),i={size:t=>{t.width=parseInt(s[1]),t.height=parseInt(s[2])},format:()=>{},filter:t=>{t.minFilter=c.enumValue(yt,s[1]),t.magFilter=c.enumValue(yt,s[2])},repeat:t=>{-1!=s[1].indexOf("x")&&(t.uWrap=kt.Repeat),-1!=s[1].indexOf("y")&&(t.vWrap=kt.Repeat)},pma:t=>{t.pma="true"==s[1]}};var n={xy:t=>{t.x=parseInt(s[1]),t.y=parseInt(s[2])},size:t=>{t.width=parseInt(s[1]),t.height=parseInt(s[2])},bounds:t=>{t.x=parseInt(s[1]),t.y=parseInt(s[2]),t.width=parseInt(s[3]),t.height=parseInt(s[4])},offset:t=>{t.offsetX=parseInt(s[1]),t.offsetY=parseInt(s[2])},orig:t=>{t.originalWidth=parseInt(s[1]),t.originalHeight=parseInt(s[2])},offsets:t=>{t.offsetX=parseInt(s[1]),t.offsetY=parseInt(s[2]),t.originalWidth=parseInt(s[3]),t.originalHeight=parseInt(s[4])},rotate:t=>{let e=s[1];"true"==e?t.degrees=90:"false"!=e&&(t.degrees=parseInt(e))},index:t=>{t.index=parseInt(s[1])}};let r=e.readLine();for(;r&&0==r.trim().length;)r=e.readLine();for(;r&&0!=r.trim().length&&0!=e.readEntry(s,r);)r=e.readLine();let o=null,h=null,l=null;for(;null!==r;)if(0==r.trim().length)o=null,r=e.readLine();else if(o){let t=new Xt(o,r);for(;;){let i=e.readEntry(s,r=e.readLine());if(0==i)break;let a=n[s[0]];if(a)a(t);else{h||(h=[]),l||(l=[]),h.push(s[0]);let t=[];for(let e=0;e<i;e++)t.push(parseInt(s[e+1]));l.push(t)}}0==t.originalWidth&&0==t.originalHeight&&(t.originalWidth=t.width,t.originalHeight=t.height),h&&h.length>0&&l&&l.length>0&&(t.names=h,t.values=l,h=null,l=null),t.u=t.x/o.width,t.v=t.y/o.height,90==t.degrees?(t.u2=(t.x+t.height)/o.width,t.v2=(t.y+t.width)/o.height):(t.u2=(t.x+t.width)/o.width,t.v2=(t.y+t.height)/o.height),this.regions.push(t)}else{for(o=new Bt(r.trim());0!=e.readEntry(s,r=e.readLine());){let t=i[s[0]];t&&t(o)}this.pages.push(o)}}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}setTextures(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";for(let s of this.pages)s.setTexture(t.get(e+s.name))}dispose(){for(let e=0;e<this.pages.length;e++){var t;null===(t=this.pages[e].texture)||void 0===t||t.dispose()}}}class Lt{constructor(t){(0,a.A)(this,"lines",void 0),(0,a.A)(this,"index",0),this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(!e)return 0;if(0==(e=e.trim()).length)return 0;let s=e.indexOf(":");if(-1==s)return 0;t[0]=e.substr(0,s).trim();for(let i=1,n=s+1;;i++){let s=e.indexOf(",",n);if(-1==s)return t[i]=e.substr(n).trim(),i;if(t[i]=e.substr(n,s-n).trim(),n=s+1,4==i)return 4}}}class Bt{constructor(t){(0,a.A)(this,"name",void 0),(0,a.A)(this,"minFilter",yt.Nearest),(0,a.A)(this,"magFilter",yt.Nearest),(0,a.A)(this,"uWrap",kt.ClampToEdge),(0,a.A)(this,"vWrap",kt.ClampToEdge),(0,a.A)(this,"texture",null),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"pma",!1),(0,a.A)(this,"regions",new Array),this.name=t}setTexture(t){this.texture=t,t.setFilters(this.minFilter,this.magFilter),t.setWraps(this.uWrap,this.vWrap);for(let e of this.regions)e.texture=t}}class Xt extends Ft{constructor(t,e){super(),(0,a.A)(this,"page",void 0),(0,a.A)(this,"name",void 0),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"offsetX",0),(0,a.A)(this,"offsetY",0),(0,a.A)(this,"originalWidth",0),(0,a.A)(this,"originalHeight",0),(0,a.A)(this,"index",0),(0,a.A)(this,"degrees",0),(0,a.A)(this,"names",null),(0,a.A)(this,"values",null),this.page=t,this.name=e,t.regions.push(this)}}class Pt extends g{constructor(t,e){super(t),(0,a.A)(this,"region",null),(0,a.A)(this,"path",void 0),(0,a.A)(this,"regionUVs",[]),(0,a.A)(this,"uvs",[]),(0,a.A)(this,"triangles",[]),(0,a.A)(this,"color",new h(1,1,1,1)),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"hullLength",0),(0,a.A)(this,"edges",[]),(0,a.A)(this,"parentMesh",null),(0,a.A)(this,"sequence",null),(0,a.A)(this,"tempColor",new h(0,0,0,0)),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.regionUVs;this.uvs&&this.uvs.length==t.length||(this.uvs=c.newFloatArray(t.length));let e=this.uvs,s=this.uvs.length,i=this.region.u,n=this.region.v,r=0,a=0;if(this.region instanceof Xt){let o=this.region,h=o.page,l=h.width,c=h.height;switch(o.degrees){case 90:i-=(o.originalHeight-o.offsetY-o.height)/l,n-=(o.originalWidth-o.offsetX-o.width)/c,r=o.originalHeight/l,a=o.originalWidth/c;for(let o=0;o<s;o+=2)e[o]=i+t[o+1]*r,e[o+1]=n+(1-t[o])*a;return;case 180:i-=(o.originalWidth-o.offsetX-o.width)/l,n-=o.offsetY/c,r=o.originalWidth/l,a=o.originalHeight/c;for(let o=0;o<s;o+=2)e[o]=i+(1-t[o])*r,e[o+1]=n+(1-t[o+1])*a;return;case 270:i-=o.offsetY/l,n-=o.offsetX/c,r=o.originalHeight/l,a=o.originalWidth/c;for(let o=0;o<s;o+=2)e[o]=i+(1-t[o+1])*r,e[o+1]=n+t[o]*a;return}i-=o.offsetX/l,n-=(o.originalHeight-o.offsetY-o.height)/c,r=o.originalWidth/l,a=o.originalHeight/c}else this.region?(r=this.region.u2-i,a=this.region.v2-n):(i=n=0,r=a=1);for(let o=0;o<s;o+=2)e[o]=i+t[o]*r,e[o+1]=n+t[o+1]*a}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let t=new Pt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),c.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=this.uvs instanceof Float32Array?c.newFloatArray(this.uvs.length):new Array(this.uvs.length),c.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),c.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),c.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,s,i,n,r){null!=this.sequence&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,s,i,n,r)}newLinkedMesh(){let t=new Pt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),null!=t.region&&t.updateRegion(),t}}class Vt extends g{constructor(t){super(t),(0,a.A)(this,"lengths",[]),(0,a.A)(this,"closed",!1),(0,a.A)(this,"constantSpeed",!1),(0,a.A)(this,"color",new h(1,1,1,1))}copy(){let t=new Vt(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),c.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class Dt extends g{constructor(t){super(t),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"rotation",0),(0,a.A)(this,"color",new h(.38,.94,0,1))}computeWorldPosition(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e}computeWorldRotation(t){const e=this.rotation*l.degRad,s=Math.cos(e),i=Math.sin(e),n=s*t.a+i*t.b,r=s*t.c+i*t.d;return l.atan2Deg(r,n)}copy(){let t=new Dt(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}class Ot extends p{constructor(t,e){super(t),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"scaleX",1),(0,a.A)(this,"scaleY",1),(0,a.A)(this,"rotation",0),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"color",new h(1,1,1,1)),(0,a.A)(this,"path",void 0),(0,a.A)(this,"region",null),(0,a.A)(this,"sequence",null),(0,a.A)(this,"offset",c.newFloatArray(8)),(0,a.A)(this,"uvs",c.newFloatArray(8)),(0,a.A)(this,"tempColor",new h(1,1,1,1)),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.region,e=this.uvs;if(null==t)return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=1,e[5]=1,e[6]=1,void(e[7]=0);let s=this.width/this.region.originalWidth*this.scaleX,i=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*s,r=-this.height/2*this.scaleY+this.region.offsetY*i,a=n+this.region.width*s,o=r+this.region.height*i,h=this.rotation*l.degRad,c=Math.cos(h),d=Math.sin(h),u=this.x,m=this.y,p=n*c+u,g=n*d,f=r*c+m,w=r*d,A=a*c+u,x=a*d,b=o*c+m,v=o*d,y=this.offset;y[0]=p-w,y[1]=f+g,y[2]=p-v,y[3]=b+g,y[4]=A-v,y[5]=b+x,y[6]=A-w,y[7]=f+x,90==t.degrees?(e[0]=t.u2,e[1]=t.v2,e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,s,i){null!=this.sequence&&this.sequence.apply(t,this);let n=t.bone,r=this.offset,a=n.worldX,o=n.worldY,h=n.a,l=n.b,c=n.c,d=n.d,u=0,m=0;u=r[0],m=r[1],e[s]=u*h+m*l+a,e[s+1]=u*c+m*d+o,s+=i,u=r[2],m=r[3],e[s]=u*h+m*l+a,e[s+1]=u*c+m*d+o,s+=i,u=r[4],m=r[5],e[s]=u*h+m*l+a,e[s+1]=u*c+m*d+o,s+=i,u=r[6],m=r[7],e[s]=u*h+m*l+a,e[s+1]=u*c+m*d+o}copy(){let t=new Ot(this.name,this.path);return t.region=this.region,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,c.arrayCopy(this.uvs,0,t.uvs,0,8),c.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=null!=this.sequence?this.sequence.copy():null,t}}(0,a.A)(Ot,"X1",0),(0,a.A)(Ot,"Y1",1),(0,a.A)(Ot,"C1R",2),(0,a.A)(Ot,"C1G",3),(0,a.A)(Ot,"C1B",4),(0,a.A)(Ot,"C1A",5),(0,a.A)(Ot,"U1",6),(0,a.A)(Ot,"V1",7),(0,a.A)(Ot,"X2",8),(0,a.A)(Ot,"Y2",9),(0,a.A)(Ot,"C2R",10),(0,a.A)(Ot,"C2G",11),(0,a.A)(Ot,"C2B",12),(0,a.A)(Ot,"C2A",13),(0,a.A)(Ot,"U2",14),(0,a.A)(Ot,"V2",15),(0,a.A)(Ot,"X3",16),(0,a.A)(Ot,"Y3",17),(0,a.A)(Ot,"C3R",18),(0,a.A)(Ot,"C3G",19),(0,a.A)(Ot,"C3B",20),(0,a.A)(Ot,"C3A",21),(0,a.A)(Ot,"U3",22),(0,a.A)(Ot,"V3",23),(0,a.A)(Ot,"X4",24),(0,a.A)(Ot,"Y4",25),(0,a.A)(Ot,"C4R",26),(0,a.A)(Ot,"C4G",27),(0,a.A)(Ot,"C4B",28),(0,a.A)(Ot,"C4A",29),(0,a.A)(Ot,"U4",30),(0,a.A)(Ot,"V4",31);class Nt{constructor(t){(0,a.A)(this,"atlas",void 0),this.atlas=t}loadSequence(t,e,s){let i=s.regions;for(let n=0,r=i.length;n<r;n++){let r=s.getPath(e,n),a=this.atlas.findRegion(r);if(null==a)throw new Error("Region not found in atlas: "+r+" (sequence: "+t+")");i[n]=a}}newRegionAttachment(t,e,s,i){let n=new Ot(e,s);if(null!=i)this.loadSequence(e,s,i);else{let t=this.atlas.findRegion(s);if(!t)throw new Error("Region not found in atlas: "+s+" (region attachment: "+e+")");n.region=t}return n}newMeshAttachment(t,e,s,i){let n=new Pt(e,s);if(null!=i)this.loadSequence(e,s,i);else{let t=this.atlas.findRegion(s);if(!t)throw new Error("Region not found in atlas: "+s+" (mesh attachment: "+e+")");n.region=t}return n}newBoundingBoxAttachment(t,e){return new xt(e)}newPathAttachment(t,e){return new Vt(e)}newPointAttachment(t,e){return new Dt(e)}newClippingAttachment(t,e){return new bt(e)}}class Ut{constructor(t,e,s){if((0,a.A)(this,"index",0),(0,a.A)(this,"name",void 0),(0,a.A)(this,"parent",null),(0,a.A)(this,"length",0),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"rotation",0),(0,a.A)(this,"scaleX",1),(0,a.A)(this,"scaleY",1),(0,a.A)(this,"shearX",0),(0,a.A)(this,"shearY",0),(0,a.A)(this,"inherit",Ct.Normal),(0,a.A)(this,"skinRequired",!1),(0,a.A)(this,"color",new h),(0,a.A)(this,"icon",void 0),(0,a.A)(this,"visible",!1),t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}}!function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"}(Ct||(Ct={}));class Wt{constructor(t,e,s){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"skeleton",void 0),(0,a.A)(this,"parent",null),(0,a.A)(this,"children",new Array),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"rotation",0),(0,a.A)(this,"scaleX",0),(0,a.A)(this,"scaleY",0),(0,a.A)(this,"shearX",0),(0,a.A)(this,"shearY",0),(0,a.A)(this,"ax",0),(0,a.A)(this,"ay",0),(0,a.A)(this,"arotation",0),(0,a.A)(this,"ascaleX",0),(0,a.A)(this,"ascaleY",0),(0,a.A)(this,"ashearX",0),(0,a.A)(this,"ashearY",0),(0,a.A)(this,"a",0),(0,a.A)(this,"b",0),(0,a.A)(this,"c",0),(0,a.A)(this,"d",0),(0,a.A)(this,"worldY",0),(0,a.A)(this,"worldX",0),(0,a.A)(this,"inherit",Ct.Normal),(0,a.A)(this,"sorted",!1),(0,a.A)(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}isActive(){return this.active}update(t){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,i,n,r,a){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=i,this.ascaleY=n,this.ashearX=r,this.ashearY=a;let o=this.parent;if(!o){let o=this.skeleton;const h=o.scaleX,c=o.scaleY,d=(s+r)*l.degRad,u=(s+90+a)*l.degRad;return this.a=Math.cos(d)*i*h,this.b=Math.cos(u)*n*h,this.c=Math.sin(d)*i*c,this.d=Math.sin(u)*n*c,this.worldX=t*h+o.x,void(this.worldY=e*c+o.y)}let h=o.a,c=o.b,d=o.c,u=o.d;switch(this.worldX=h*t+c*e+o.worldX,this.worldY=d*t+u*e+o.worldY,this.inherit){case Ct.Normal:{const t=(s+r)*l.degRad,e=(s+90+a)*l.degRad,o=Math.cos(t)*i,m=Math.cos(e)*n,p=Math.sin(t)*i,g=Math.sin(e)*n;return this.a=h*o+c*p,this.b=h*m+c*g,this.c=d*o+u*p,void(this.d=d*m+u*g)}case Ct.OnlyTranslation:{const t=(s+r)*l.degRad,e=(s+90+a)*l.degRad;this.a=Math.cos(t)*i,this.b=Math.cos(e)*n,this.c=Math.sin(t)*i,this.d=Math.sin(e)*n;break}case Ct.NoRotationOrReflection:{let t=1/this.skeleton.scaleX,e=1/this.skeleton.scaleY;h*=t,d*=e;let o=h*h+d*d,m=0;o>1e-4?(o=Math.abs(h*u*e-c*t*d)/o,c=d*o,u=h*o,m=Math.atan2(d,h)*l.radDeg):(h=0,d=0,m=90-Math.atan2(u,c)*l.radDeg);const p=(s+r-m)*l.degRad,g=(s+a-m+90)*l.degRad,f=Math.cos(p)*i,w=Math.cos(g)*n,A=Math.sin(p)*i,x=Math.sin(g)*n;this.a=h*f-c*A,this.b=h*w-c*x,this.c=d*f+u*A,this.d=d*w+u*x;break}case Ct.NoScale:case Ct.NoScaleOrReflection:{s*=l.degRad;const t=Math.cos(s),e=Math.sin(s);let o=(h*t+c*e)/this.skeleton.scaleX,m=(d*t+u*e)/this.skeleton.scaleY,p=Math.sqrt(o*o+m*m);p>1e-5&&(p=1/p),o*=p,m*=p,p=Math.sqrt(o*o+m*m),this.inherit==Ct.NoScale&&h*u-c*d<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(p=-p),s=Math.PI/2+Math.atan2(m,o);const g=Math.cos(s)*p,f=Math.sin(s)*p;r*=l.degRad,a=(90+a)*l.degRad;const w=Math.cos(r)*i,A=Math.cos(a)*n,x=Math.sin(r)*i,b=Math.sin(a)*n;this.a=o*w+g*x,this.b=o*A+g*b,this.c=m*w+f*x,this.d=m*A+f*b;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY,this.inherit=t.inherit}updateAppliedTransform(){let t=this.parent;if(!t)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*l.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*l.radDeg);let e,s,i,n,r=t.a,a=t.b,o=t.c,h=t.d,c=1/(r*h-a*o),d=h*c,u=a*c,m=o*c,p=r*c,g=this.worldX-t.worldX,f=this.worldY-t.worldY;if(this.ax=g*d-f*u,this.ay=f*p-g*m,this.inherit==Ct.OnlyTranslation)e=this.a,s=this.b,i=this.c,n=this.d;else{switch(this.inherit){case Ct.NoRotationOrReflection:{let t=Math.abs(r*h-a*o)/(r*r+o*o);a=-o*this.skeleton.scaleX*t/this.skeleton.scaleY,h=r*this.skeleton.scaleY*t/this.skeleton.scaleX,c=1/(r*h-a*o),d=h*c,u=a*c;break}case Ct.NoScale:case Ct.NoScaleOrReflection:let t=l.cosDeg(this.rotation),e=l.sinDeg(this.rotation);r=(r*t+a*e)/this.skeleton.scaleX,o=(o*t+h*e)/this.skeleton.scaleY;let s=Math.sqrt(r*r+o*o);s>1e-5&&(s=1/s),r*=s,o*=s,s=Math.sqrt(r*r+o*o),this.inherit==Ct.NoScale&&c<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(s=-s);let i=l.PI/2+Math.atan2(o,r);a=Math.cos(i)*s,h=Math.sin(i)*s,c=1/(r*h-a*o),d=h*c,u=a*c,m=o*c,p=r*c}e=d*this.a-u*this.c,s=d*this.b-u*this.d,i=p*this.c-m*this.a,n=p*this.d-m*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(e*e+i*i),this.ascaleX>1e-4){let t=e*n-s*i;this.ascaleY=t/this.ascaleX,this.ashearY=-Math.atan2(e*s+i*n,t)*l.radDeg,this.arotation=Math.atan2(i,e)*l.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(s*s+n*n),this.ashearY=0,this.arotation=90-Math.atan2(n,s)*l.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*l.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*l.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(t){let e=1/(this.a*this.d-this.b*this.c),s=t.x-this.worldX,i=t.y-this.worldY;return t.x=s*this.d*e-i*this.b*e,t.y=i*this.a*e-s*this.c*e,t}localToWorld(t){let e=t.x,s=t.y;return t.x=e*this.a+s*this.b+this.worldX,t.y=e*this.c+s*this.d+this.worldY,t}worldToParent(t){if(null==t)throw new Error("world cannot be null.");return null==this.parent?t:this.parent.worldToLocal(t)}parentToWorld(t){if(null==t)throw new Error("world cannot be null.");return null==this.parent?t:this.parent.localToWorld(t)}worldToLocalRotation(t){let e=l.sinDeg(t),s=l.cosDeg(t);return Math.atan2(this.a*e-this.c*s,this.d*s-this.b*e)*l.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=l.sinDeg(t),s=l.cosDeg(t);return Math.atan2(s*this.c+e*this.d,s*this.a+e*this.b)*l.radDeg}rotateWorld(t){t*=l.degRad;const e=Math.sin(t),s=Math.cos(t),i=this.a,n=this.b;this.a=s*i-e*this.c,this.b=s*n-e*this.d,this.c=e*i+s*this.c,this.d=e*n+s*this.d}}class zt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Gt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new qt;(0,a.A)(this,"pathPrefix",""),(0,a.A)(this,"textureLoader",void 0),(0,a.A)(this,"downloader",void 0),(0,a.A)(this,"cache",void 0),(0,a.A)(this,"errors",{}),(0,a.A)(this,"toLoad",0),(0,a.A)(this,"loaded",0),this.textureLoader=t,this.pathPrefix=e,this.downloader=s,this.cache=i}start(t){return this.toLoad++,this.pathPrefix+t}success(t,e,s){this.toLoad--,this.loaded++,this.cache.assets[e]=s,this.cache.assetsRefCount[e]=(this.cache.assetsRefCount[e]||0)+1,t&&t(e,s)}error(t,e,s){this.toLoad--,this.loaded++,this.errors[e]=s,t&&t(e,s)}loadAll(){return new Promise((t,e)=>{let s=()=>{this.isLoadingComplete()?this.hasErrors()?e(this.errors):t(this):requestAnimationFrame(s)};requestAnimationFrame(s)})}setRawDataURI(t,e){this.downloader.rawDataUris[this.pathPrefix+t]=e}loadBinary(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};t=this.start(t),this.reuseAssets(t,e,s)||(this.cache.assetsLoaded[t]=new Promise((i,n)=>{this.downloader.downloadBinary(t,s=>{this.success(e,t,s),i(s)},(e,i)=>{const r="Couldn't load binary ".concat(t,": status ").concat(e,", ").concat(i);this.error(s,t,r),n(r)})}))}loadText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};t=this.start(t),this.downloader.downloadText(t,s=>{this.success(e,t,s)},(e,i)=>{this.error(s,t,"Couldn't load text ".concat(t,": status ").concat(e,", ").concat(i))})}loadJson(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};t=this.start(t),this.reuseAssets(t,e,s)||(this.cache.assetsLoaded[t]=new Promise((i,n)=>{this.downloader.downloadJson(t,s=>{this.success(e,t,s),i(s)},(e,i)=>{const r="Couldn't load JSON ".concat(t,": status ").concat(e,", ").concat(i);this.error(s,t,r),n(r)})}))}reuseAssets(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const i=this.cache.assetsLoaded[t],n=void 0!==i;return n&&(this.cache.assetsLoaded[t]=i.then(s=>(s=s instanceof Image||s instanceof ImageBitmap?this.textureLoader(s):s,this.success(e,t,s),s)).catch(e=>this.error(s,t,e))),n}loadTexture(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};t=this.start(t),this.reuseAssets(t,e,s)||(this.cache.assetsLoaded[t]=new Promise((i,n)=>{if(!!("undefined"===typeof window||"undefined"===typeof navigator||!window.document))fetch(t,{mode:"cors"}).then(e=>{if(e.ok)return e.blob();const i="Couldn't load image: ".concat(t);this.error(s,t,"Couldn't load image: ".concat(t)),n(i)}).then(t=>t?createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"}):null).then(s=>{if(s){const n=this.createTexture(t,s);this.success(e,t,n),i(n)}});else{let r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const s=this.createTexture(t,r);this.success(e,t,s),i(s)},r.onerror=()=>{const e="Couldn't load image: ".concat(t);this.error(s,t,e),n(e)},this.downloader.rawDataUris[t]&&(t=this.downloader.rawDataUris[t]),r.src=t}}))}loadTextureAtlas(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},i=arguments.length>3?arguments[3]:void 0,n=t.lastIndexOf("/"),r=n>=0?t.substring(0,n+1):"";t=this.start(t),this.reuseAssets(t,e,s)||(this.cache.assetsLoaded[t]=new Promise((n,a)=>{this.downloader.downloadText(t,o=>{try{const h=this.createTextureAtlas(t,o);let l=h.pages.length,c=!1;for(let o of h.pages)this.loadTexture(i?i[o.name]:r+o.name,(s,i)=>{c||(o.setTexture(i),0==--l&&(this.success(e,t,h),n(h)))},(e,i)=>{if(!c){const i="Couldn't load texture ".concat(t," page image: ").concat(e);this.error(s,t,i),a(i)}c=!0})}catch(h){const e="Couldn't parse texture atlas ".concat(t,": ").concat(h.message);this.error(s,t,e),a(e)}},(e,i)=>{const n="Couldn't load texture atlas ".concat(t,": status ").concat(e,", ").concat(i);this.error(s,t,n),a(n)})}))}loadTextureAtlasButNoTextures(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};t=this.start(t),this.reuseAssets(t,e,s)||(this.cache.assetsLoaded[t]=new Promise((i,n)=>{this.downloader.downloadText(t,r=>{try{const s=this.createTextureAtlas(t,r);this.success(e,t,s),i(s)}catch(a){const e="Couldn't parse texture atlas ".concat(t,": ").concat(a.message);this.error(s,t,e),n(e)}},(e,i)=>{const r="Couldn't load texture atlas ".concat(t,": status ").concat(e,", ").concat(i);this.error(s,t,r),n(r)})}))}async loadBinaryAsync(t){return new Promise((e,s)=>{this.loadBinary(t,(t,s)=>e(s),(t,e)=>s(e))})}async loadJsonAsync(t){return new Promise((e,s)=>{this.loadJson(t,(t,s)=>e(s),(t,e)=>s(e))})}async loadTextureAsync(t){return new Promise((e,s)=>{this.loadTexture(t,(t,s)=>e(s),(t,e)=>s(e))})}async loadTextureAtlasAsync(t){return new Promise((e,s)=>{this.loadTextureAtlas(t,(t,s)=>e(s),(t,e)=>s(e))})}async loadTextureAtlasButNoTexturesAsync(t){return new Promise((e,s)=>{this.loadTextureAtlasButNoTextures(t,(t,s)=>e(s),(t,e)=>s(e))})}setCache(t){this.cache=t}get(t){return this.cache.assets[this.pathPrefix+t]}require(t){t=this.pathPrefix+t;let e=this.cache.assets[t];if(e)return e;let s=this.errors[t];throw Error("Asset not found: "+t+(s?"\n"+s:""))}remove(t){t=this.pathPrefix+t;let e=this.cache.assets[t];return e.dispose&&e.dispose(),delete this.cache.assets[t],delete this.cache.assetsRefCount[t],delete this.cache.assetsLoaded[t],e}removeAll(){for(let t in this.cache.assets){let e=this.cache.assets[t];e.dispose&&e.dispose()}this.cache.assets={},this.cache.assetsLoaded={},this.cache.assetsRefCount={}}isLoadingComplete(){return 0==this.toLoad}getToLoad(){return this.toLoad}getLoaded(){return this.loaded}dispose(){this.removeAll()}disposeAsset(t){const e=this.cache.assets[t];e instanceof Yt?e.dispose():this.disposeAssetInternal(t)}hasErrors(){return Object.keys(this.errors).length>0}getErrors(){return this.errors}disposeAssetInternal(t){if(this.cache.assetsRefCount[t]>0&&0===--this.cache.assetsRefCount[t])return this.remove(t)}createTextureAtlas(t,e){const s=new Yt(e);return s.dispose=()=>{if(!(this.cache.assetsRefCount[t]<=0)){this.disposeAssetInternal(t);for(const t of s.pages){var e;null===(e=t.texture)||void 0===e||e.dispose()}}},s}createTexture(t,e){const s=this.textureLoader(e),i=s.dispose.bind(s);return s.dispose=()=>{this.disposeAssetInternal(t)&&i()},s}}class qt{constructor(){(0,a.A)(this,"assets",{}),(0,a.A)(this,"assetsRefCount",{}),(0,a.A)(this,"assetsLoaded",{})}static getCache(t){const e=qt.AVAILABLE_CACHES.get(t);if(e)return e;const s=new qt;return qt.AVAILABLE_CACHES.set(t,s),s}async addAsset(t,e){this.assetsLoaded[t]=Promise.resolve(e),this.assets[t]=await e}}(0,a.A)(qt,"AVAILABLE_CACHES",new Map);class Gt{constructor(){(0,a.A)(this,"callbacks",{}),(0,a.A)(this,"rawDataUris",{})}dataUriToString(t){if(!t.startsWith("data:"))throw new Error("Not a data URI.");let e=t.indexOf("base64,");return-1!=e?(e+=7,atob(t.substr(e))):t.substr(t.indexOf(",")+1)}base64ToUint8Array(t){for(var e=window.atob(t),s=e.length,i=new Uint8Array(s),n=0;n<s;n++)i[n]=e.charCodeAt(n);return i}dataUriToUint8Array(t){if(!t.startsWith("data:"))throw new Error("Not a data URI.");let e=t.indexOf("base64,");if(-1==e)throw new Error("Not a binary data URI.");return e+=7,this.base64ToUint8Array(t.substr(e))}downloadText(t,e,s){if(this.start(t,e,s))return;const i=this.rawDataUris[t];if(i&&!i.includes(".")){try{this.finish(t,200,this.dataUriToString(i))}catch(a){this.finish(t,400,JSON.stringify(a))}return}let n=new XMLHttpRequest;n.overrideMimeType("text/html"),n.open("GET",i||t,!0);let r=()=>{this.finish(t,n.status,n.responseText)};n.onload=r,n.onerror=r,n.send()}downloadJson(t,e,s){this.downloadText(t,t=>{e(JSON.parse(t))},s)}downloadBinary(t,e,s){if(this.start(t,e,s))return;const i=this.rawDataUris[t];if(i&&!i.includes(".")){try{this.finish(t,200,this.dataUriToUint8Array(i))}catch(a){this.finish(t,400,JSON.stringify(a))}return}let n=new XMLHttpRequest;n.open("GET",i||t,!0),n.responseType="arraybuffer";let r=()=>{this.finish(t,n.status,n.response)};n.onload=()=>{200==n.status||0==n.status?this.finish(t,200,new Uint8Array(n.response)):r()},n.onerror=r,n.send()}start(t,e,s){let i=this.callbacks[t];try{if(i)return!0;this.callbacks[t]=i=[]}finally{i.push(e,s)}}finish(t,e,s){let i=this.callbacks[t];delete this.callbacks[t];let n=200==e||0==e?[s]:[e,s];for(let r=n.length-1,a=i.length;r<a;r+=2)i[r].apply(null,n)}}class _t{constructor(t,e){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"bones",void 0),(0,a.A)(this,"target",void 0),(0,a.A)(this,"bendDirection",0),(0,a.A)(this,"compress",!1),(0,a.A)(this,"stretch",!1),(0,a.A)(this,"mix",1),(0,a.A)(this,"softness",0),(0,a.A)(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let i=0;i<t.bones.length;i++){let s=e.findBone(t.bones[i].name);if(!s)throw new Error("Couldn't find bone ".concat(t.bones[i].name));this.bones.push(s)}let s=e.findBone(t.target.name);if(!s)throw new Error("Couldn't find bone ".concat(t.target.name));this.target=s,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}update(t){if(0==this.mix)return;let e=this.target,s=this.bones;switch(s.length){case 1:this.apply1(s[0],e.worldX,e.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(s[0],s[1],e.worldX,e.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(t,e,s,i,n,r,a){let o=t.parent;if(!o)throw new Error("IK bone must have parent.");let h=o.a,c=o.b,d=o.c,u=o.d,m=-t.ashearX-t.arotation,p=0,g=0;switch(t.inherit){case Ct.OnlyTranslation:p=(e-t.worldX)*l.signum(t.skeleton.scaleX),g=(s-t.worldY)*l.signum(t.skeleton.scaleY);break;case Ct.NoRotationOrReflection:let i=Math.abs(h*u-c*d)/Math.max(1e-4,h*h+d*d),n=h/t.skeleton.scaleX,r=d/t.skeleton.scaleY;c=-r*i*t.skeleton.scaleX,u=n*i*t.skeleton.scaleY,m+=Math.atan2(r,n)*l.radDeg;default:let a=e-o.worldX,f=s-o.worldY,w=h*u-c*d;Math.abs(w)<=1e-4?(p=0,g=0):(p=(a*u-f*c)/w-t.ax,g=(f*h-a*d)/w-t.ay)}m+=Math.atan2(g,p)*l.radDeg,t.ascaleX<0&&(m+=180),m>180?m-=360:m<-180&&(m+=360);let f=t.ascaleX,w=t.ascaleY;if(i||n){switch(t.inherit){case Ct.NoScale:case Ct.NoScaleOrReflection:p=e-t.worldX,g=s-t.worldY}const o=t.data.length*f;if(o>1e-4){const t=p*p+g*g;if(i&&t<o*o||n&&t>o*o){const e=(Math.sqrt(t)/o-1)*a+1;f*=e,r&&(w*=e)}}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+m*a,f,w,t.ashearX,t.ashearY)}apply2(t,e,s,i,n,r,a,o,h){if(t.inherit!=Ct.Normal||e.inherit!=Ct.Normal)return;let c=t.ax,d=t.ay,u=t.ascaleX,m=t.ascaleY,p=u,g=m,f=e.ascaleX,w=0,A=0,x=0;u<0?(u=-u,w=180,x=-1):(w=0,x=1),m<0&&(m=-m,x=-x),f<0?(f=-f,A=180):A=0;let b=e.ax,v=0,y=0,k=0,C=t.a,S=t.b,I=t.c,E=t.d,T=Math.abs(u-m)<=1e-4;!T||r?(v=0,y=C*b+t.worldX,k=I*b+t.worldY):(v=e.ay,y=C*b+S*v+t.worldX,k=I*b+E*v+t.worldY);let M=t.parent;if(!M)throw new Error("IK parent must itself have a parent.");C=M.a,S=M.b,I=M.c,E=M.d;let R=C*E-S*I,F=y-M.worldX,Y=k-M.worldY;R=Math.abs(R)<=1e-4?0:1/R;let L,B,X=(F*E-Y*S)*R-c,P=(Y*C-F*I)*R-d,V=Math.sqrt(X*X+P*P),D=e.data.length*f;if(V<1e-4)return this.apply1(t,s,i,!1,r,!1,h),void e.updateWorldTransformWith(b,v,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);F=s-M.worldX,Y=i-M.worldY;let O=(F*E-Y*S)*R-c,N=(Y*C-F*I)*R-d,U=O*O+N*N;if(0!=o){o*=u*(f+1)*.5;let t=Math.sqrt(U),e=t-V-D*u+o;if(e>0){let s=Math.min(1,e/(2*o))-1;s=(e-o*(1-s*s))/t,O-=s*O,N-=s*N,U=O*O+N*N}}t:if(T){D*=u;let t=(U-V*V-D*D)/(2*V*D);t<-1?(t=-1,B=Math.PI*n):t>1?(t=1,B=0,r&&(C=(Math.sqrt(U)/(V+D)-1)*h+1,p*=C,a&&(g*=C))):B=Math.acos(t)*n,C=V+D*t,S=D*Math.sin(B),L=Math.atan2(N*C-O*S,O*C+N*S)}else{C=u*D,S=m*D;let t=C*C,e=S*S,s=Math.atan2(N,O);I=e*V*V+t*U-t*e;let i=-2*e*V,r=e-t;if(E=i*i-4*r*I,E>=0){let t=Math.sqrt(E);i<0&&(t=-t),t=.5*-(i+t);let e=t/r,a=I/t,o=Math.abs(e)<Math.abs(a)?e:a;if(e=U-o*o,e>=0){Y=Math.sqrt(e)*n,L=s-Math.atan2(Y,o),B=Math.atan2(Y/m,(o-V)/u);break t}}let a=l.PI,o=V-C,h=o*o,c=0,d=0,p=V+C,g=p*p,f=0;I=-C*V/(t-e),I>=-1&&I<=1&&(I=Math.acos(I),F=C*Math.cos(I)+V,Y=S*Math.sin(I),E=F*F+Y*Y,E<h&&(a=I,h=E,o=F,c=Y),E>g&&(d=I,g=E,p=F,f=Y)),U<=.5*(h+g)?(L=s-Math.atan2(c*n,o),B=a*n):(L=s-Math.atan2(f*n,p),B=d*n)}let W=Math.atan2(v,b)*x,z=t.arotation;L=(L-W)*l.radDeg+w-z,L>180?L-=360:L<-180&&(L+=360),t.updateWorldTransformWith(c,d,z+L*h,p,g,0,0),z=e.arotation,B=((B+W)*l.radDeg-e.ashearX)*x+A-z,B>180?B-=360:B<-180&&(B+=360),e.updateWorldTransformWith(b,v,z+B*h,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class jt{constructor(t,e,s){(0,a.A)(this,"name",void 0),(0,a.A)(this,"order",void 0),(0,a.A)(this,"skinRequired",void 0),this.name=t,this.order=e,this.skinRequired=s}}class Ht extends jt{set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}constructor(t){super(t,0,!1),(0,a.A)(this,"bones",new Array),(0,a.A)(this,"_target",null),(0,a.A)(this,"bendDirection",0),(0,a.A)(this,"compress",!1),(0,a.A)(this,"stretch",!1),(0,a.A)(this,"uniform",!1),(0,a.A)(this,"mix",0),(0,a.A)(this,"softness",0)}}class Zt extends jt{set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}constructor(t){super(t,0,!1),(0,a.A)(this,"bones",new Array),(0,a.A)(this,"_target",null),(0,a.A)(this,"positionMode",St.Fixed),(0,a.A)(this,"spacingMode",It.Fixed),(0,a.A)(this,"rotateMode",Et.Chain),(0,a.A)(this,"offsetRotation",0),(0,a.A)(this,"position",0),(0,a.A)(this,"spacing",0),(0,a.A)(this,"mixRotate",0),(0,a.A)(this,"mixX",0),(0,a.A)(this,"mixY",0)}}!function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"}(St||(St={})),function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t[t.Proportional=3]="Proportional"}(It||(It={})),function(t){t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"}(Et||(Et={}));class Jt{constructor(t,e){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"bones",void 0),(0,a.A)(this,"target",void 0),(0,a.A)(this,"position",0),(0,a.A)(this,"spacing",0),(0,a.A)(this,"mixRotate",0),(0,a.A)(this,"mixX",0),(0,a.A)(this,"mixY",0),(0,a.A)(this,"spaces",new Array),(0,a.A)(this,"positions",new Array),(0,a.A)(this,"world",new Array),(0,a.A)(this,"curves",new Array),(0,a.A)(this,"lengths",new Array),(0,a.A)(this,"segments",new Array),(0,a.A)(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let i=0,n=t.bones.length;i<n;i++){let s=e.findBone(t.bones[i].name);if(!s)throw new Error("Couldn't find bone ".concat(t.bones[i].name,"."));this.bones.push(s)}let s=e.findSlot(t.target.name);if(!s)throw new Error("Couldn't find target bone ".concat(t.target.name));this.target=s,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}update(t){let e=this.target.getAttachment();if(!(e instanceof Vt))return;let s=this.mixRotate,i=this.mixX,n=this.mixY;if(0==s&&0==i&&0==n)return;let r=this.data,a=r.rotateMode==Et.Tangent,o=r.rotateMode==Et.ChainScale,h=this.bones,d=h.length,u=a?d:d+1,m=c.setArraySize(this.spaces,u),p=o?this.lengths=c.setArraySize(this.lengths,d):[],g=this.spacing;switch(r.spacingMode){case It.Percent:if(o)for(let s=0,i=u-1;s<i;s++){let t=h[s],e=t.data.length,i=e*t.a,n=e*t.c;p[s]=Math.sqrt(i*i+n*n)}c.arrayFill(m,1,u,g);break;case It.Proportional:let t=0;for(let s=0,i=u-1;s<i;){let e=h[s],i=e.data.length;if(i<Jt.epsilon)o&&(p[s]=0),m[++s]=g;else{let n=i*e.a,r=i*e.c,a=Math.sqrt(n*n+r*r);o&&(p[s]=a),m[++s]=a,t+=a}}if(t>0){t=u/t*g;for(let e=1;e<u;e++)m[e]*=t}break;default:let e=r.spacingMode==It.Length;for(let s=0,i=u-1;s<i;){let t=h[s],i=t.data.length;if(i<Jt.epsilon)o&&(p[s]=0),m[++s]=g;else{let n=i*t.a,r=i*t.c,a=Math.sqrt(n*n+r*r);o&&(p[s]=a),m[++s]=(e?i+g:g)*a/i}}}let f=this.computeWorldPositions(e,u,a),w=f[0],A=f[1],x=r.offsetRotation,b=!1;if(0==x)b=r.rotateMode==Et.Chain;else{b=!1;let t=this.target.bone;x*=t.a*t.d-t.b*t.c>0?l.degRad:-l.degRad}for(let c=0,v=3;c<d;c++,v+=3){let t=h[c];t.worldX+=(w-t.worldX)*i,t.worldY+=(A-t.worldY)*n;let e=f[v],r=f[v+1],d=e-w,u=r-A;if(o){let e=p[c];if(0!=e){let i=(Math.sqrt(d*d+u*u)/e-1)*s+1;t.a*=i,t.c*=i}}if(w=e,A=r,s>0){let e=t.a,i=t.b,n=t.c,r=t.d,o=0,h=0,p=0;if(o=a?f[v-1]:0==m[c+1]?f[v+2]:Math.atan2(u,d),o-=Math.atan2(n,e),b){h=Math.cos(o),p=Math.sin(o);let i=t.data.length;w+=(i*(h*e-p*n)-d)*s,A+=(i*(p*e+h*n)-u)*s}else o+=x;o>l.PI?o-=l.PI2:o<-l.PI&&(o+=l.PI2),o*=s,h=Math.cos(o),p=Math.sin(o),t.a=h*e-p*n,t.b=h*i-p*r,t.c=p*e+h*n,t.d=p*i+h*r}t.updateAppliedTransform()}}computeWorldPositions(t,e,s){let i=this.target,n=this.position,r=this.spaces,a=c.setArraySize(this.positions,3*e+2),o=this.world,h=t.closed,l=t.worldVerticesLength,d=l/6,u=Jt.NONE;if(!t.constantSpeed){let m=t.lengths;d-=h?1:2;let p,g=m[d];switch(this.data.positionMode==St.Percent&&(n*=g),this.data.spacingMode){case It.Percent:p=g;break;case It.Proportional:p=g/e;break;default:p=1}o=c.setArraySize(this.world,8);for(let c=0,f=0,w=0;c<e;c++,f+=3){let e=r[c]*p;n+=e;let A=n;if(h)A%=g,A<0&&(A+=g),w=0;else{if(A<0){u!=Jt.BEFORE&&(u=Jt.BEFORE,t.computeWorldVertices(i,2,4,o,0,2)),this.addBeforePosition(A,o,0,a,f);continue}if(A>g){u!=Jt.AFTER&&(u=Jt.AFTER,t.computeWorldVertices(i,l-6,4,o,0,2)),this.addAfterPosition(A-g,o,0,a,f);continue}}for(;;w++){let t=m[w];if(!(A>t)){if(0==w)A/=t;else{let e=m[w-1];A=(A-e)/(t-e)}break}}w!=u&&(u=w,h&&w==d?(t.computeWorldVertices(i,l-4,4,o,0,2),t.computeWorldVertices(i,0,4,o,4,2)):t.computeWorldVertices(i,6*w+2,8,o,0,2)),this.addCurvePosition(A,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],a,f,s||c>0&&0==e)}return a}h?(l+=2,o=c.setArraySize(this.world,l),t.computeWorldVertices(i,2,l-4,o,0,2),t.computeWorldVertices(i,0,2,o,l-4,2),o[l-2]=o[0],o[l-1]=o[1]):(d--,l-=4,o=c.setArraySize(this.world,l),t.computeWorldVertices(i,2,l,o,0,2));let m,p=c.setArraySize(this.curves,d),g=0,f=o[0],w=o[1],A=0,x=0,b=0,v=0,y=0,k=0,C=0,S=0,I=0,E=0,T=0,M=0,R=0,F=0;for(let c=0,B=2;c<d;c++,B+=6)A=o[B],x=o[B+1],b=o[B+2],v=o[B+3],y=o[B+4],k=o[B+5],C=.1875*(f-2*A+b),S=.1875*(w-2*x+v),I=.09375*(3*(A-b)-f+y),E=.09375*(3*(x-v)-w+k),T=2*C+I,M=2*S+E,R=.75*(A-f)+C+.16666667*I,F=.75*(x-w)+S+.16666667*E,g+=Math.sqrt(R*R+F*F),R+=T,F+=M,T+=I,M+=E,g+=Math.sqrt(R*R+F*F),R+=T,F+=M,g+=Math.sqrt(R*R+F*F),R+=T+I,F+=M+E,g+=Math.sqrt(R*R+F*F),p[c]=g,f=y,w=k;switch(this.data.positionMode==St.Percent&&(n*=g),this.data.spacingMode){case It.Percent:m=g;break;case It.Proportional:m=g/e;break;default:m=1}let Y=this.segments,L=0;for(let c=0,B=0,X=0,P=0;c<e;c++,B+=3){let t=r[c]*m;n+=t;let e=n;if(h)e%=g,e<0&&(e+=g),X=0;else{if(e<0){this.addBeforePosition(e,o,0,a,B);continue}if(e>g){this.addAfterPosition(e-g,o,l-4,a,B);continue}}for(;;X++){let t=p[X];if(!(e>t)){if(0==X)e/=t;else{let s=p[X-1];e=(e-s)/(t-s)}break}}if(X!=u){u=X;let t=6*X;for(f=o[t],w=o[t+1],A=o[t+2],x=o[t+3],b=o[t+4],v=o[t+5],y=o[t+6],k=o[t+7],C=.03*(f-2*A+b),S=.03*(w-2*x+v),I=.006*(3*(A-b)-f+y),E=.006*(3*(x-v)-w+k),T=2*C+I,M=2*S+E,R=.3*(A-f)+C+.16666667*I,F=.3*(x-w)+S+.16666667*E,L=Math.sqrt(R*R+F*F),Y[0]=L,t=1;t<8;t++)R+=T,F+=M,T+=I,M+=E,L+=Math.sqrt(R*R+F*F),Y[t]=L;R+=T,F+=M,L+=Math.sqrt(R*R+F*F),Y[8]=L,R+=T+I,F+=M+E,L+=Math.sqrt(R*R+F*F),Y[9]=L,P=0}for(e*=L;;P++){let t=Y[P];if(!(e>t)){if(0==P)e/=t;else{let s=Y[P-1];e=P+(e-s)/(t-s)}break}}this.addCurvePosition(.1*e,f,w,A,x,b,v,y,k,a,B,s||c>0&&0==t)}return a}addBeforePosition(t,e,s,i,n){let r=e[s],a=e[s+1],o=e[s+2]-r,h=e[s+3]-a,l=Math.atan2(h,o);i[n]=r+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l}addAfterPosition(t,e,s,i,n){let r=e[s+2],a=e[s+3],o=r-e[s],h=a-e[s+1],l=Math.atan2(h,o);i[n]=r+t*Math.cos(l),i[n+1]=a+t*Math.sin(l),i[n+2]=l}addCurvePosition(t,e,s,i,n,r,a,o,h,l,c,d){if(0==t||isNaN(t))return l[c]=e,l[c+1]=s,void(l[c+2]=Math.atan2(n-s,i-e));let u=t*t,m=u*t,p=1-t,g=p*p,f=g*p,w=p*t,A=3*w,x=p*A,b=A*t,v=e*f+i*x+r*b+o*m,y=s*f+n*x+a*b+h*m;l[c]=v,l[c+1]=y,d&&(l[c+2]=t<.001?Math.atan2(n-s,i-e):Math.atan2(y-(s*g+n*w*2+a*u),v-(e*g+i*w*2+r*u)))}}(0,a.A)(Jt,"NONE",-1),(0,a.A)(Jt,"BEFORE",-2),(0,a.A)(Jt,"AFTER",-3),(0,a.A)(Jt,"epsilon",1e-5);class Kt{set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}constructor(t,e){(0,a.A)(this,"data",void 0),(0,a.A)(this,"_bone",null),(0,a.A)(this,"inertia",0),(0,a.A)(this,"strength",0),(0,a.A)(this,"damping",0),(0,a.A)(this,"massInverse",0),(0,a.A)(this,"wind",0),(0,a.A)(this,"gravity",0),(0,a.A)(this,"mix",0),(0,a.A)(this,"_reset",!0),(0,a.A)(this,"ux",0),(0,a.A)(this,"uy",0),(0,a.A)(this,"cx",0),(0,a.A)(this,"cy",0),(0,a.A)(this,"tx",0),(0,a.A)(this,"ty",0),(0,a.A)(this,"xOffset",0),(0,a.A)(this,"xVelocity",0),(0,a.A)(this,"yOffset",0),(0,a.A)(this,"yVelocity",0),(0,a.A)(this,"rotateOffset",0),(0,a.A)(this,"rotateVelocity",0),(0,a.A)(this,"scaleOffset",0),(0,a.A)(this,"scaleVelocity",0),(0,a.A)(this,"active",!1),(0,a.A)(this,"skeleton",void 0),(0,a.A)(this,"remaining",0),(0,a.A)(this,"lastTime",0),this.data=t,this.skeleton=e,this.bone=e.bones[t.bone.index],this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const t=this.data;this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}isActive(){return this.active}update(t){const e=this.mix;if(0==e)return;const s=this.data.x>0,i=this.data.y>0,n=this.data.rotate>0||this.data.shearX>0,r=this.data.scaleX>0,a=this.bone,o=a.data.length;switch(t){case Tt.none:return;case Tt.reset:this.reset();case Tt.update:const t=this.skeleton,h=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=h,this.lastTime=t.time;const c=a.worldX,d=a.worldY;if(this._reset)this._reset=!1,this.ux=c,this.uy=d;else{let u=this.remaining,m=this.inertia,p=this.data.step,g=this.skeleton.data.referenceScale,f=-1,w=this.data.limit*h,A=w*Math.abs(t.scaleY);if(w*=Math.abs(t.scaleX),s||i){if(s){const t=(this.ux-c)*m;this.xOffset+=t>w?w:t<-w?-w:t,this.ux=c}if(i){const t=(this.uy-d)*m;this.yOffset+=t>A?A:t<-A?-A:t,this.uy=d}if(u>=p){f=Math.pow(this.damping,60*p);const e=this.massInverse*p,n=this.strength,r=this.wind*g*t.scaleX,a=this.gravity*g*t.scaleY;do{s&&(this.xVelocity+=(r-this.xOffset*n)*e,this.xOffset+=this.xVelocity*p,this.xVelocity*=f),i&&(this.yVelocity-=(a+this.yOffset*n)*e,this.yOffset+=this.yVelocity*p,this.yVelocity*=f),u-=p}while(u>=p)}s&&(a.worldX+=this.xOffset*e*this.data.x),i&&(a.worldY+=this.yOffset*e*this.data.y)}if(n||r){let t=Math.atan2(a.c,a.a),s=0,i=0,h=0,c=this.cx-a.worldX,d=this.cy-a.worldY;if(c>w?c=w:c<-w&&(c=-w),d>A?d=A:d<-A&&(d=-A),n){h=(this.data.rotate+this.data.shearX)*e;let n=Math.atan2(d+this.ty,c+this.tx)-t-this.rotateOffset*h;this.rotateOffset+=(n-Math.ceil(n*l.invPI2-.5)*l.PI2)*m,n=this.rotateOffset*h+t,s=Math.cos(n),i=Math.sin(n),r&&(n=o*a.getWorldScaleX(),n>0&&(this.scaleOffset+=(c*s+d*i)*m/n))}else{s=Math.cos(t),i=Math.sin(t);const e=o*a.getWorldScaleX();e>0&&(this.scaleOffset+=(c*s+d*i)*m/e)}if(u=this.remaining,u>=p){-1==f&&(f=Math.pow(this.damping,60*p));const e=this.massInverse*p,a=this.strength,l=this.wind,c=te.yDown?-this.gravity:this.gravity,d=o/g;for(;;)if(u-=p,r&&(this.scaleVelocity+=(l*s-c*i-this.scaleOffset*a)*e,this.scaleOffset+=this.scaleVelocity*p,this.scaleVelocity*=f),n){if(this.rotateVelocity-=((l*i+c*s)*d+this.rotateOffset*a)*e,this.rotateOffset+=this.rotateVelocity*p,this.rotateVelocity*=f,u<p)break;const n=this.rotateOffset*h+t;s=Math.cos(n),i=Math.sin(n)}else if(u<p)break}}this.remaining=u}this.cx=a.worldX,this.cy=a.worldY;break;case Tt.pose:s&&(a.worldX+=this.xOffset*e*this.data.x),i&&(a.worldY+=this.yOffset*e*this.data.y)}if(n){let t=this.rotateOffset*e,s=0,i=0,n=0;if(this.data.shearX>0){let e=0;this.data.rotate>0&&(e=t*this.data.rotate,s=Math.sin(e),i=Math.cos(e),n=a.b,a.b=i*n-s*a.d,a.d=s*n+i*a.d),e+=t*this.data.shearX,s=Math.sin(e),i=Math.cos(e),n=a.a,a.a=i*n-s*a.c,a.c=s*n+i*a.c}else t*=this.data.rotate,s=Math.sin(t),i=Math.cos(t),n=a.a,a.a=i*n-s*a.c,a.c=s*n+i*a.c,n=a.b,a.b=i*n-s*a.d,a.d=s*n+i*a.d}if(r){const t=1+this.scaleOffset*e*this.data.scaleX;a.a*=t,a.c*=t}t!=Tt.pose&&(this.tx=o*a.a,this.ty=o*a.c),a.updateAppliedTransform()}translate(t,e){this.ux-=t,this.uy-=e,this.cx-=t,this.cy-=e}rotate(t,e,s){const i=s*l.degRad,n=Math.cos(i),r=Math.sin(i),a=this.cx-t,o=this.cy-e;this.translate(a*n-o*r-a,a*r+o*n-o)}}class Qt{constructor(t,e){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"bone",void 0),(0,a.A)(this,"color",void 0),(0,a.A)(this,"darkColor",null),(0,a.A)(this,"attachment",null),(0,a.A)(this,"attachmentState",0),(0,a.A)(this,"sequenceIndex",-1),(0,a.A)(this,"deform",new Array),!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new h,this.darkColor=t.darkColor?new h:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(t instanceof g&&this.attachment instanceof g&&t.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class $t{constructor(t,e){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"bones",void 0),(0,a.A)(this,"target",void 0),(0,a.A)(this,"mixRotate",0),(0,a.A)(this,"mixX",0),(0,a.A)(this,"mixY",0),(0,a.A)(this,"mixScaleX",0),(0,a.A)(this,"mixScaleY",0),(0,a.A)(this,"mixShearY",0),(0,a.A)(this,"temp",new u),(0,a.A)(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let i=0;i<t.bones.length;i++){let s=e.findBone(t.bones[i].name);if(!s)throw new Error("Couldn't find bone ".concat(t.bones[i].name,"."));this.bones.push(s)}let s=e.findBone(t.target.name);if(!s)throw new Error("Couldn't find target bone ".concat(t.target.name,"."));this.target=s,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}update(t){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleY&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,r=this.mixShearY,a=0!=e||0!=s,o=this.target,h=o.a,c=o.b,d=o.c,u=o.d,m=h*u-c*d>0?l.degRad:-l.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,f=this.bones;for(let w=0,A=f.length;w<A;w++){let m=f[w];if(0!=t){let e=m.a,s=m.b,i=m.c,n=m.d,r=Math.atan2(d,h)-Math.atan2(i,e)+p;r>l.PI?r-=l.PI2:r<-l.PI&&(r+=l.PI2),r*=t;let a=Math.cos(r),o=Math.sin(r);m.a=a*e-o*i,m.b=a*s-o*n,m.c=o*e+a*i,m.d=o*s+a*n}if(a){let t=this.temp;o.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.worldX+=(t.x-m.worldX)*e,m.worldY+=(t.y-m.worldY)*s}if(0!=i){let t=Math.sqrt(m.a*m.a+m.c*m.c);0!=t&&(t=(t+(Math.sqrt(h*h+d*d)-t+this.data.offsetScaleX)*i)/t),m.a*=t,m.c*=t}if(0!=n){let t=Math.sqrt(m.b*m.b+m.d*m.d);0!=t&&(t=(t+(Math.sqrt(c*c+u*u)-t+this.data.offsetScaleY)*n)/t),m.b*=t,m.d*=t}if(r>0){let t=m.b,e=m.d,s=Math.atan2(e,t),i=Math.atan2(u,c)-Math.atan2(d,h)-(s-Math.atan2(m.c,m.a));i>l.PI?i-=l.PI2:i<-l.PI&&(i+=l.PI2),i=s+(i+g)*r;let n=Math.sqrt(t*t+e*e);m.b=Math.cos(i)*n,m.d=Math.sin(i)*n}m.updateAppliedTransform()}}applyRelativeWorld(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,r=this.mixShearY,a=0!=e||0!=s,o=this.target,h=o.a,c=o.b,d=o.c,u=o.d,m=h*u-c*d>0?l.degRad:-l.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,f=this.bones;for(let w=0,A=f.length;w<A;w++){let m=f[w];if(0!=t){let e=m.a,s=m.b,i=m.c,n=m.d,r=Math.atan2(d,h)+p;r>l.PI?r-=l.PI2:r<-l.PI&&(r+=l.PI2),r*=t;let a=Math.cos(r),o=Math.sin(r);m.a=a*e-o*i,m.b=a*s-o*n,m.c=o*e+a*i,m.d=o*s+a*n}if(a){let t=this.temp;o.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.worldX+=t.x*e,m.worldY+=t.y*s}if(0!=i){let t=(Math.sqrt(h*h+d*d)-1+this.data.offsetScaleX)*i+1;m.a*=t,m.c*=t}if(0!=n){let t=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleY)*n+1;m.b*=t,m.d*=t}if(r>0){let t=Math.atan2(u,c)-Math.atan2(d,h);t>l.PI?t-=l.PI2:t<-l.PI&&(t+=l.PI2);let e=m.b,s=m.d;t=Math.atan2(s,e)+(t-l.PI/2+g)*r;let i=Math.sqrt(e*e+s*s);m.b=Math.cos(t)*i,m.d=Math.sin(t)*i}m.updateAppliedTransform()}}applyAbsoluteLocal(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,r=this.mixShearY,a=this.target,o=this.bones;for(let h=0,l=o.length;h<l;h++){let l=o[h],c=l.arotation;0!=t&&(c+=(a.arotation-c+this.data.offsetRotation)*t);let d=l.ax,u=l.ay;d+=(a.ax-d+this.data.offsetX)*e,u+=(a.ay-u+this.data.offsetY)*s;let m=l.ascaleX,p=l.ascaleY;0!=i&&0!=m&&(m=(m+(a.ascaleX-m+this.data.offsetScaleX)*i)/m),0!=n&&0!=p&&(p=(p+(a.ascaleY-p+this.data.offsetScaleY)*n)/p);let g=l.ashearY;0!=r&&(g+=(a.ashearY-g+this.data.offsetShearY)*r),l.updateWorldTransformWith(d,u,c,m,p,l.ashearX,g)}}applyRelativeLocal(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,r=this.mixShearY,a=this.target,o=this.bones;for(let h=0,l=o.length;h<l;h++){let l=o[h],c=l.arotation+(a.arotation+this.data.offsetRotation)*t,d=l.ax+(a.ax+this.data.offsetX)*e,u=l.ay+(a.ay+this.data.offsetY)*s,m=l.ascaleX*((a.ascaleX-1+this.data.offsetScaleX)*i+1),p=l.ascaleY*((a.ascaleY-1+this.data.offsetScaleY)*n+1),g=l.ashearY+(a.ashearY+this.data.offsetShearY)*r;l.updateWorldTransformWith(d,u,c,m,p,l.ashearX,g)}}}class te{get scaleY(){return te.yDown?-this._scaleY:this._scaleY}set scaleY(t){this._scaleY=t}constructor(t){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"bones",void 0),(0,a.A)(this,"slots",void 0),(0,a.A)(this,"drawOrder",void 0),(0,a.A)(this,"ikConstraints",void 0),(0,a.A)(this,"transformConstraints",void 0),(0,a.A)(this,"pathConstraints",void 0),(0,a.A)(this,"physicsConstraints",void 0),(0,a.A)(this,"_updateCache",new Array),(0,a.A)(this,"skin",null),(0,a.A)(this,"color",void 0),(0,a.A)(this,"scaleX",1),(0,a.A)(this,"_scaleY",1),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"time",0),!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){let s,i=t.bones[e];if(i.parent){let t=this.bones[i.parent.index];s=new Wt(i,this,t),t.children.push(s)}else s=new Wt(i,this,null);this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){let s=t.slots[e],i=this.bones[s.boneData.index],n=new Qt(s,i);this.slots.push(n),this.drawOrder.push(n)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){let s=t.ikConstraints[e];this.ikConstraints.push(new _t(s,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){let s=t.transformConstraints[e];this.transformConstraints.push(new $t(s,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){let s=t.pathConstraints[e];this.pathConstraints.push(new Jt(s,this))}this.physicsConstraints=new Array;for(let e=0;e<t.physicsConstraints.length;e++){let s=t.physicsConstraints[e];this.physicsConstraints.push(new Kt(s,this))}this.color=new h(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;let t=this.bones;for(let c=0,d=t.length;c<d;c++){let e=t[c];e.sorted=e.data.skinRequired,e.active=!e.sorted}if(this.skin){let t=this.skin.bones;for(let e=0,s=this.skin.bones.length;e<s;e++){let s=this.bones[t[e].index];do{s.sorted=!1,s.active=!0,s=s.parent}while(s)}}let e=this.ikConstraints,s=this.transformConstraints,i=this.pathConstraints,n=this.physicsConstraints,r=e.length,a=s.length,o=i.length,h=this.physicsConstraints.length,l=r+a+o+h;t:for(let c=0;c<l;c++){for(let t=0;t<r;t++){let s=e[t];if(s.data.order==c){this.sortIkConstraint(s);continue t}}for(let t=0;t<a;t++){let e=s[t];if(e.data.order==c){this.sortTransformConstraint(e);continue t}}for(let t=0;t<o;t++){let e=i[t];if(e.data.order==c){this.sortPathConstraint(e);continue t}}for(let t=0;t<h;t++){const e=n[t];if(e.data.order==c){this.sortPhysicsConstraint(e);continue t}}}for(let c=0,d=t.length;c<d;c++)this.sortBone(t[c])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&c.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target;this.sortBone(e);let s=t.bones,i=s[0];if(this.sortBone(i),1==s.length)this._updateCache.push(t),this.sortReset(i.children);else{let e=s[s.length-1];this.sortBone(e),this._updateCache.push(t),this.sortReset(i.children),e.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&c.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target,s=e.data.index,i=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,s,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,i);for(let o=0,h=this.data.skins.length;o<h;o++)this.sortPathConstraintAttachment(this.data.skins[o],s,i);let n=e.getAttachment();n instanceof Vt&&this.sortPathConstraintAttachmentWith(n,i);let r=t.bones,a=r.length;for(let o=0;o<a;o++)this.sortBone(r[o]);this._updateCache.push(t);for(let o=0;o<a;o++)this.sortReset(r[o].children);for(let o=0;o<a;o++)r[o].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&c.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);let e=t.bones,s=e.length;if(t.data.local)for(let i=0;i<s;i++){let t=e[i];this.sortBone(t.parent),this.sortBone(t)}else for(let i=0;i<s;i++)this.sortBone(e[i]);this._updateCache.push(t);for(let i=0;i<s;i++)this.sortReset(e[i].children);for(let i=0;i<s;i++)e[i].sorted=!0}sortPathConstraintAttachment(t,e,s){let i=t.attachments[e];if(i)for(let n in i)this.sortPathConstraintAttachmentWith(i[n],s)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Vt))return;let s=t.bones;if(s){let t=this.bones;for(let e=0,i=s.length;e<i;){let i=s[e++];for(i+=e;e<i;)this.sortBone(t[s[e++]])}}else this.sortBone(e)}sortPhysicsConstraint(t){const e=t.bone;t.active=e.active&&(!t.data.skinRequired||null!=this.skin&&c.contains(this.skin.constraints,t.data,!0)),t.active&&(this.sortBone(e),this._updateCache.push(t),this.sortReset(e.children),e.sorted=!0)}sortBone(t){if(!t)return;if(t.sorted)return;let e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,s=t.length;e<s;e++){let s=t[e];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(t){if(void 0===t||null===t)throw new Error("physics is undefined");let e=this.bones;for(let i=0,n=e.length;i<n;i++){let t=e[i];t.ax=t.x,t.ay=t.y,t.arotation=t.rotation,t.ascaleX=t.scaleX,t.ascaleY=t.scaleY,t.ashearX=t.shearX,t.ashearY=t.shearY}let s=this._updateCache;for(let i=0,n=s.length;i<n;i++)s[i].update(t)}updateWorldTransformWith(t,e){if(!e)throw new Error("parent cannot be null.");let s=this.bones;for(let l=1,f=s.length;l<f;l++){let t=s[l];t.ax=t.x,t.ay=t.y,t.arotation=t.rotation,t.ascaleX=t.scaleX,t.ascaleY=t.scaleY,t.ashearX=t.shearX,t.ashearY=t.shearY}let i=this.getRootBone();if(!i)throw new Error("Root bone must not be null.");let n=e.a,r=e.b,a=e.c,o=e.d;i.worldX=n*this.x+r*this.y+e.worldX,i.worldY=a*this.x+o*this.y+e.worldY;const h=(i.rotation+i.shearX)*l.degRad,c=(i.rotation+90+i.shearY)*l.degRad,d=Math.cos(h)*i.scaleX,u=Math.cos(c)*i.scaleY,m=Math.sin(h)*i.scaleX,p=Math.sin(c)*i.scaleY;i.a=(n*d+r*m)*this.scaleX,i.b=(n*u+r*p)*this.scaleX,i.c=(a*d+o*m)*this.scaleY,i.d=(a*u+o*p)*this.scaleY;let g=this._updateCache;for(let l=0,f=g.length;l<f;l++){let e=g[l];e!=i&&e.update(t)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const t of this.bones)t.setToSetupPose();for(const t of this.ikConstraints)t.setToSetupPose();for(const t of this.transformConstraints)t.setToSetupPose();for(const t of this.pathConstraints)t.setToSetupPose();for(const t of this.physicsConstraints)t.setToSetupPose()}setSlotsToSetupPose(){let t=this.slots;c.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.data.name==t)return i}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.data.name==t)return i}return null}setSkinByName(t){let e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{let e=this.slots;for(let s=0,i=e.length;s<i;s++){let i=e[s],n=i.data.attachmentName;if(n){let e=t.getAttachment(s,n);e&&i.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){let s=this.data.findSlot(t);if(!s)throw new Error("Can't find slot with name ".concat(t));return this.getAttachment(s.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){let s=this.skin.getAttachment(t,e);if(s)return s}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");let s=this.slots;for(let i=0,n=s.length;i<n;i++){let n=s[i];if(n.data.name==t){let s=null;if(e&&(s=this.getAttachment(i,e),!s))throw new Error("Attachment not found: "+e+", for slot: "+t);return void n.setAttachment(s)}}throw new Error("Slot not found: "+t)}findIkConstraint(t){var e;if(!t)throw new Error("constraintName cannot be null.");return null!==(e=this.ikConstraints.find(e=>e.data.name==t))&&void 0!==e?e:null}findTransformConstraint(t){var e;if(!t)throw new Error("constraintName cannot be null.");return null!==(e=this.transformConstraints.find(e=>e.data.name==t))&&void 0!==e?e:null}findPathConstraint(t){var e;if(!t)throw new Error("constraintName cannot be null.");return null!==(e=this.pathConstraints.find(e=>e.data.name==t))&&void 0!==e?e:null}findPhysicsConstraint(t){var e;if(null==t)throw new Error("constraintName cannot be null.");return null!==(e=this.physicsConstraints.find(e=>e.data.name==t))&&void 0!==e?e:null}getBoundsRect(t){let e=new u,s=new u;return this.getBounds(e,s,void 0,t),{x:e.x,y:e.y,width:s.x,height:s.y}}getBounds(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Array(2),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");let n=this.drawOrder,r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;for(let l=0,d=n.length;l<d;l++){let t=n[l];if(!t.bone.active)continue;let e=0,d=null,u=null,m=t.getAttachment();if(m instanceof Ot)e=8,d=c.setArraySize(s,e,0),m.computeWorldVertices(t,d,0,2),u=te.quadTriangles;else if(m instanceof Pt){let i=m;e=i.worldVerticesLength,d=c.setArraySize(s,e,0),i.computeWorldVertices(t,0,e,d,0,2),u=i.triangles}else if(m instanceof bt&&null!=i){i.clipStart(t,m);continue}if(d&&u){null!=i&&i.isClipping()&&(i.clipTriangles(d,u,u.length),d=i.clippedVertices,e=i.clippedVertices.length);for(let t=0,e=d.length;t<e;t+=2){let e=d[t],s=d[t+1];r=Math.min(r,e),a=Math.min(a,s),o=Math.max(o,e),h=Math.max(h,s)}}null!=i&&i.clipEndWithSlot(t)}null!=i&&i.clipEnd(),t.set(r,a),e.set(o-r,h-a)}update(t){this.time+=t}physicsTranslate(t,e){const s=this.physicsConstraints;for(let i=0,n=s.length;i<n;i++)s[i].translate(t,e)}physicsRotate(t,e,s){const i=this.physicsConstraints;for(let n=0,r=i.length;n<r;n++)i[n].rotate(t,e,s)}}(0,a.A)(te,"quadTriangles",[0,1,2,2,3,0]),(0,a.A)(te,"yDown",!1),function(t){t[t.none=0]="none",t[t.reset=1]="reset",t[t.update=2]="update",t[t.pose=3]="pose"}(Tt||(Tt={}));class ee{constructor(t,e){if((0,a.A)(this,"data",void 0),(0,a.A)(this,"intValue",0),(0,a.A)(this,"floatValue",0),(0,a.A)(this,"stringValue",null),(0,a.A)(this,"time",0),(0,a.A)(this,"volume",0),(0,a.A)(this,"balance",0),!e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class se{constructor(t){(0,a.A)(this,"name",void 0),(0,a.A)(this,"intValue",0),(0,a.A)(this,"floatValue",0),(0,a.A)(this,"stringValue",null),(0,a.A)(this,"audioPath",null),(0,a.A)(this,"volume",0),(0,a.A)(this,"balance",0),this.name=t}}class ie extends jt{set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}constructor(t){super(t,0,!1),(0,a.A)(this,"_bone",null),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"rotate",0),(0,a.A)(this,"scaleX",0),(0,a.A)(this,"shearX",0),(0,a.A)(this,"limit",0),(0,a.A)(this,"step",0),(0,a.A)(this,"inertia",0),(0,a.A)(this,"strength",0),(0,a.A)(this,"damping",0),(0,a.A)(this,"massInverse",0),(0,a.A)(this,"wind",0),(0,a.A)(this,"gravity",0),(0,a.A)(this,"mix",0),(0,a.A)(this,"inertiaGlobal",!1),(0,a.A)(this,"strengthGlobal",!1),(0,a.A)(this,"dampingGlobal",!1),(0,a.A)(this,"massGlobal",!1),(0,a.A)(this,"windGlobal",!1),(0,a.A)(this,"gravityGlobal",!1),(0,a.A)(this,"mixGlobal",!1)}}class ne{constructor(){(0,a.A)(this,"name",null),(0,a.A)(this,"bones",new Array),(0,a.A)(this,"slots",new Array),(0,a.A)(this,"skins",new Array),(0,a.A)(this,"defaultSkin",null),(0,a.A)(this,"events",new Array),(0,a.A)(this,"animations",new Array),(0,a.A)(this,"ikConstraints",new Array),(0,a.A)(this,"transformConstraints",new Array),(0,a.A)(this,"pathConstraints",new Array),(0,a.A)(this,"physicsConstraints",new Array),(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"referenceScale",100),(0,a.A)(this,"version",null),(0,a.A)(this,"hash",null),(0,a.A)(this,"fps",0),(0,a.A)(this,"imagesPath",null),(0,a.A)(this,"audioPath",null)}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findSkin(t){if(!t)throw new Error("skinName cannot be null.");let e=this.skins;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");let e=this.animations;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,i=e.length;s<i;s++){const i=e[s];if(i.name==t)return i}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,i=e.length;s<i;s++){const i=e[s];if(i.name==t)return i}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,i=e.length;s<i;s++){const i=e[s];if(i.name==t)return i}return null}findPhysicsConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.physicsConstraints;for(let s=0,i=e.length;s<i;s++){const i=e[s];if(i.name==t)return i}return null}}class re{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;(0,a.A)(this,"slotIndex",void 0),(0,a.A)(this,"name",void 0),(0,a.A)(this,"attachment",void 0),this.slotIndex=t,this.name=e,this.attachment=s}}class ae{constructor(t){if((0,a.A)(this,"name",void 0),(0,a.A)(this,"attachments",new Array),(0,a.A)(this,"bones",Array()),(0,a.A)(this,"constraints",new Array),(0,a.A)(this,"color",new h(.99607843,.61960787,.30980393,1)),!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(!s)throw new Error("attachment cannot be null.");let i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=s}addSkin(t){for(let i=0;i<t.bones.length;i++){let e=t.bones[i],s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){s=!0;break}s||this.bones.push(e)}for(let i=0;i<t.constraints.length;i++){let e=t.constraints[i],s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){s=!0;break}s||this.constraints.push(e)}let e=t.getAttachments();for(let i=0;i<e.length;i++){var s=e[i];this.setAttachment(s.slotIndex,s.name,s.attachment)}}copySkin(t){for(let i=0;i<t.bones.length;i++){let e=t.bones[i],s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){s=!0;break}s||this.bones.push(e)}for(let i=0;i<t.constraints.length;i++){let e=t.constraints[i],s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){s=!0;break}s||this.constraints.push(e)}let e=t.getAttachments();for(let i=0;i<e.length;i++){var s=e[i];s.attachment&&(s.attachment instanceof Pt?(s.attachment=s.attachment.newLinkedMesh(),this.setAttachment(s.slotIndex,s.name,s.attachment)):(s.attachment=s.attachment.copy(),this.setAttachment(s.slotIndex,s.name,s.attachment)))}}getAttachment(t,e){let s=this.attachments[t];return s?s[e]:null}removeAttachment(t,e){let s=this.attachments[t];s&&delete s[e]}getAttachments(){let t=new Array;for(var e=0;e<this.attachments.length;e++){let s=this.attachments[e];if(s)for(let i in s){let n=s[i];n&&t.push(new re(e,i,n))}}return t}getAttachmentsForSlot(t,e){let s=this.attachments[t];if(s)for(let i in s){let n=s[i];n&&e.push(new re(t,i,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let s=0;for(let i=0;i<t.slots.length;i++){let n=t.slots[i],r=n.getAttachment();if(r&&s<e.attachments.length){let t=e.attachments[s];for(let e in t){if(r==t[e]){let t=this.getAttachment(s,e);t&&n.setAttachment(t);break}}}s++}}}class oe{constructor(t,e,s){if((0,a.A)(this,"index",0),(0,a.A)(this,"name",void 0),(0,a.A)(this,"boneData",void 0),(0,a.A)(this,"color",new h(1,1,1,1)),(0,a.A)(this,"darkColor",null),(0,a.A)(this,"attachmentName",null),(0,a.A)(this,"blendMode",Mt.Normal),(0,a.A)(this,"visible",!0),t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}}!function(t){t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"}(Mt||(Mt={}));class he extends jt{set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}constructor(t){super(t,0,!1),(0,a.A)(this,"bones",new Array),(0,a.A)(this,"_target",null),(0,a.A)(this,"mixRotate",0),(0,a.A)(this,"mixX",0),(0,a.A)(this,"mixY",0),(0,a.A)(this,"mixScaleX",0),(0,a.A)(this,"mixScaleY",0),(0,a.A)(this,"mixShearY",0),(0,a.A)(this,"offsetRotation",0),(0,a.A)(this,"offsetX",0),(0,a.A)(this,"offsetY",0),(0,a.A)(this,"offsetScaleX",0),(0,a.A)(this,"offsetScaleY",0),(0,a.A)(this,"offsetShearY",0),(0,a.A)(this,"relative",!1),(0,a.A)(this,"local",!1)}}class le{constructor(t){(0,a.A)(this,"scale",1),(0,a.A)(this,"attachmentLoader",void 0),(0,a.A)(this,"linkedMeshes",new Array),this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,s=new ne;s.name="";let i=new ce(t),n=i.readInt32(),r=i.readInt32();s.hash=0==r&&0==n?null:r.toString(16)+n.toString(16),s.version=i.readString(),s.x=i.readFloat(),s.y=i.readFloat(),s.width=i.readFloat(),s.height=i.readFloat(),s.referenceScale=i.readFloat()*e;let a=i.readBoolean();a&&(s.fps=i.readFloat(),s.imagesPath=i.readString(),s.audioPath=i.readString());let o=0;o=i.readInt(!0);for(let h=0;h<o;h++){let t=i.readString();if(!t)throw new Error("String in string table must not be null.");i.strings.push(t)}o=i.readInt(!0);for(let c=0;c<o;c++){let t=i.readString();if(!t)throw new Error("Bone name must not be null.");let n=0==c?null:s.bones[i.readInt(!0)],r=new Ut(c,t,n);var l;if(r.rotation=i.readFloat(),r.x=i.readFloat()*e,r.y=i.readFloat()*e,r.scaleX=i.readFloat(),r.scaleY=i.readFloat(),r.shearX=i.readFloat(),r.shearY=i.readFloat(),r.length=i.readFloat()*e,r.inherit=i.readByte(),r.skinRequired=i.readBoolean(),a)h.rgba8888ToColor(r.color,i.readInt32()),r.icon=null!==(l=i.readString())&&void 0!==l?l:void 0,r.visible=i.readBoolean();s.bones.push(r)}o=i.readInt(!0);for(let c=0;c<o;c++){let t=i.readString();if(!t)throw new Error("Slot name must not be null.");let e=s.bones[i.readInt(!0)],n=new oe(c,t,e);h.rgba8888ToColor(n.color,i.readInt32());let r=i.readInt32();-1!=r&&h.rgb888ToColor(n.darkColor=new h,r),n.attachmentName=i.readStringRef(),n.blendMode=i.readInt(!0),a&&(n.visible=i.readBoolean()),s.slots.push(n)}o=i.readInt(!0);for(let h,c=0;c<o;c++){let t=i.readString();if(!t)throw new Error("IK constraint data name must not be null.");let n=new Ht(t);n.order=i.readInt(!0),h=i.readInt(!0);for(let e=0;e<h;e++)n.bones.push(s.bones[i.readInt(!0)]);n.target=s.bones[i.readInt(!0)];let r=i.readByte();n.skinRequired=0!=(1&r),n.bendDirection=0!=(2&r)?1:-1,n.compress=0!=(4&r),n.stretch=0!=(8&r),n.uniform=0!=(16&r),0!=(32&r)&&(n.mix=0!=(64&r)?i.readFloat():1),0!=(128&r)&&(n.softness=i.readFloat()*e),s.ikConstraints.push(n)}o=i.readInt(!0);for(let h,c=0;c<o;c++){let t=i.readString();if(!t)throw new Error("Transform constraint data name must not be null.");let n=new he(t);n.order=i.readInt(!0),h=i.readInt(!0);for(let e=0;e<h;e++)n.bones.push(s.bones[i.readInt(!0)]);n.target=s.bones[i.readInt(!0)];let r=i.readByte();n.skinRequired=0!=(1&r),n.local=0!=(2&r),n.relative=0!=(4&r),0!=(8&r)&&(n.offsetRotation=i.readFloat()),0!=(16&r)&&(n.offsetX=i.readFloat()*e),0!=(32&r)&&(n.offsetY=i.readFloat()*e),0!=(64&r)&&(n.offsetScaleX=i.readFloat()),0!=(128&r)&&(n.offsetScaleY=i.readFloat()),r=i.readByte(),0!=(1&r)&&(n.offsetShearY=i.readFloat()),0!=(2&r)&&(n.mixRotate=i.readFloat()),0!=(4&r)&&(n.mixX=i.readFloat()),0!=(8&r)&&(n.mixY=i.readFloat()),0!=(16&r)&&(n.mixScaleX=i.readFloat()),0!=(32&r)&&(n.mixScaleY=i.readFloat()),0!=(64&r)&&(n.mixShearY=i.readFloat()),s.transformConstraints.push(n)}o=i.readInt(!0);for(let h,c=0;c<o;c++){let t=i.readString();if(!t)throw new Error("Path constraint data name must not be null.");let n=new Zt(t);n.order=i.readInt(!0),n.skinRequired=i.readBoolean(),h=i.readInt(!0);for(let e=0;e<h;e++)n.bones.push(s.bones[i.readInt(!0)]);n.target=s.slots[i.readInt(!0)];const r=i.readByte();n.positionMode=1&r,n.spacingMode=r>>1&3,n.rotateMode=r>>3&3,0!=(128&r)&&(n.offsetRotation=i.readFloat()),n.position=i.readFloat(),n.positionMode==St.Fixed&&(n.position*=e),n.spacing=i.readFloat(),n.spacingMode!=It.Length&&n.spacingMode!=It.Fixed||(n.spacing*=e),n.mixRotate=i.readFloat(),n.mixX=i.readFloat(),n.mixY=i.readFloat(),s.pathConstraints.push(n)}o=i.readInt(!0);for(let h=0;h<o;h++){const t=i.readString();if(!t)throw new Error("Physics constraint data name must not be null.");const n=new ie(t);n.order=i.readInt(!0),n.bone=s.bones[i.readInt(!0)];let r=i.readByte();n.skinRequired=0!=(1&r),0!=(2&r)&&(n.x=i.readFloat()),0!=(4&r)&&(n.y=i.readFloat()),0!=(8&r)&&(n.rotate=i.readFloat()),0!=(16&r)&&(n.scaleX=i.readFloat()),0!=(32&r)&&(n.shearX=i.readFloat()),n.limit=(0!=(64&r)?i.readFloat():5e3)*e,n.step=1/i.readUnsignedByte(),n.inertia=i.readFloat(),n.strength=i.readFloat(),n.damping=i.readFloat(),n.massInverse=0!=(128&r)?i.readFloat():1,n.wind=i.readFloat(),n.gravity=i.readFloat(),r=i.readByte(),0!=(1&r)&&(n.inertiaGlobal=!0),0!=(2&r)&&(n.strengthGlobal=!0),0!=(4&r)&&(n.dampingGlobal=!0),0!=(8&r)&&(n.massGlobal=!0),0!=(16&r)&&(n.windGlobal=!0),0!=(32&r)&&(n.gravityGlobal=!0),0!=(64&r)&&(n.mixGlobal=!0),n.mix=0!=(128&r)?i.readFloat():1,s.physicsConstraints.push(n)}let d=this.readSkin(i,s,!0,a);d&&(s.defaultSkin=d,s.skins.push(d));{let t=s.skins.length;for(c.setArraySize(s.skins,o=t+i.readInt(!0));t<o;t++){let e=this.readSkin(i,s,!1,a);if(!e)throw new Error("readSkin() should not have returned null.");s.skins[t]=e}}o=this.linkedMeshes.length;for(let h=0;h<o;h++){let t=this.linkedMeshes[h];const e=s.skins[t.skinIndex];if(!t.parent)throw new Error("Linked mesh parent must not be null");let i=e.getAttachment(t.slotIndex,t.parent);if(!i)throw new Error("Parent mesh not found: ".concat(t.parent));t.mesh.timelineAttachment=t.inheritTimeline?i:t.mesh,t.mesh.setParentMesh(i),null!=t.mesh.region&&t.mesh.updateRegion()}this.linkedMeshes.length=0,o=i.readInt(!0);for(let h=0;h<o;h++){let t=i.readString();if(!t)throw new Error("Event data name must not be null");let e=new se(t);e.intValue=i.readInt(!1),e.floatValue=i.readFloat(),e.stringValue=i.readString(),e.audioPath=i.readString(),e.audioPath&&(e.volume=i.readFloat(),e.balance=i.readFloat()),s.events.push(e)}o=i.readInt(!0);for(let h=0;h<o;h++){let t=i.readString();if(!t)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(i,t,s))}return s}readSkin(t,e,s,i){let n=null,r=0;if(s){if(r=t.readInt(!0),0==r)return null;n=new ae("default")}else{let s=t.readString();if(!s)throw new Error("Skin name must not be null.");n=new ae(s),i&&h.rgba8888ToColor(n.color,t.readInt32()),n.bones.length=t.readInt(!0);for(let i=0,r=n.bones.length;i<r;i++)n.bones[i]=e.bones[t.readInt(!0)];for(let i=0,r=t.readInt(!0);i<r;i++)n.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let i=0,r=t.readInt(!0);i<r;i++)n.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let i=0,r=t.readInt(!0);i<r;i++)n.constraints.push(e.pathConstraints[t.readInt(!0)]);for(let i=0,r=t.readInt(!0);i<r;i++)n.constraints.push(e.physicsConstraints[t.readInt(!0)]);r=t.readInt(!0)}for(let a=0;a<r;a++){let s=t.readInt(!0);for(let r=0,a=t.readInt(!0);r<a;r++){let r=t.readStringRef();if(!r)throw new Error("Attachment name must not be null");let a=this.readAttachment(t,e,n,s,r,i);a&&n.setAttachment(s,r,a)}}return n}readAttachment(t,e,s,i,n,r){let a=this.scale,o=t.readByte();const l=0!=(8&o)?t.readStringRef():n;if(!l)throw new Error("Attachment name must not be null");switch(7&o){case Rt.Region:{let e=0!=(16&o)?t.readStringRef():null;const i=0!=(32&o)?t.readInt32():4294967295,n=0!=(64&o)?this.readSequence(t):null;let r=0!=(128&o)?t.readFloat():0,c=t.readFloat(),d=t.readFloat(),u=t.readFloat(),m=t.readFloat(),p=t.readFloat(),g=t.readFloat();e||(e=l);let f=this.attachmentLoader.newRegionAttachment(s,l,e,n);return f?(f.path=e,f.x=c*a,f.y=d*a,f.scaleX=u,f.scaleY=m,f.rotation=r,f.width=p*a,f.height=g*a,h.rgba8888ToColor(f.color,i),f.sequence=n,null==n&&f.updateRegion(),f):null}case Rt.BoundingBox:{let e=this.readVertices(t,0!=(16&o)),i=r?t.readInt32():0,n=this.attachmentLoader.newBoundingBoxAttachment(s,l);return n?(n.worldVerticesLength=e.length,n.vertices=e.vertices,n.bones=e.bones,r&&h.rgba8888ToColor(n.color,i),n):null}case Rt.Mesh:{let e=0!=(16&o)?t.readStringRef():l;const i=0!=(32&o)?t.readInt32():4294967295,n=0!=(64&o)?this.readSequence(t):null,c=t.readInt(!0),d=this.readVertices(t,0!=(128&o)),u=this.readFloatArray(t,d.length,1),m=this.readShortArray(t,3*(d.length-c-2));let p=[],g=0,f=0;r&&(p=this.readShortArray(t,t.readInt(!0)),g=t.readFloat(),f=t.readFloat()),e||(e=l);let w=this.attachmentLoader.newMeshAttachment(s,l,e,n);return w?(w.path=e,h.rgba8888ToColor(w.color,i),w.bones=d.bones,w.vertices=d.vertices,w.worldVerticesLength=d.length,w.triangles=m,w.regionUVs=u,null==n&&w.updateRegion(),w.hullLength=c<<1,w.sequence=n,r&&(w.edges=p,w.width=g*a,w.height=f*a),w):null}case Rt.LinkedMesh:{const e=0!=(16&o)?t.readStringRef():l;if(null==e)throw new Error("Path of linked mesh must not be null");const n=0!=(32&o)?t.readInt32():4294967295,c=0!=(64&o)?this.readSequence(t):null,d=0!=(128&o),u=t.readInt(!0),m=t.readStringRef();let p=0,g=0;r&&(p=t.readFloat(),g=t.readFloat());let f=this.attachmentLoader.newMeshAttachment(s,l,e,c);return f?(f.path=e,h.rgba8888ToColor(f.color,n),f.sequence=c,r&&(f.width=p*a,f.height=g*a),this.linkedMeshes.push(new de(f,u,i,m,d)),f):null}case Rt.Path:{const e=0!=(16&o),i=0!=(32&o),n=this.readVertices(t,0!=(64&o)),d=c.newArray(n.length/6,0);for(let s=0,r=d.length;s<r;s++)d[s]=t.readFloat()*a;const u=r?t.readInt32():0,m=this.attachmentLoader.newPathAttachment(s,l);return m?(m.closed=e,m.constantSpeed=i,m.worldVerticesLength=n.length,m.vertices=n.vertices,m.bones=n.bones,m.lengths=d,r&&h.rgba8888ToColor(m.color,u),m):null}case Rt.Point:{const e=t.readFloat(),i=t.readFloat(),n=t.readFloat(),o=r?t.readInt32():0,c=this.attachmentLoader.newPointAttachment(s,l);return c?(c.x=i*a,c.y=n*a,c.rotation=e,r&&h.rgba8888ToColor(c.color,o),c):null}case Rt.Clipping:{const i=t.readInt(!0),n=this.readVertices(t,0!=(16&o));let a=r?t.readInt32():0,c=this.attachmentLoader.newClippingAttachment(s,l);return c?(c.endSlot=e.slots[i],c.worldVerticesLength=n.length,c.vertices=n.vertices,c.bones=n.bones,r&&h.rgba8888ToColor(c.color,a),c):null}}return null}readSequence(t){let e=new f(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readVertices(t,e){const s=this.scale,i=t.readInt(!0),n=new ue;if(n.length=i<<1,!e)return n.vertices=this.readFloatArray(t,n.length,s),n;let r=new Array,a=new Array;for(let o=0;o<i;o++){let e=t.readInt(!0);a.push(e);for(let i=0;i<e;i++)a.push(t.readInt(!0)),r.push(t.readFloat()*s),r.push(t.readFloat()*s),r.push(t.readFloat())}return n.vertices=c.toFloatArray(r),n.bones=a,n}readFloatArray(t,e,s){let i=new Array(e);if(1==s)for(let n=0;n<e;n++)i[n]=t.readFloat();else for(let n=0;n<e;n++)i[n]=t.readFloat()*s;return i}readShortArray(t,e){let s=new Array(e);for(let i=0;i<e;i++)s[i]=t.readInt(!0);return s}readAnimation(t,e,s){t.readInt(!0);let i=new Array,n=this.scale;for(let h=0,l=t.readInt(!0);h<l;h++){let e=t.readInt(!0);for(let s=0,n=t.readInt(!0);s<n;s++){let s=t.readByte(),n=t.readInt(!0),r=n-1;switch(s){case Ee:{let s=new W(n,e);for(let e=0;e<n;e++)s.setFrame(e,t.readFloat(),t.readStringRef());i.push(s);break}case Te:{let s=t.readInt(!0),a=new V(n,s,e),o=t.readFloat(),h=t.readUnsignedByte()/255,l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255;for(let e=0,i=0;a.setFrame(e,o,h,l,c,d),e!=r;e++){let s=t.readFloat(),n=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255;switch(t.readByte()){case _e:a.setStepped(e);break;case je:ge(t,a,i++,e,0,o,s,h,n,1),ge(t,a,i++,e,1,o,s,l,r,1),ge(t,a,i++,e,2,o,s,c,u,1),ge(t,a,i++,e,3,o,s,d,m,1)}o=s,h=n,l=r,c=u,d=m}i.push(a);break}case Me:{let s=t.readInt(!0),a=new D(n,s,e),o=t.readFloat(),h=t.readUnsignedByte()/255,l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255;for(let e=0,i=0;a.setFrame(e,o,h,l,c),e!=r;e++){let s=t.readFloat(),n=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255;switch(t.readByte()){case _e:a.setStepped(e);break;case je:ge(t,a,i++,e,0,o,s,h,n,1),ge(t,a,i++,e,1,o,s,l,r,1),ge(t,a,i++,e,2,o,s,c,d,1)}o=s,h=n,l=r,c=d}i.push(a);break}case Re:{let s=t.readInt(!0),a=new N(n,s,e),o=t.readFloat(),h=t.readUnsignedByte()/255,l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255;for(let e=0,i=0;a.setFrame(e,o,h,l,c,d,u,m,p),e!=r;e++){let s=t.readFloat(),n=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255;switch(t.readByte()){case _e:a.setStepped(e);break;case je:ge(t,a,i++,e,0,o,s,h,n,1),ge(t,a,i++,e,1,o,s,l,r,1),ge(t,a,i++,e,2,o,s,c,g,1),ge(t,a,i++,e,3,o,s,d,f,1),ge(t,a,i++,e,4,o,s,u,w,1),ge(t,a,i++,e,5,o,s,m,A,1),ge(t,a,i++,e,6,o,s,p,x,1)}o=s,h=n,l=r,c=g,d=f,u=w,m=A,p=x}i.push(a);break}case Fe:{let s=t.readInt(!0),a=new U(n,s,e),o=t.readFloat(),h=t.readUnsignedByte()/255,l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255;for(let e=0,i=0;a.setFrame(e,o,h,l,c,d,u,m),e!=r;e++){let s=t.readFloat(),n=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255;switch(t.readByte()){case _e:a.setStepped(e);break;case je:ge(t,a,i++,e,0,o,s,h,n,1),ge(t,a,i++,e,1,o,s,l,r,1),ge(t,a,i++,e,2,o,s,c,p,1),ge(t,a,i++,e,3,o,s,d,g,1),ge(t,a,i++,e,4,o,s,u,f,1),ge(t,a,i++,e,5,o,s,m,w,1)}o=s,h=n,l=r,c=p,d=g,u=f,m=w}i.push(a);break}case Ye:{let s=new O(n,t.readInt(!0),e),a=t.readFloat(),o=t.readUnsignedByte()/255;for(let e=0,i=0;s.setFrame(e,a,o),e!=r;e++){let n=t.readFloat(),r=t.readUnsignedByte()/255;switch(t.readByte()){case _e:s.setStepped(e);break;case je:ge(t,s,i++,e,0,a,n,o,r,1)}a=n,o=r}i.push(s)}}}}for(let h=0,l=t.readInt(!0);h<l;h++){let e=t.readInt(!0);for(let s=0,r=t.readInt(!0);s<r;s++){let s=t.readByte(),r=t.readInt(!0);if(s==Ie){let s=new P(r,e);for(let e=0;e<r;e++)s.setFrame(e,t.readFloat(),t.readByte());i.push(s);continue}let a=t.readInt(!0);switch(s){case fe:i.push(me(t,new I(r,a,e),1));break;case we:i.push(pe(t,new E(r,a,e),n));break;case Ae:i.push(me(t,new T(r,a,e),n));break;case xe:i.push(me(t,new M(r,a,e),n));break;case be:i.push(pe(t,new R(r,a,e),1));break;case ve:i.push(me(t,new F(r,a,e),1));break;case ye:i.push(me(t,new Y(r,a,e),1));break;case ke:i.push(pe(t,new L(r,a,e),1));break;case Ce:i.push(me(t,new B(r,a,e),1));break;case Se:i.push(me(t,new X(r,a,e),1))}}}for(let h=0,l=t.readInt(!0);h<l;h++){let e=t.readInt(!0),s=t.readInt(!0),r=s-1,a=new _(s,t.readInt(!0),e),o=t.readByte(),h=t.readFloat(),l=0!=(1&o)?0!=(2&o)?t.readFloat():1:0,c=0!=(4&o)?t.readFloat()*n:0;for(let i=0,d=0;a.setFrame(i,h,l,c,0!=(8&o)?1:-1,0!=(16&o),0!=(32&o)),i!=r;i++){o=t.readByte();const e=t.readFloat(),s=0!=(1&o)?0!=(2&o)?t.readFloat():1:0,r=0!=(4&o)?t.readFloat()*n:0;0!=(64&o)?a.setStepped(i):0!=(128&o)&&(ge(t,a,d++,i,0,h,e,l,s,1),ge(t,a,d++,i,1,h,e,c,r,n)),h=e,l=s,c=r}i.push(a)}for(let h=0,l=t.readInt(!0);h<l;h++){let e=t.readInt(!0),s=t.readInt(!0),n=s-1,r=new j(s,t.readInt(!0),e),a=t.readFloat(),o=t.readFloat(),h=t.readFloat(),l=t.readFloat(),c=t.readFloat(),d=t.readFloat(),u=t.readFloat();for(let i=0,m=0;r.setFrame(i,a,o,h,l,c,d,u),i!=n;i++){let e=t.readFloat(),s=t.readFloat(),n=t.readFloat(),p=t.readFloat(),g=t.readFloat(),f=t.readFloat(),w=t.readFloat();switch(t.readByte()){case _e:r.setStepped(i);break;case je:ge(t,r,m++,i,0,a,e,o,s,1),ge(t,r,m++,i,1,a,e,h,n,1),ge(t,r,m++,i,2,a,e,l,p,1),ge(t,r,m++,i,3,a,e,c,g,1),ge(t,r,m++,i,4,a,e,d,f,1),ge(t,r,m++,i,5,a,e,u,w,1)}a=e,o=s,h=n,l=p,c=g,d=f,u=w}i.push(r)}for(let h=0,l=t.readInt(!0);h<l;h++){let e=t.readInt(!0),r=s.pathConstraints[e];for(let s=0,a=t.readInt(!0);s<a;s++){const s=t.readByte(),a=t.readInt(!0),o=t.readInt(!0);switch(s){case Xe:i.push(me(t,new H(a,o,e),r.positionMode==St.Fixed?n:1));break;case Pe:i.push(me(t,new Z(a,o,e),r.spacingMode==It.Length||r.spacingMode==It.Fixed?n:1));break;case Ve:let s=new J(a,o,e),h=t.readFloat(),l=t.readFloat(),c=t.readFloat(),d=t.readFloat();for(let e=0,i=0,n=s.getFrameCount()-1;s.setFrame(e,h,l,c,d),e!=n;e++){let n=t.readFloat(),r=t.readFloat(),a=t.readFloat(),o=t.readFloat();switch(t.readByte()){case _e:s.setStepped(e);break;case je:ge(t,s,i++,e,0,h,n,l,r,1),ge(t,s,i++,e,1,h,n,c,a,1),ge(t,s,i++,e,2,h,n,d,o,1)}h=n,l=r,c=a,d=o}i.push(s)}}}for(let h=0,l=t.readInt(!0);h<l;h++){const e=t.readInt(!0)-1;for(let s=0,n=t.readInt(!0);s<n;s++){const s=t.readByte(),n=t.readInt(!0);if(s==Ge){const s=new rt(n,e);for(let e=0;e<n;e++)s.setFrame(e,t.readFloat());i.push(s);continue}const r=t.readInt(!0);switch(s){case De:i.push(me(t,new Q(n,r,e),1));break;case Oe:i.push(me(t,new $(n,r,e),1));break;case Ne:i.push(me(t,new tt(n,r,e),1));break;case Ue:i.push(me(t,new et(n,r,e),1));break;case We:i.push(me(t,new st(n,r,e),1));break;case ze:i.push(me(t,new it(n,r,e),1));break;case qe:i.push(me(t,new nt(n,r,e),1))}}}for(let h=0,l=t.readInt(!0);h<l;h++){let e=s.skins[t.readInt(!0)];for(let s=0,r=t.readInt(!0);s<r;s++){let s=t.readInt(!0);for(let r=0,a=t.readInt(!0);r<a;r++){let r=t.readStringRef();if(!r)throw new Error("attachmentName must not be null.");let a=e.getAttachment(s,r),o=t.readByte(),h=t.readInt(!0),l=h-1;switch(o){case Le:{let e=a,r=e.bones,o=e.vertices,d=r?o.length/3*2:o.length,u=t.readInt(!0),m=new z(h,u,s,e),p=t.readFloat();for(let s=0,i=0;;s++){let e,a=t.readInt(!0);if(0==a)e=r?c.newFloatArray(d):o;else{e=c.newFloatArray(d);let s=t.readInt(!0);if(a+=s,1==n)for(let i=s;i<a;i++)e[i]=t.readFloat();else for(let i=s;i<a;i++)e[i]=t.readFloat()*n;if(!r)for(let t=0,i=e.length;t<i;t++)e[t]+=o[t]}if(m.setFrame(s,p,e),s==l)break;let h=t.readFloat();switch(t.readByte()){case _e:m.setStepped(s);break;case je:ge(t,m,i++,s,0,p,h,0,1,1)}p=h}i.push(m);break}case Be:{let e=new at(h,s,a);for(let s=0;s<h;s++){let i=t.readFloat(),n=t.readInt32();e.setFrame(s,i,w[15&n],n>>4,t.readFloat())}i.push(e);break}}}}}let r=t.readInt(!0);if(r>0){let e=new G(r),n=s.slots.length;for(let s=0;s<r;s++){let i=t.readFloat(),r=t.readInt(!0),a=c.newArray(n,0);for(let t=n-1;t>=0;t--)a[t]=-1;let o=c.newArray(n-r,0),h=0,l=0;for(let e=0;e<r;e++){let e=t.readInt(!0);for(;h!=e;)o[l++]=h++;a[h+t.readInt(!0)]=h++}for(;h<n;)o[l++]=h++;for(let t=n-1;t>=0;t--)-1==a[t]&&(a[t]=o[--l]);e.setFrame(s,i,a)}i.push(e)}let a=t.readInt(!0);if(a>0){let e=new q(a);for(let i=0;i<a;i++){let n=t.readFloat(),r=s.events[t.readInt(!0)],a=new ee(n,r);a.intValue=t.readInt(!1),a.floatValue=t.readFloat(),a.stringValue=t.readString(),null==a.stringValue&&(a.stringValue=r.stringValue),a.data.audioPath&&(a.volume=t.readFloat(),a.balance=t.readFloat()),e.setFrame(i,a)}i.push(e)}let o=0;for(let h=0,l=i.length;h<l;h++)o=Math.max(o,i[h].getDuration());return new A(e,i,o)}}class ce{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new DataView(t instanceof ArrayBuffer?t:t.buffer);(0,a.A)(this,"strings",void 0),(0,a.A)(this,"index",void 0),(0,a.A)(this,"buffer",void 0),this.strings=e,this.index=s,this.buffer=i}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){let t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),s=127&e;return 0!=(128&e)&&(e=this.readByte(),s|=(127&e)<<7,0!=(128&e)&&(e=this.readByte(),s|=(127&e)<<14,0!=(128&e)&&(e=this.readByte(),s|=(127&e)<<21,0!=(128&e)&&(e=this.readByte(),s|=(127&e)<<28)))),t?s:s>>>1^-(1&s)}readStringRef(){let t=this.readInt(!0);return 0==t?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let s=0;s<t;){let t=this.readUnsignedByte();switch(t>>4){case 12:case 13:e+=String.fromCharCode((31&t)<<6|63&this.readByte()),s+=2;break;case 14:e+=String.fromCharCode((15&t)<<12|(63&this.readByte())<<6|63&this.readByte()),s+=3;break;default:e+=String.fromCharCode(t),s++}}return e}readFloat(){let t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return 0!=this.readByte()}}class de{constructor(t,e,s,i,n){(0,a.A)(this,"parent",void 0),(0,a.A)(this,"skinIndex",void 0),(0,a.A)(this,"slotIndex",void 0),(0,a.A)(this,"mesh",void 0),(0,a.A)(this,"inheritTimeline",void 0),this.mesh=t,this.skinIndex=e,this.slotIndex=s,this.parent=i,this.inheritTimeline=n}}class ue{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,a.A)(this,"bones",void 0),(0,a.A)(this,"vertices",void 0),(0,a.A)(this,"length",void 0),this.bones=t,this.vertices=e,this.length=s}}function me(t,e,s){let i=t.readFloat(),n=t.readFloat()*s;for(let r=0,a=0,o=e.getFrameCount()-1;e.setFrame(r,i,n),r!=o;r++){let o=t.readFloat(),h=t.readFloat()*s;switch(t.readByte()){case _e:e.setStepped(r);break;case je:ge(t,e,a++,r,0,i,o,n,h,s)}i=o,n=h}return e}function pe(t,e,s){let i=t.readFloat(),n=t.readFloat()*s,r=t.readFloat()*s;for(let a=0,o=0,h=e.getFrameCount()-1;e.setFrame(a,i,n,r),a!=h;a++){let h=t.readFloat(),l=t.readFloat()*s,c=t.readFloat()*s;switch(t.readByte()){case _e:e.setStepped(a);break;case je:ge(t,e,o++,a,0,i,h,n,l,s),ge(t,e,o++,a,1,i,h,r,c,s)}i=h,n=l,r=c}return e}function ge(t,e,s,i,n,r,a,o,h,l){e.setBezier(s,i,n,r,o,t.readFloat(),t.readFloat()*l,t.readFloat(),t.readFloat()*l,a,h)}!function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping"}(Rt||(Rt={}));const fe=0,we=1,Ae=2,xe=3,be=4,ve=5,ye=6,ke=7,Ce=8,Se=9,Ie=10,Ee=0,Te=1,Me=2,Re=3,Fe=4,Ye=5,Le=0,Be=1,Xe=0,Pe=1,Ve=2,De=0,Oe=1,Ne=2,Ue=4,We=5,ze=6,qe=7,Ge=8,_e=1,je=2;class He{constructor(){(0,a.A)(this,"minX",0),(0,a.A)(this,"minY",0),(0,a.A)(this,"maxX",0),(0,a.A)(this,"maxY",0),(0,a.A)(this,"boundingBoxes",new Array),(0,a.A)(this,"polygons",new Array),(0,a.A)(this,"polygonPool",new d(()=>c.newFloatArray(16)))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");let s=this.boundingBoxes,i=this.polygons,n=this.polygonPool,r=t.slots,a=r.length;s.length=0,n.freeAll(i),i.length=0;for(let o=0;o<a;o++){let t=r[o];if(!t.bone.active)continue;let e=t.getAttachment();if(e instanceof xt){let r=e;s.push(r);let a=n.obtain();a.length!=r.worldVerticesLength&&(a=c.newFloatArray(r.worldVerticesLength)),i.push(a),r.computeWorldVertices(t,0,r.worldVerticesLength,a,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=this.polygons;for(let r=0,a=n.length;r<a;r++){let a=n[r],o=a;for(let n=0,r=a.length;n<r;n+=2){let r=o[n],a=o[n+1];t=Math.min(t,r),e=Math.min(e,a),s=Math.max(s,r),i=Math.max(i,a)}}this.minX=t,this.minY=e,this.maxX=s,this.maxY=i}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,s,i){let n=this.minX,r=this.minY,a=this.maxX,o=this.maxY;if(t<=n&&s<=n||e<=r&&i<=r||t>=a&&s>=a||e>=o&&i>=o)return!1;let h=(i-e)/(s-t),l=h*(n-t)+e;if(l>r&&l<o)return!0;if(l=h*(a-t)+e,l>r&&l<o)return!0;let c=(r-e)/h+t;return c>n&&c<a||(c=(o-e)/h+t,c>n&&c<a)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let s=this.polygons;for(let i=0,n=s.length;i<n;i++)if(this.containsPointPolygon(s[i],t,e))return this.boundingBoxes[i];return null}containsPointPolygon(t,e,s){let i=t,n=t.length,r=n-2,a=!1;for(let o=0;o<n;o+=2){let t=i[o+1],n=i[r+1];if(t<s&&n>=s||n<s&&t>=s){let h=i[o];h+(s-t)/(n-t)*(i[r]-h)<e&&(a=!a)}r=o}return a}intersectsSegment(t,e,s,i){let n=this.polygons;for(let r=0,a=n.length;r<a;r++)if(this.intersectsSegmentPolygon(n[r],t,e,s,i))return this.boundingBoxes[r];return null}intersectsSegmentPolygon(t,e,s,i,n){let r=t,a=t.length,o=e-i,h=s-n,l=e*n-s*i,c=r[a-2],d=r[a-1];for(let u=0;u<a;u+=2){let t=r[u],a=r[u+1],m=c*a-d*t,p=c-t,g=d-a,f=o*g-h*p,w=(l*p-o*m)/f;if((w>=c&&w<=t||w>=t&&w<=c)&&(w>=e&&w<=i||w>=i&&w<=e)){let t=(l*g-h*m)/f;if((t>=d&&t<=a||t>=a&&t<=d)&&(t>=s&&t<=n||t>=n&&t<=s))return!0}c=t,d=a}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class Ze{constructor(){(0,a.A)(this,"convexPolygons",new Array),(0,a.A)(this,"convexPolygonsIndices",new Array),(0,a.A)(this,"indicesArray",new Array),(0,a.A)(this,"isConcaveArray",new Array),(0,a.A)(this,"triangles",new Array),(0,a.A)(this,"polygonPool",new d(()=>new Array)),(0,a.A)(this,"polygonIndicesPool",new d(()=>new Array))}triangulate(t){let e=t,s=t.length>>1,i=this.indicesArray;i.length=0;for(let a=0;a<s;a++)i[a]=a;let n=this.isConcaveArray;n.length=0;for(let a=0,o=s;a<o;++a)n[a]=Ze.isConcave(a,s,e,i);let r=this.triangles;for(r.length=0;s>3;){let t=s-1,a=0,o=1;for(;;){t:if(!n[a]){let r=i[t]<<1,h=i[a]<<1,l=i[o]<<1,c=e[r],d=e[r+1],u=e[h],m=e[h+1],p=e[l],g=e[l+1];for(let a=(o+1)%s;a!=t;a=(a+1)%s){if(!n[a])continue;let t=i[a]<<1,s=e[t],r=e[t+1];if(Ze.positiveArea(p,g,c,d,s,r)&&Ze.positiveArea(c,d,u,m,s,r)&&Ze.positiveArea(u,m,p,g,s,r))break t}break}if(0==o){do{if(!n[a])break;a--}while(a>0);break}t=a,a=o,o=(o+1)%s}r.push(i[(s+a-1)%s]),r.push(i[a]),r.push(i[(a+1)%s]),i.splice(a,1),n.splice(a,1),s--;let h=(s+a-1)%s,l=a==s?0:a;n[h]=Ze.isConcave(h,s,e,i),n[l]=Ze.isConcave(l,s,e,i)}return 3==s&&(r.push(i[2]),r.push(i[0]),r.push(i[1])),r}decompose(t,e){let s=t,i=this.convexPolygons;this.polygonPool.freeAll(i),i.length=0;let n=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(n),n.length=0;let r=this.polygonIndicesPool.obtain();r.length=0;let a=this.polygonPool.obtain();a.length=0;let o=-1,h=0;for(let l=0,c=e.length;l<c;l+=3){let t=e[l]<<1,c=e[l+1]<<1,d=e[l+2]<<1,u=s[t],m=s[t+1],p=s[c],g=s[c+1],f=s[d],w=s[d+1],A=!1;if(o==t){let t=a.length-4,e=Ze.winding(a[t],a[t+1],a[t+2],a[t+3],f,w),s=Ze.winding(f,w,a[0],a[1],a[2],a[3]);e==h&&s==h&&(a.push(f),a.push(w),r.push(d),A=!0)}A||(a.length>0?(i.push(a),n.push(r)):(this.polygonPool.free(a),this.polygonIndicesPool.free(r)),a=this.polygonPool.obtain(),a.length=0,a.push(u),a.push(m),a.push(p),a.push(g),a.push(f),a.push(w),r=this.polygonIndicesPool.obtain(),r.length=0,r.push(t),r.push(c),r.push(d),h=Ze.winding(u,m,p,g,f,w),o=t)}a.length>0&&(i.push(a),n.push(r));for(let l=0,c=i.length;l<c;l++){if(r=n[l],0==r.length)continue;let t=r[0],e=r[r.length-1];a=i[l];let s=a.length-4,o=a[s],h=a[s+1],d=a[s+2],u=a[s+3],m=a[0],p=a[1],g=a[2],f=a[3],w=Ze.winding(o,h,d,u,m,p);for(let A=0;A<c;A++){if(A==l)continue;let s=n[A];if(3!=s.length)continue;let c=s[0],x=s[1],b=s[2],v=i[A],y=v[v.length-2],k=v[v.length-1];if(c!=t||x!=e)continue;let C=Ze.winding(o,h,d,u,y,k),S=Ze.winding(y,k,m,p,g,f);C==w&&S==w&&(v.length=0,s.length=0,a.push(y),a.push(k),r.push(b),o=d,h=u,d=y,u=k,A=0)}}for(let l=i.length-1;l>=0;l--)a=i[l],0==a.length&&(i.splice(l,1),this.polygonPool.free(a),r=n[l],n.splice(l,1),this.polygonIndicesPool.free(r));return i}static isConcave(t,e,s,i){let n=i[(e+t-1)%e]<<1,r=i[t]<<1,a=i[(t+1)%e]<<1;return!this.positiveArea(s[n],s[n+1],s[r],s[r+1],s[a],s[a+1])}static positiveArea(t,e,s,i,n,r){return t*(r-i)+s*(e-r)+n*(i-e)>=0}static winding(t,e,s,i,n,r){let a=s-t,o=i-e;return n*o-r*a+a*e-t*o>=0?1:-1}}class Je{constructor(){(0,a.A)(this,"triangulator",new Ze),(0,a.A)(this,"clippingPolygon",new Array),(0,a.A)(this,"clipOutput",new Array),(0,a.A)(this,"clippedVertices",new Array),(0,a.A)(this,"clippedUVs",new Array),(0,a.A)(this,"clippedTriangles",new Array),(0,a.A)(this,"scratch",new Array),(0,a.A)(this,"clipAttachment",null),(0,a.A)(this,"clippingPolygons",null)}clipStart(t,e){if(this.clipAttachment)return 0;this.clipAttachment=e;let s=e.worldVerticesLength,i=c.setArraySize(this.clippingPolygon,s);e.computeWorldVertices(t,0,s,i,0,2);let n=this.clippingPolygon;Je.makeClockwise(n);let r=this.clippingPolygons=this.triangulator.decompose(n,this.triangulator.triangulate(n));for(let a=0,o=r.length;a<o;a++){let t=r[a];Je.makeClockwise(t),t.push(t[0]),t.push(t[1])}return r.length}clipEndWithSlot(t){this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(t,e,s,i,n,r,a,o){let h,l,c,d,u,m;"number"===typeof e?(h=s,l=i,c=n,d=r,u=a,m=o):(h=e,l=s,c=i,d=n,u=r,m=a),c&&d&&u&&"boolean"===typeof m?this.clipTrianglesRender(t,h,l,c,d,u,m):this.clipTrianglesNoRender(t,h,l)}clipTrianglesNoRender(t,e,s){let i=this.clipOutput,n=this.clippedVertices,r=this.clippedTriangles,a=this.clippingPolygons,o=a.length,h=0;n.length=0,r.length=0;for(let l=0;l<s;l+=3){let s=e[l]<<1,d=t[s],u=t[s+1];s=e[l+1]<<1;let m=t[s],p=t[s+1];s=e[l+2]<<1;let g=t[s],f=t[s+1];for(let t=0;t<o;t++){let e=n.length;if(!this.clip(d,u,m,p,g,f,a[t],i)){let t=c.setArraySize(n,e+6);t[e]=d,t[e+1]=u,t[e+2]=m,t[e+3]=p,t[e+4]=g,t[e+5]=f,e=r.length;let s=c.setArraySize(r,e+3);s[e]=h,s[e+1]=h+1,s[e+2]=h+2,h+=3;break}{let t=i.length;if(0==t)continue;let s=t>>1,a=this.clipOutput,o=c.setArraySize(n,e+2*s);for(let i=0;i<t;i+=2,e+=2){let t=a[i],s=a[i+1];o[e]=t,o[e+1]=s}e=r.length;let l=c.setArraySize(r,e+3*(s-2));s--;for(let i=1;i<s;i++,e+=3)l[e]=h,l[e+1]=h+i,l[e+2]=h+i+1;h+=s+1}}}}clipTrianglesRender(t,e,s,i,n,r,a){let o=this.clipOutput,h=this.clippedVertices,l=this.clippedTriangles,d=this.clippingPolygons,u=d.length,m=a?12:8,p=0;h.length=0,l.length=0;for(let g=0;g<s;g+=3){let s=e[g]<<1,f=t[s],w=t[s+1],A=i[s],x=i[s+1];s=e[g+1]<<1;let b=t[s],v=t[s+1],y=i[s],k=i[s+1];s=e[g+2]<<1;let C=t[s],S=t[s+1],I=i[s],E=i[s+1];for(let t=0;t<u;t++){let e=h.length;if(!this.clip(f,w,b,v,C,S,d[t],o)){let t=c.setArraySize(h,e+3*m);t[e]=f,t[e+1]=w,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,a?(t[e+6]=A,t[e+7]=x,t[e+8]=r.r,t[e+9]=r.g,t[e+10]=r.b,t[e+11]=r.a,t[e+12]=b,t[e+13]=v,t[e+14]=n.r,t[e+15]=n.g,t[e+16]=n.b,t[e+17]=n.a,t[e+18]=y,t[e+19]=k,t[e+20]=r.r,t[e+21]=r.g,t[e+22]=r.b,t[e+23]=r.a,t[e+24]=C,t[e+25]=S,t[e+26]=n.r,t[e+27]=n.g,t[e+28]=n.b,t[e+29]=n.a,t[e+30]=I,t[e+31]=E,t[e+32]=r.r,t[e+33]=r.g,t[e+34]=r.b,t[e+35]=r.a):(t[e+6]=A,t[e+7]=x,t[e+8]=b,t[e+9]=v,t[e+10]=n.r,t[e+11]=n.g,t[e+12]=n.b,t[e+13]=n.a,t[e+14]=y,t[e+15]=k,t[e+16]=C,t[e+17]=S,t[e+18]=n.r,t[e+19]=n.g,t[e+20]=n.b,t[e+21]=n.a,t[e+22]=I,t[e+23]=E),e=l.length;let s=c.setArraySize(l,e+3);s[e]=p,s[e+1]=p+1,s[e+2]=p+2,p+=3;break}{let t=o.length;if(0==t)continue;let s=v-S,i=C-b,d=f-C,u=S-w,g=1/(s*d+i*(w-S)),T=t>>1,M=this.clipOutput,R=c.setArraySize(h,e+T*m);for(let o=0;o<t;o+=2,e+=m){let t=M[o],h=M[o+1];R[e]=t,R[e+1]=h,R[e+2]=n.r,R[e+3]=n.g,R[e+4]=n.b,R[e+5]=n.a;let l=t-C,c=h-S,m=(s*l+i*c)*g,p=(u*l+d*c)*g,f=1-m-p;R[e+6]=A*m+y*p+I*f,R[e+7]=x*m+k*p+E*f,a&&(R[e+8]=r.r,R[e+9]=r.g,R[e+10]=r.b,R[e+11]=r.a)}e=l.length;let F=c.setArraySize(l,e+3*(T-2));T--;for(let n=1;n<T;n++,e+=3)F[e]=p,F[e+1]=p+n,F[e+2]=p+n+1;p+=T+1}}}}clipTrianglesUnpacked(t,e,s,i){let n=this.clipOutput,r=this.clippedVertices,a=this.clippedUVs,o=this.clippedTriangles,h=this.clippingPolygons,l=h.length,d=0;r.length=0,a.length=0,o.length=0;for(let u=0;u<s;u+=3){let s=e[u]<<1,m=t[s],p=t[s+1],g=i[s],f=i[s+1];s=e[u+1]<<1;let w=t[s],A=t[s+1],x=i[s],b=i[s+1];s=e[u+2]<<1;let v=t[s],y=t[s+1],k=i[s],C=i[s+1];for(let t=0;t<l;t++){let e=r.length;if(!this.clip(m,p,w,A,v,y,h[t],n)){let t=c.setArraySize(r,e+6);t[e]=m,t[e+1]=p,t[e+2]=w,t[e+3]=A,t[e+4]=v,t[e+5]=y;let s=c.setArraySize(a,e+6);s[e]=g,s[e+1]=f,s[e+2]=x,s[e+3]=b,s[e+4]=k,s[e+5]=C,e=o.length;let i=c.setArraySize(o,e+3);i[e]=d,i[e+1]=d+1,i[e+2]=d+2,d+=3;break}{let t=n.length;if(0==t)continue;let s=A-y,i=v-w,h=m-v,l=y-p,u=1/(s*h+i*(p-y)),S=t>>1,I=this.clipOutput,E=c.setArraySize(r,e+2*S),T=c.setArraySize(a,e+2*S);for(let n=0;n<t;n+=2,e+=2){let t=I[n],r=I[n+1];E[e]=t,E[e+1]=r;let a=t-v,o=r-y,c=(s*a+i*o)*u,d=(l*a+h*o)*u,m=1-c-d;T[e]=g*c+x*d+k*m,T[e+1]=f*c+b*d+C*m}e=o.length;let M=c.setArraySize(o,e+3*(S-2));S--;for(let n=1;n<S;n++,e+=3)M[e]=d,M[e+1]=d+n,M[e+2]=d+n+1;d+=S+1}}}}clip(t,e,s,i,n,r,a,o){let h,l=o,c=!1;a.length%4>=2?(h=o,o=this.scratch):h=this.scratch,h.length=0,h.push(t),h.push(e),h.push(s),h.push(i),h.push(n),h.push(r),h.push(t),h.push(e),o.length=0;let d=a.length-4,u=a;for(let m=0;;m+=2){let t=u[m],e=u[m+1],s=t-u[m+2],i=e-u[m+3],n=o.length,r=h;for(let l=0,d=h.length-2;l<d;){let n=r[l],a=r[l+1];l+=2;let h=r[l],d=r[l+1],u=i*(t-h)>s*(e-d),m=i*(t-n)-s*(e-a);if(m>0){if(u){o.push(h),o.push(d);continue}let t=h-n,e=d-a,r=m/(t*i-e*s);if(!(r>=0&&r<=1)){o.push(h),o.push(d);continue}o.push(n+t*r),o.push(a+e*r)}else if(u){let t=h-n,e=d-a,r=m/(t*i-e*s);if(!(r>=0&&r<=1)){o.push(h),o.push(d);continue}o.push(n+t*r),o.push(a+e*r),o.push(h),o.push(d)}c=!0}if(n==o.length)return l.length=0,!0;if(o.push(o[0]),o.push(o[1]),m==d)break;let a=o;(o=h).length=0,h=a}if(l!=o){l.length=0;for(let t=0,e=o.length-2;t<e;t++)l[t]=o[t]}else l.length=l.length-2;return c}static makeClockwise(t){let e=t,s=t.length,i=e[s-2]*e[1]-e[0]*e[s-1],n=0,r=0,a=0,o=0;for(let h=0,l=s-3;h<l;h+=2)n=e[h],r=e[h+1],a=e[h+2],o=e[h+3],i+=n*o-a*r;if(!(i<0))for(let h=0,l=s-2,c=s>>1;h<c;h+=2){let t=e[h],s=e[h+1],i=l-h;e[h]=e[i],e[h+1]=e[i+1],e[i]=t,e[i+1]=s}}}class Ke{constructor(t){(0,a.A)(this,"attachmentLoader",void 0),(0,a.A)(this,"scale",1),(0,a.A)(this,"linkedMeshes",new Array),this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,s=new ne,i="string"===typeof t?JSON.parse(t):t,n=i.skeleton;var r,a;n&&(s.hash=n.hash,s.version=n.spine,s.x=n.x,s.y=n.y,s.width=n.width,s.height=n.height,s.referenceScale=ss(n,"referenceScale",100)*e,s.fps=n.fps,s.imagesPath=null!==(r=n.images)&&void 0!==r?r:null,s.audioPath=null!==(a=n.audio)&&void 0!==a?a:null);if(i.bones)for(let o=0;o<i.bones.length;o++){let t=i.bones[o],n=null,r=ss(t,"parent",null);r&&(n=s.findBone(r));let a=new Ut(s.bones.length,t.name,n);a.length=ss(t,"length",0)*e,a.x=ss(t,"x",0)*e,a.y=ss(t,"y",0)*e,a.rotation=ss(t,"rotation",0),a.scaleX=ss(t,"scaleX",1),a.scaleY=ss(t,"scaleY",1),a.shearX=ss(t,"shearX",0),a.shearY=ss(t,"shearY",0),a.inherit=c.enumValue(Ct,ss(t,"inherit","Normal")),a.skinRequired=ss(t,"skin",!1);let h=ss(t,"color",null);h&&a.color.setFromString(h),s.bones.push(a)}if(i.slots)for(let o=0;o<i.slots.length;o++){let t=i.slots[o],e=t.name,n=s.findBone(t.bone);if(!n)throw new Error("Couldn't find bone ".concat(t.bone," for slot ").concat(e));let r=new oe(s.slots.length,e,n),a=ss(t,"color",null);a&&r.color.setFromString(a);let l=ss(t,"dark",null);l&&(r.darkColor=h.fromString(l)),r.attachmentName=ss(t,"attachment",null),r.blendMode=c.enumValue(Mt,ss(t,"blend","normal")),r.visible=ss(t,"visible",!0),s.slots.push(r)}if(i.ik)for(let o=0;o<i.ik.length;o++){let t=i.ik[o],n=new Ht(t.name);n.order=ss(t,"order",0),n.skinRequired=ss(t,"skin",!1);for(let e=0;e<t.bones.length;e++){let i=s.findBone(t.bones[e]);if(!i)throw new Error("Couldn't find bone ".concat(t.bones[e]," for IK constraint ").concat(t.name,"."));n.bones.push(i)}let r=s.findBone(t.target);if(!r)throw new Error("Couldn't find target bone ".concat(t.target," for IK constraint ").concat(t.name,"."));n.target=r,n.mix=ss(t,"mix",1),n.softness=ss(t,"softness",0)*e,n.bendDirection=ss(t,"bendPositive",!0)?1:-1,n.compress=ss(t,"compress",!1),n.stretch=ss(t,"stretch",!1),n.uniform=ss(t,"uniform",!1),s.ikConstraints.push(n)}if(i.transform)for(let o=0;o<i.transform.length;o++){let t=i.transform[o],n=new he(t.name);n.order=ss(t,"order",0),n.skinRequired=ss(t,"skin",!1);for(let e=0;e<t.bones.length;e++){let i=t.bones[e],r=s.findBone(i);if(!r)throw new Error("Couldn't find bone ".concat(i," for transform constraint ").concat(t.name,"."));n.bones.push(r)}let r=t.target,a=s.findBone(r);if(!a)throw new Error("Couldn't find target bone ".concat(r," for transform constraint ").concat(t.name,"."));n.target=a,n.local=ss(t,"local",!1),n.relative=ss(t,"relative",!1),n.offsetRotation=ss(t,"rotation",0),n.offsetX=ss(t,"x",0)*e,n.offsetY=ss(t,"y",0)*e,n.offsetScaleX=ss(t,"scaleX",0),n.offsetScaleY=ss(t,"scaleY",0),n.offsetShearY=ss(t,"shearY",0),n.mixRotate=ss(t,"mixRotate",1),n.mixX=ss(t,"mixX",1),n.mixY=ss(t,"mixY",n.mixX),n.mixScaleX=ss(t,"mixScaleX",1),n.mixScaleY=ss(t,"mixScaleY",n.mixScaleX),n.mixShearY=ss(t,"mixShearY",1),s.transformConstraints.push(n)}if(i.path)for(let o=0;o<i.path.length;o++){let t=i.path[o],n=new Zt(t.name);n.order=ss(t,"order",0),n.skinRequired=ss(t,"skin",!1);for(let e=0;e<t.bones.length;e++){let i=t.bones[e],r=s.findBone(i);if(!r)throw new Error("Couldn't find bone ".concat(i," for path constraint ").concat(t.name,"."));n.bones.push(r)}let r=t.target,a=s.findSlot(r);if(!a)throw new Error("Couldn't find target slot ".concat(r," for path constraint ").concat(t.name,"."));n.target=a,n.positionMode=c.enumValue(St,ss(t,"positionMode","Percent")),n.spacingMode=c.enumValue(It,ss(t,"spacingMode","Length")),n.rotateMode=c.enumValue(Et,ss(t,"rotateMode","Tangent")),n.offsetRotation=ss(t,"rotation",0),n.position=ss(t,"position",0),n.positionMode==St.Fixed&&(n.position*=e),n.spacing=ss(t,"spacing",0),n.spacingMode!=It.Length&&n.spacingMode!=It.Fixed||(n.spacing*=e),n.mixRotate=ss(t,"mixRotate",1),n.mixX=ss(t,"mixX",1),n.mixY=ss(t,"mixY",n.mixX),s.pathConstraints.push(n)}if(i.physics)for(let o=0;o<i.physics.length;o++){const t=i.physics[o],n=new ie(t.name);n.order=ss(t,"order",0),n.skinRequired=ss(t,"skin",!1);const r=t.bone,a=s.findBone(r);if(null==a)throw new Error("Physics bone not found: "+r);n.bone=a,n.x=ss(t,"x",0),n.y=ss(t,"y",0),n.rotate=ss(t,"rotate",0),n.scaleX=ss(t,"scaleX",0),n.shearX=ss(t,"shearX",0),n.limit=ss(t,"limit",5e3)*e,n.step=1/ss(t,"fps",60),n.inertia=ss(t,"inertia",1),n.strength=ss(t,"strength",100),n.damping=ss(t,"damping",1),n.massInverse=1/ss(t,"mass",1),n.wind=ss(t,"wind",0),n.gravity=ss(t,"gravity",0),n.mix=ss(t,"mix",1),n.inertiaGlobal=ss(t,"inertiaGlobal",!1),n.strengthGlobal=ss(t,"strengthGlobal",!1),n.dampingGlobal=ss(t,"dampingGlobal",!1),n.massGlobal=ss(t,"massGlobal",!1),n.windGlobal=ss(t,"windGlobal",!1),n.gravityGlobal=ss(t,"gravityGlobal",!1),n.mixGlobal=ss(t,"mixGlobal",!1),s.physicsConstraints.push(n)}if(i.skins)for(let o=0;o<i.skins.length;o++){let t=i.skins[o],e=new ae(t.name);if(t.bones)for(let i=0;i<t.bones.length;i++){let n=t.bones[i],r=s.findBone(n);if(!r)throw new Error("Couldn't find bone ".concat(n," for skin ").concat(t.name,"."));e.bones.push(r)}if(t.ik)for(let i=0;i<t.ik.length;i++){let n=t.ik[i],r=s.findIkConstraint(n);if(!r)throw new Error("Couldn't find IK constraint ".concat(n," for skin ").concat(t.name,"."));e.constraints.push(r)}if(t.transform)for(let i=0;i<t.transform.length;i++){let n=t.transform[i],r=s.findTransformConstraint(n);if(!r)throw new Error("Couldn't find transform constraint ".concat(n," for skin ").concat(t.name,"."));e.constraints.push(r)}if(t.path)for(let i=0;i<t.path.length;i++){let n=t.path[i],r=s.findPathConstraint(n);if(!r)throw new Error("Couldn't find path constraint ".concat(n," for skin ").concat(t.name,"."));e.constraints.push(r)}if(t.physics)for(let i=0;i<t.physics.length;i++){let n=t.physics[i],r=s.findPhysicsConstraint(n);if(!r)throw new Error("Couldn't find physics constraint ".concat(n," for skin ").concat(t.name,"."));e.constraints.push(r)}for(let i in t.attachments){let n=s.findSlot(i);if(!n)throw new Error("Couldn't find slot ".concat(i," for skin ").concat(t.name,"."));let r=t.attachments[i];for(let t in r){let i=this.readAttachment(r[t],e,n.index,t,s);i&&e.setAttachment(n.index,t,i)}}s.skins.push(e),"default"==e.name&&(s.defaultSkin=e)}for(let o=0,h=this.linkedMeshes.length;o<h;o++){let t=this.linkedMeshes[o],e=t.skin?s.findSkin(t.skin):s.defaultSkin;if(!e)throw new Error("Skin not found: ".concat(t.skin));let i=e.getAttachment(t.slotIndex,t.parent);if(!i)throw new Error("Parent mesh not found: ".concat(t.parent));t.mesh.timelineAttachment=t.inheritTimeline?i:t.mesh,t.mesh.setParentMesh(i),null!=t.mesh.region&&t.mesh.updateRegion()}if(this.linkedMeshes.length=0,i.events)for(let o in i.events){let t=i.events[o],e=new se(o);e.intValue=ss(t,"int",0),e.floatValue=ss(t,"float",0),e.stringValue=ss(t,"string",""),e.audioPath=ss(t,"audio",null),e.audioPath&&(e.volume=ss(t,"volume",1),e.balance=ss(t,"balance",0)),s.events.push(e)}if(i.animations)for(let o in i.animations){let t=i.animations[o];this.readAnimation(t,o,s)}return s}readAttachment(t,e,s,i,n){let r=this.scale;switch(i=ss(t,"name",i),ss(t,"type","region")){case"region":{let s=ss(t,"path",i),n=this.readSequence(ss(t,"sequence",null)),a=this.attachmentLoader.newRegionAttachment(e,i,s,n);if(!a)return null;a.path=s,a.x=ss(t,"x",0)*r,a.y=ss(t,"y",0)*r,a.scaleX=ss(t,"scaleX",1),a.scaleY=ss(t,"scaleY",1),a.rotation=ss(t,"rotation",0),a.width=t.width*r,a.height=t.height*r,a.sequence=n;let o=ss(t,"color",null);return o&&a.color.setFromString(o),null!=a.region&&a.updateRegion(),a}case"boundingbox":{let s=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(!s)return null;this.readVertices(t,s,t.vertexCount<<1);let n=ss(t,"color",null);return n&&s.color.setFromString(n),s}case"mesh":case"linkedmesh":{let n=ss(t,"path",i),a=this.readSequence(ss(t,"sequence",null)),o=this.attachmentLoader.newMeshAttachment(e,i,n,a);if(!o)return null;o.path=n;let h=ss(t,"color",null);h&&o.color.setFromString(h),o.width=ss(t,"width",0)*r,o.height=ss(t,"height",0)*r,o.sequence=a;let l=ss(t,"parent",null);if(l)return this.linkedMeshes.push(new Qe(o,ss(t,"skin",null),s,l,ss(t,"timelines",!0))),o;let c=t.uvs;return this.readVertices(t,o,c.length),o.triangles=t.triangles,o.regionUVs=c,null!=o.region&&o.updateRegion(),o.edges=ss(t,"edges",null),o.hullLength=2*ss(t,"hull",0),o}case"path":{let s=this.attachmentLoader.newPathAttachment(e,i);if(!s)return null;s.closed=ss(t,"closed",!1),s.constantSpeed=ss(t,"constantSpeed",!0);let n=t.vertexCount;this.readVertices(t,s,n<<1);let a=c.newArray(n/3,0);for(let e=0;e<t.lengths.length;e++)a[e]=t.lengths[e]*r;s.lengths=a;let o=ss(t,"color",null);return o&&s.color.setFromString(o),s}case"point":{let s=this.attachmentLoader.newPointAttachment(e,i);if(!s)return null;s.x=ss(t,"x",0)*r,s.y=ss(t,"y",0)*r,s.rotation=ss(t,"rotation",0);let n=ss(t,"color",null);return n&&s.color.setFromString(n),s}case"clipping":{let s=this.attachmentLoader.newClippingAttachment(e,i);if(!s)return null;let r=ss(t,"end",null);r&&(s.endSlot=n.findSlot(r));let a=t.vertexCount;this.readVertices(t,s,a<<1);let o=ss(t,"color",null);return o&&s.color.setFromString(o),s}}return null}readSequence(t){if(null==t)return null;let e=new f(ss(t,"count",0));return e.start=ss(t,"start",1),e.digits=ss(t,"digits",0),e.setupIndex=ss(t,"setup",0),e}readVertices(t,e,s){let i=this.scale;e.worldVerticesLength=s;let n=t.vertices;if(s==n.length){let t=c.toFloatArray(n);if(1!=i)for(let e=0,s=n.length;e<s;e++)t[e]*=i;return void(e.vertices=t)}let r=new Array,a=new Array;for(let o=0,h=n.length;o<h;){let t=n[o++];a.push(t);for(let e=o+4*t;o<e;o+=4)a.push(n[o]),r.push(n[o+1]*i),r.push(n[o+2]*i),r.push(n[o+3])}e.bones=a,e.vertices=c.toFloatArray(r)}readAnimation(t,e,s){let i=this.scale,n=new Array;if(t.slots)for(let r in t.slots){let e=t.slots[r],i=s.findSlot(r);if(!i)throw new Error("Slot not found: "+r);let a=i.index;for(let t in e){let s=e[t];if(!s)continue;let i=s.length;if("attachment"==t){let t=new W(i,a);for(let e=0;e<i;e++){let i=s[e];t.setFrame(e,ss(i,"time",0),ss(i,"name",null))}n.push(t)}else if("rgba"==t){let t=new V(i,i<<2,a),e=s[0],r=ss(e,"time",0),o=h.fromString(e.color);for(let i=0,n=0;;i++){t.setFrame(i,r,o.r,o.g,o.b,o.a);let a=s[i+1];if(!a){t.shrink(n);break}let l=ss(a,"time",0),c=h.fromString(a.color),d=e.curve;d&&(n=es(d,t,n,i,0,r,l,o.r,c.r,1),n=es(d,t,n,i,1,r,l,o.g,c.g,1),n=es(d,t,n,i,2,r,l,o.b,c.b,1),n=es(d,t,n,i,3,r,l,o.a,c.a,1)),r=l,o=c,e=a}n.push(t)}else if("rgb"==t){let t=new D(i,3*i,a),e=s[0],r=ss(e,"time",0),o=h.fromString(e.color);for(let i=0,n=0;;i++){t.setFrame(i,r,o.r,o.g,o.b);let a=s[i+1];if(!a){t.shrink(n);break}let l=ss(a,"time",0),c=h.fromString(a.color),d=e.curve;d&&(n=es(d,t,n,i,0,r,l,o.r,c.r,1),n=es(d,t,n,i,1,r,l,o.g,c.g,1),n=es(d,t,n,i,2,r,l,o.b,c.b,1)),r=l,o=c,e=a}n.push(t)}else if("alpha"==t)n.push($e(s,new O(i,i,a),0,1));else if("rgba2"==t){let t=new N(i,7*i,a),e=s[0],r=ss(e,"time",0),o=h.fromString(e.light),l=h.fromString(e.dark);for(let i=0,n=0;;i++){t.setFrame(i,r,o.r,o.g,o.b,o.a,l.r,l.g,l.b);let a=s[i+1];if(!a){t.shrink(n);break}let c=ss(a,"time",0),d=h.fromString(a.light),u=h.fromString(a.dark),m=e.curve;m&&(n=es(m,t,n,i,0,r,c,o.r,d.r,1),n=es(m,t,n,i,1,r,c,o.g,d.g,1),n=es(m,t,n,i,2,r,c,o.b,d.b,1),n=es(m,t,n,i,3,r,c,o.a,d.a,1),n=es(m,t,n,i,4,r,c,l.r,u.r,1),n=es(m,t,n,i,5,r,c,l.g,u.g,1),n=es(m,t,n,i,6,r,c,l.b,u.b,1)),r=c,o=d,l=u,e=a}n.push(t)}else if("rgb2"==t){let t=new U(i,6*i,a),e=s[0],r=ss(e,"time",0),o=h.fromString(e.light),l=h.fromString(e.dark);for(let i=0,n=0;;i++){t.setFrame(i,r,o.r,o.g,o.b,l.r,l.g,l.b);let a=s[i+1];if(!a){t.shrink(n);break}let c=ss(a,"time",0),d=h.fromString(a.light),u=h.fromString(a.dark),m=e.curve;m&&(n=es(m,t,n,i,0,r,c,o.r,d.r,1),n=es(m,t,n,i,1,r,c,o.g,d.g,1),n=es(m,t,n,i,2,r,c,o.b,d.b,1),n=es(m,t,n,i,3,r,c,l.r,u.r,1),n=es(m,t,n,i,4,r,c,l.g,u.g,1),n=es(m,t,n,i,5,r,c,l.b,u.b,1)),r=c,o=d,l=u,e=a}n.push(t)}}}if(t.bones)for(let r in t.bones){let e=t.bones[r],a=s.findBone(r);if(!a)throw new Error("Bone not found: "+r);let o=a.index;for(let t in e){let s=e[t],r=s.length;if(0!=r)if("rotate"===t)n.push($e(s,new I(r,r,o),0,1));else if("translate"===t){let t=new E(r,r<<1,o);n.push(ts(s,t,"x","y",0,i))}else if("translatex"===t){let t=new T(r,r,o);n.push($e(s,t,0,i))}else if("translatey"===t){let t=new M(r,r,o);n.push($e(s,t,0,i))}else if("scale"===t){let t=new R(r,r<<1,o);n.push(ts(s,t,"x","y",1,1))}else if("scalex"===t){let t=new F(r,r,o);n.push($e(s,t,1,1))}else if("scaley"===t){let t=new Y(r,r,o);n.push($e(s,t,1,1))}else if("shear"===t){let t=new L(r,r<<1,o);n.push(ts(s,t,"x","y",0,1))}else if("shearx"===t){let t=new B(r,r,o);n.push($e(s,t,0,1))}else if("sheary"===t){let t=new X(r,r,o);n.push($e(s,t,0,1))}else if("inherit"===t){let t=new P(r,a.index);for(let e=0;e<s.length;e++){let i=s[e];t.setFrame(e,ss(i,"time",0),c.enumValue(Ct,ss(i,"inherit","Normal")))}n.push(t)}}}if(t.ik)for(let r in t.ik){let e=t.ik[r],a=e[0];if(!a)continue;let o=s.findIkConstraint(r);if(!o)throw new Error("IK Constraint not found: "+r);let h=s.ikConstraints.indexOf(o),l=new _(e.length,e.length<<1,h),c=ss(a,"time",0),d=ss(a,"mix",1),u=ss(a,"softness",0)*i;for(let t=0,s=0;;t++){l.setFrame(t,c,d,u,ss(a,"bendPositive",!0)?1:-1,ss(a,"compress",!1),ss(a,"stretch",!1));let n=e[t+1];if(!n){l.shrink(s);break}let r=ss(n,"time",0),o=ss(n,"mix",1),h=ss(n,"softness",0)*i,m=a.curve;m&&(s=es(m,l,s,t,0,c,r,d,o,1),s=es(m,l,s,t,1,c,r,u,h,i)),c=r,d=o,u=h,a=n}n.push(l)}if(t.transform)for(let r in t.transform){let e=t.transform[r],i=e[0];if(!i)continue;let a=s.findTransformConstraint(r);if(!a)throw new Error("Transform constraint not found: "+r);let o=s.transformConstraints.indexOf(a),h=new j(e.length,6*e.length,o),l=ss(i,"time",0),c=ss(i,"mixRotate",1),d=ss(i,"mixX",1),u=ss(i,"mixY",d),m=ss(i,"mixScaleX",1),p=ss(i,"mixScaleY",m),g=ss(i,"mixShearY",1);for(let t=0,s=0;;t++){h.setFrame(t,l,c,d,u,m,p,g);let n=e[t+1];if(!n){h.shrink(s);break}let r=ss(n,"time",0),a=ss(n,"mixRotate",1),o=ss(n,"mixX",1),f=ss(n,"mixY",o),w=ss(n,"mixScaleX",1),A=ss(n,"mixScaleY",w),x=ss(n,"mixShearY",1),b=i.curve;b&&(s=es(b,h,s,t,0,l,r,c,a,1),s=es(b,h,s,t,1,l,r,d,o,1),s=es(b,h,s,t,2,l,r,u,f,1),s=es(b,h,s,t,3,l,r,m,w,1),s=es(b,h,s,t,4,l,r,p,A,1),s=es(b,h,s,t,5,l,r,g,x,1)),l=r,c=a,d=o,u=f,m=w,p=A,m=w,i=n}n.push(h)}if(t.path)for(let r in t.path){let e=t.path[r],a=s.findPathConstraint(r);if(!a)throw new Error("Path constraint not found: "+r);let o=s.pathConstraints.indexOf(a);for(let t in e){let s=e[t],r=s[0];if(!r)continue;let h=s.length;if("position"===t){let t=new H(h,h,o);n.push($e(s,t,0,a.positionMode==St.Fixed?i:1))}else if("spacing"===t){let t=new Z(h,h,o);n.push($e(s,t,0,a.spacingMode==It.Length||a.spacingMode==It.Fixed?i:1))}else if("mix"===t){let t=new J(h,3*h,o),e=ss(r,"time",0),i=ss(r,"mixRotate",1),a=ss(r,"mixX",1),l=ss(r,"mixY",a);for(let n=0,o=0;;n++){t.setFrame(n,e,i,a,l);let h=s[n+1];if(!h){t.shrink(o);break}let c=ss(h,"time",0),d=ss(h,"mixRotate",1),u=ss(h,"mixX",1),m=ss(h,"mixY",u),p=r.curve;p&&(o=es(p,t,o,n,0,e,c,i,d,1),o=es(p,t,o,n,1,e,c,a,u,1),o=es(p,t,o,n,2,e,c,l,m,1)),e=c,i=d,a=u,l=m,r=h}n.push(t)}}}if(t.physics)for(let r in t.physics){let e=t.physics[r],i=-1;if(r.length>0){let t=s.findPhysicsConstraint(r);if(!t)throw new Error("Physics constraint not found: "+r);i=s.physicsConstraints.indexOf(t)}for(let t in e){let s=e[t],r=s[0];if(!r)continue;let a,o=s.length;if("reset"==t){const t=new rt(o,i);for(let e=0;null!=r;r=s[e+1],e++)t.setFrame(e,ss(r,"time",0));n.push(t);continue}if("inertia"==t)a=new Q(o,o,i);else if("strength"==t)a=new $(o,o,i);else if("damping"==t)a=new tt(o,o,i);else if("mass"==t)a=new et(o,o,i);else if("wind"==t)a=new st(o,o,i);else if("gravity"==t)a=new it(o,o,i);else{if("mix"!=t)continue;a=new nt(o,o,i)}n.push($e(s,a,0,1))}}if(t.attachments)for(let o in t.attachments){let e=t.attachments[o],a=s.findSkin(o);if(!a)throw new Error("Skin not found: "+o);for(let t in e){let o=e[t],h=s.findSlot(t);if(!h)throw new Error("Slot not found: "+t);let l=h.index;for(let t in o){let e=o[t],s=a.getAttachment(l,t);for(let t in e){let a=e[t],o=a[0];if(o)if("deform"==t){let t=s.bones,e=s.vertices,r=t?e.length/3*2:e.length,h=new z(a.length,a.length,l,s),d=ss(o,"time",0);for(let s=0,n=0;;s++){let l,u=ss(o,"vertices",null);if(u){l=c.newFloatArray(r);let s=ss(o,"offset",0);if(c.arrayCopy(u,0,l,s,u.length),1!=i)for(let t=s,e=t+u.length;t<e;t++)l[t]*=i;if(!t)for(let t=0;t<r;t++)l[t]+=e[t]}else l=t?c.newFloatArray(r):e;h.setFrame(s,d,l);let m=a[s+1];if(!m){h.shrink(n);break}let p=ss(m,"time",0),g=o.curve;g&&(n=es(g,h,n,s,0,d,p,0,1,1)),d=p,o=m}n.push(h)}else if("sequence"==t){let t=new at(a.length,l,s),e=0;for(let s=0;s<a.length;s++){let i=ss(o,"delay",e),n=ss(o,"time",0),h=r[ss(o,"mode","hold")],l=ss(o,"index",0);t.setFrame(s,n,h,l,i),e=i,o=a[s+1]}n.push(t)}}}}}if(t.drawOrder){let e=new G(t.drawOrder.length),i=s.slots.length,r=0;for(let n=0;n<t.drawOrder.length;n++,r++){let a=t.drawOrder[n],o=null,h=ss(a,"offsets",null);if(h){o=c.newArray(i,-1);let t=c.newArray(i-h.length,0),e=0,n=0;for(let i=0;i<h.length;i++){let r=h[i],a=s.findSlot(r.slot);if(!a)throw new Error("Slot not found: "+a);let l=a.index;for(;e!=l;)t[n++]=e++;o[e+r.offset]=e++}for(;e<i;)t[n++]=e++;for(let s=i-1;s>=0;s--)-1==o[s]&&(o[s]=t[--n])}e.setFrame(r,ss(a,"time",0),o)}n.push(e)}if(t.events){let e=new q(t.events.length),i=0;for(let n=0;n<t.events.length;n++,i++){let r=t.events[n],a=s.findEvent(r.name);if(!a)throw new Error("Event not found: "+r.name);let o=new ee(c.toSinglePrecision(ss(r,"time",0)),a);o.intValue=ss(r,"int",a.intValue),o.floatValue=ss(r,"float",a.floatValue),o.stringValue=ss(r,"string",a.stringValue),o.data.audioPath&&(o.volume=ss(r,"volume",1),o.balance=ss(r,"balance",0)),e.setFrame(i,o)}n.push(e)}let a=0;for(let r=0,o=n.length;r<o;r++)a=Math.max(a,n[r].getDuration());s.animations.push(new A(e,n,a))}}class Qe{constructor(t,e,s,i,n){(0,a.A)(this,"parent",void 0),(0,a.A)(this,"skin",void 0),(0,a.A)(this,"slotIndex",void 0),(0,a.A)(this,"mesh",void 0),(0,a.A)(this,"inheritTimeline",void 0),this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=i,this.inheritTimeline=n}}function $e(t,e,s,i){let n=t[0],r=ss(n,"time",0),a=ss(n,"value",s)*i,o=0;for(let h=0;;h++){e.setFrame(h,r,a);let l=t[h+1];if(!l)return e.shrink(o),e;let c=ss(l,"time",0),d=ss(l,"value",s)*i;n.curve&&(o=es(n.curve,e,o,h,0,r,c,a,d,i)),r=c,a=d,n=l}}function ts(t,e,s,i,n,r){let a=t[0],o=ss(a,"time",0),h=ss(a,s,n)*r,l=ss(a,i,n)*r,c=0;for(let d=0;;d++){e.setFrame(d,o,h,l);let u=t[d+1];if(!u)return e.shrink(c),e;let m=ss(u,"time",0),p=ss(u,s,n)*r,g=ss(u,i,n)*r,f=a.curve;f&&(c=es(f,e,c,d,0,o,m,h,p,r),c=es(f,e,c,d,1,o,m,l,g,r)),o=m,h=p,l=g,a=u}}function es(t,e,s,i,n,r,a,o,h,l){if("stepped"==t)return e.setStepped(i),s;let c=n<<2,d=t[c],u=t[c+1]*l,m=t[c+2],p=t[c+3]*l;return e.setBezier(s,i,n,r,o,d,u,m,p,a,h),s+1}function ss(t,e,s){return void 0!==t[e]?t[e]:s}(()=>{var t;"undefined"===typeof Math.fround&&(Math.fround=(t=new Float32Array(1),function(e){return t[0]=e,t[0]}))})();class is{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{alpha:!0};if((0,a.A)(this,"canvas",void 0),(0,a.A)(this,"gl",void 0),(0,a.A)(this,"restorables",[]),(0,a.A)(this,"contextLostHandler",t=>{t&&t.preventDefault()}),(0,a.A)(this,"contextRestoredHandler",()=>{for(let t=0,e=this.restorables.length;t<e;t++)this.restorables[t].restore()}),t instanceof WebGLRenderingContext||"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)this.gl=t,this.canvas=this.gl.canvas;else{const s=t;this.gl=s.getContext("webgl2",e)||s.getContext("webgl",e),this.canvas=s,s.addEventListener("webglcontextlost",this.contextLostHandler),s.addEventListener("webglcontextrestored",this.contextRestoredHandler)}}dispose(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler)}addRestorable(t){this.restorables.push(t)}removeRestorable(t){const e=this.restorables.indexOf(t);e>-1&&this.restorables.splice(e,1)}}class ns extends vt{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),(0,a.A)(this,"context",void 0),(0,a.A)(this,"texture",null),(0,a.A)(this,"boundUnit",0),(0,a.A)(this,"useMipMaps",!1),this.context=t instanceof is?t:new is(t),this.useMipMaps=s,this.restore(),this.context.addRestorable(this)}setFilters(t,e){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,ns.validateMagFilter(e)),this.useMipMaps=ns.usesMipMaps(t),this.useMipMaps&&s.generateMipmap(s.TEXTURE_2D)}static validateMagFilter(t){switch(t){case yt.MipMapLinearLinear:case yt.MipMapLinearNearest:case yt.MipMapNearestLinear:case yt.MipMapNearestNearest:return yt.Linear;default:return t}}static usesMipMaps(t){switch(t){case yt.MipMapLinearLinear:case yt.MipMapLinearNearest:case yt.MipMapNearestLinear:case yt.MipMapNearestNearest:return!0;default:return!1}}setWraps(t,e){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,e)}update(t){let e=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),ns.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&e.generateMipmap(e.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}unbind(){let t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}}(0,a.A)(ns,"DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL",!1);class rs extends zt{constructor(t){super(e=>new ns(t,e),arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Gt)}}class as{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,a.A)(this,"x",0),(0,a.A)(this,"y",0),(0,a.A)(this,"z",0),this.x=t,this.y=e,this.z=s}setFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,e,s){return this.x=t,this.y=e,this.z=s,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}scale(t){return this.x*=t,this.y*=t,this.z*=t,this}normalize(){let t=this.length();return 0==t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}cross(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}multiply(t){let e=t.values;return this.set(this.x*e[hs]+this.y*e[ls]+this.z*e[cs]+e[ds],this.x*e[us]+this.y*e[ms]+this.z*e[ps]+e[gs],this.x*e[fs]+this.y*e[ws]+this.z*e[As]+e[xs])}project(t){let e=t.values,s=1/(this.x*e[bs]+this.y*e[vs]+this.z*e[ys]+e[ks]);return this.set((this.x*e[hs]+this.y*e[ls]+this.z*e[cs]+e[ds])*s,(this.x*e[us]+this.y*e[ms]+this.z*e[ps]+e[gs])*s,(this.x*e[fs]+this.y*e[ws]+this.z*e[As]+e[xs])*s)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(t){let e=t.x-this.x,s=t.y-this.y,i=t.z-this.z;return Math.sqrt(e*e+s*s+i*i)}}var os;const hs=0,ls=4,cs=8,ds=12,us=1,ms=5,ps=9,gs=13,fs=2,ws=6,As=10,xs=14,bs=3,vs=7,ys=11,ks=15;class Cs{constructor(){(0,a.A)(this,"temp",new Float32Array(16)),(0,a.A)(this,"values",new Float32Array(16));let t=this.values;t[hs]=1,t[ms]=1,t[As]=1,t[ks]=1}set(t){return this.values.set(t),this}transpose(){let t=this.temp,e=this.values;return t[hs]=e[hs],t[ls]=e[us],t[cs]=e[fs],t[ds]=e[bs],t[us]=e[ls],t[ms]=e[ms],t[ps]=e[ws],t[gs]=e[vs],t[fs]=e[cs],t[ws]=e[ps],t[As]=e[As],t[xs]=e[ys],t[bs]=e[ds],t[vs]=e[gs],t[ys]=e[xs],t[ks]=e[ks],this.set(t)}identity(){let t=this.values;return t[hs]=1,t[ls]=0,t[cs]=0,t[ds]=0,t[us]=0,t[ms]=1,t[ps]=0,t[gs]=0,t[fs]=0,t[ws]=0,t[As]=1,t[xs]=0,t[bs]=0,t[vs]=0,t[ys]=0,t[ks]=1,this}invert(){let t=this.values,e=this.temp,s=t[bs]*t[ws]*t[ps]*t[ds]-t[fs]*t[vs]*t[ps]*t[ds]-t[bs]*t[ms]*t[As]*t[ds]+t[us]*t[vs]*t[As]*t[ds]+t[fs]*t[ms]*t[ys]*t[ds]-t[us]*t[ws]*t[ys]*t[ds]-t[bs]*t[ws]*t[cs]*t[gs]+t[fs]*t[vs]*t[cs]*t[gs]+t[bs]*t[ls]*t[As]*t[gs]-t[hs]*t[vs]*t[As]*t[gs]-t[fs]*t[ls]*t[ys]*t[gs]+t[hs]*t[ws]*t[ys]*t[gs]+t[bs]*t[ms]*t[cs]*t[xs]-t[us]*t[vs]*t[cs]*t[xs]-t[bs]*t[ls]*t[ps]*t[xs]+t[hs]*t[vs]*t[ps]*t[xs]+t[us]*t[ls]*t[ys]*t[xs]-t[hs]*t[ms]*t[ys]*t[xs]-t[fs]*t[ms]*t[cs]*t[ks]+t[us]*t[ws]*t[cs]*t[ks]+t[fs]*t[ls]*t[ps]*t[ks]-t[hs]*t[ws]*t[ps]*t[ks]-t[us]*t[ls]*t[As]*t[ks]+t[hs]*t[ms]*t[As]*t[ks];if(0==s)throw new Error("non-invertible matrix");let i=1/s;return e[hs]=t[ps]*t[xs]*t[vs]-t[gs]*t[As]*t[vs]+t[gs]*t[ws]*t[ys]-t[ms]*t[xs]*t[ys]-t[ps]*t[ws]*t[ks]+t[ms]*t[As]*t[ks],e[ls]=t[ds]*t[As]*t[vs]-t[cs]*t[xs]*t[vs]-t[ds]*t[ws]*t[ys]+t[ls]*t[xs]*t[ys]+t[cs]*t[ws]*t[ks]-t[ls]*t[As]*t[ks],e[cs]=t[cs]*t[gs]*t[vs]-t[ds]*t[ps]*t[vs]+t[ds]*t[ms]*t[ys]-t[ls]*t[gs]*t[ys]-t[cs]*t[ms]*t[ks]+t[ls]*t[ps]*t[ks],e[ds]=t[ds]*t[ps]*t[ws]-t[cs]*t[gs]*t[ws]-t[ds]*t[ms]*t[As]+t[ls]*t[gs]*t[As]+t[cs]*t[ms]*t[xs]-t[ls]*t[ps]*t[xs],e[us]=t[gs]*t[As]*t[bs]-t[ps]*t[xs]*t[bs]-t[gs]*t[fs]*t[ys]+t[us]*t[xs]*t[ys]+t[ps]*t[fs]*t[ks]-t[us]*t[As]*t[ks],e[ms]=t[cs]*t[xs]*t[bs]-t[ds]*t[As]*t[bs]+t[ds]*t[fs]*t[ys]-t[hs]*t[xs]*t[ys]-t[cs]*t[fs]*t[ks]+t[hs]*t[As]*t[ks],e[ps]=t[ds]*t[ps]*t[bs]-t[cs]*t[gs]*t[bs]-t[ds]*t[us]*t[ys]+t[hs]*t[gs]*t[ys]+t[cs]*t[us]*t[ks]-t[hs]*t[ps]*t[ks],e[gs]=t[cs]*t[gs]*t[fs]-t[ds]*t[ps]*t[fs]+t[ds]*t[us]*t[As]-t[hs]*t[gs]*t[As]-t[cs]*t[us]*t[xs]+t[hs]*t[ps]*t[xs],e[fs]=t[ms]*t[xs]*t[bs]-t[gs]*t[ws]*t[bs]+t[gs]*t[fs]*t[vs]-t[us]*t[xs]*t[vs]-t[ms]*t[fs]*t[ks]+t[us]*t[ws]*t[ks],e[ws]=t[ds]*t[ws]*t[bs]-t[ls]*t[xs]*t[bs]-t[ds]*t[fs]*t[vs]+t[hs]*t[xs]*t[vs]+t[ls]*t[fs]*t[ks]-t[hs]*t[ws]*t[ks],e[As]=t[ls]*t[gs]*t[bs]-t[ds]*t[ms]*t[bs]+t[ds]*t[us]*t[vs]-t[hs]*t[gs]*t[vs]-t[ls]*t[us]*t[ks]+t[hs]*t[ms]*t[ks],e[xs]=t[ds]*t[ms]*t[fs]-t[ls]*t[gs]*t[fs]-t[ds]*t[us]*t[ws]+t[hs]*t[gs]*t[ws]+t[ls]*t[us]*t[xs]-t[hs]*t[ms]*t[xs],e[bs]=t[ps]*t[ws]*t[bs]-t[ms]*t[As]*t[bs]-t[ps]*t[fs]*t[vs]+t[us]*t[As]*t[vs]+t[ms]*t[fs]*t[ys]-t[us]*t[ws]*t[ys],e[vs]=t[ls]*t[As]*t[bs]-t[cs]*t[ws]*t[bs]+t[cs]*t[fs]*t[vs]-t[hs]*t[As]*t[vs]-t[ls]*t[fs]*t[ys]+t[hs]*t[ws]*t[ys],e[ys]=t[cs]*t[ms]*t[bs]-t[ls]*t[ps]*t[bs]-t[cs]*t[us]*t[vs]+t[hs]*t[ps]*t[vs]+t[ls]*t[us]*t[ys]-t[hs]*t[ms]*t[ys],e[ks]=t[ls]*t[ps]*t[fs]-t[cs]*t[ms]*t[fs]+t[cs]*t[us]*t[ws]-t[hs]*t[ps]*t[ws]-t[ls]*t[us]*t[As]+t[hs]*t[ms]*t[As],t[hs]=e[hs]*i,t[ls]=e[ls]*i,t[cs]=e[cs]*i,t[ds]=e[ds]*i,t[us]=e[us]*i,t[ms]=e[ms]*i,t[ps]=e[ps]*i,t[gs]=e[gs]*i,t[fs]=e[fs]*i,t[ws]=e[ws]*i,t[As]=e[As]*i,t[xs]=e[xs]*i,t[bs]=e[bs]*i,t[vs]=e[vs]*i,t[ys]=e[ys]*i,t[ks]=e[ks]*i,this}determinant(){let t=this.values;return t[bs]*t[ws]*t[ps]*t[ds]-t[fs]*t[vs]*t[ps]*t[ds]-t[bs]*t[ms]*t[As]*t[ds]+t[us]*t[vs]*t[As]*t[ds]+t[fs]*t[ms]*t[ys]*t[ds]-t[us]*t[ws]*t[ys]*t[ds]-t[bs]*t[ws]*t[cs]*t[gs]+t[fs]*t[vs]*t[cs]*t[gs]+t[bs]*t[ls]*t[As]*t[gs]-t[hs]*t[vs]*t[As]*t[gs]-t[fs]*t[ls]*t[ys]*t[gs]+t[hs]*t[ws]*t[ys]*t[gs]+t[bs]*t[ms]*t[cs]*t[xs]-t[us]*t[vs]*t[cs]*t[xs]-t[bs]*t[ls]*t[ps]*t[xs]+t[hs]*t[vs]*t[ps]*t[xs]+t[us]*t[ls]*t[ys]*t[xs]-t[hs]*t[ms]*t[ys]*t[xs]-t[fs]*t[ms]*t[cs]*t[ks]+t[us]*t[ws]*t[cs]*t[ks]+t[fs]*t[ls]*t[ps]*t[ks]-t[hs]*t[ws]*t[ps]*t[ks]-t[us]*t[ls]*t[As]*t[ks]+t[hs]*t[ms]*t[As]*t[ks]}translate(t,e,s){let i=this.values;return i[ds]+=t,i[gs]+=e,i[xs]+=s,this}copy(){return(new Cs).set(this.values)}projection(t,e,s,i){this.identity();let n=1/Math.tan(s*(Math.PI/180)/2),r=(e+t)/(t-e),a=2*e*t/(t-e),o=this.values;return o[hs]=n/i,o[us]=0,o[fs]=0,o[bs]=0,o[ls]=0,o[ms]=n,o[ws]=0,o[vs]=0,o[cs]=0,o[ps]=0,o[As]=r,o[ys]=-1,o[ds]=0,o[gs]=0,o[xs]=a,o[ks]=0,this}ortho2d(t,e,s,i){return this.ortho(t,t+s,e,e+i,0,1)}ortho(t,e,s,i,n,r){this.identity();let a=2/(e-t),o=2/(i-s),h=-2/(r-n),l=-(e+t)/(e-t),c=-(i+s)/(i-s),d=-(r+n)/(r-n),u=this.values;return u[hs]=a,u[us]=0,u[fs]=0,u[bs]=0,u[ls]=0,u[ms]=o,u[ws]=0,u[vs]=0,u[cs]=0,u[ps]=0,u[As]=h,u[ys]=0,u[ds]=l,u[gs]=c,u[xs]=d,u[ks]=1,this}multiply(t){let e=this.temp,s=this.values,i=t.values;return e[hs]=s[hs]*i[hs]+s[ls]*i[us]+s[cs]*i[fs]+s[ds]*i[bs],e[ls]=s[hs]*i[ls]+s[ls]*i[ms]+s[cs]*i[ws]+s[ds]*i[vs],e[cs]=s[hs]*i[cs]+s[ls]*i[ps]+s[cs]*i[As]+s[ds]*i[ys],e[ds]=s[hs]*i[ds]+s[ls]*i[gs]+s[cs]*i[xs]+s[ds]*i[ks],e[us]=s[us]*i[hs]+s[ms]*i[us]+s[ps]*i[fs]+s[gs]*i[bs],e[ms]=s[us]*i[ls]+s[ms]*i[ms]+s[ps]*i[ws]+s[gs]*i[vs],e[ps]=s[us]*i[cs]+s[ms]*i[ps]+s[ps]*i[As]+s[gs]*i[ys],e[gs]=s[us]*i[ds]+s[ms]*i[gs]+s[ps]*i[xs]+s[gs]*i[ks],e[fs]=s[fs]*i[hs]+s[ws]*i[us]+s[As]*i[fs]+s[xs]*i[bs],e[ws]=s[fs]*i[ls]+s[ws]*i[ms]+s[As]*i[ws]+s[xs]*i[vs],e[As]=s[fs]*i[cs]+s[ws]*i[ps]+s[As]*i[As]+s[xs]*i[ys],e[xs]=s[fs]*i[ds]+s[ws]*i[gs]+s[As]*i[xs]+s[xs]*i[ks],e[bs]=s[bs]*i[hs]+s[vs]*i[us]+s[ys]*i[fs]+s[ks]*i[bs],e[vs]=s[bs]*i[ls]+s[vs]*i[ms]+s[ys]*i[ws]+s[ks]*i[vs],e[ys]=s[bs]*i[cs]+s[vs]*i[ps]+s[ys]*i[As]+s[ks]*i[ys],e[ks]=s[bs]*i[ds]+s[vs]*i[gs]+s[ys]*i[xs]+s[ks]*i[ks],this.set(this.temp)}multiplyLeft(t){let e=this.temp,s=this.values,i=t.values;return e[hs]=i[hs]*s[hs]+i[ls]*s[us]+i[cs]*s[fs]+i[ds]*s[bs],e[ls]=i[hs]*s[ls]+i[ls]*s[ms]+i[cs]*s[ws]+i[ds]*s[vs],e[cs]=i[hs]*s[cs]+i[ls]*s[ps]+i[cs]*s[As]+i[ds]*s[ys],e[ds]=i[hs]*s[ds]+i[ls]*s[gs]+i[cs]*s[xs]+i[ds]*s[ks],e[us]=i[us]*s[hs]+i[ms]*s[us]+i[ps]*s[fs]+i[gs]*s[bs],e[ms]=i[us]*s[ls]+i[ms]*s[ms]+i[ps]*s[ws]+i[gs]*s[vs],e[ps]=i[us]*s[cs]+i[ms]*s[ps]+i[ps]*s[As]+i[gs]*s[ys],e[gs]=i[us]*s[ds]+i[ms]*s[gs]+i[ps]*s[xs]+i[gs]*s[ks],e[fs]=i[fs]*s[hs]+i[ws]*s[us]+i[As]*s[fs]+i[xs]*s[bs],e[ws]=i[fs]*s[ls]+i[ws]*s[ms]+i[As]*s[ws]+i[xs]*s[vs],e[As]=i[fs]*s[cs]+i[ws]*s[ps]+i[As]*s[As]+i[xs]*s[ys],e[xs]=i[fs]*s[ds]+i[ws]*s[gs]+i[As]*s[xs]+i[xs]*s[ks],e[bs]=i[bs]*s[hs]+i[vs]*s[us]+i[ys]*s[fs]+i[ks]*s[bs],e[vs]=i[bs]*s[ls]+i[vs]*s[ms]+i[ys]*s[ws]+i[ks]*s[vs],e[ys]=i[bs]*s[cs]+i[vs]*s[ps]+i[ys]*s[As]+i[ks]*s[ys],e[ks]=i[bs]*s[ds]+i[vs]*s[gs]+i[ys]*s[xs]+i[ks]*s[ks],this.set(this.temp)}lookAt(t,e,s){let i=Cs.xAxis,n=Cs.yAxis,r=Cs.zAxis;r.setFrom(e).normalize(),i.setFrom(e).normalize(),i.cross(s).normalize(),n.setFrom(i).cross(r).normalize(),this.identity();let a=this.values;return a[hs]=i.x,a[ls]=i.y,a[cs]=i.z,a[us]=n.x,a[ms]=n.y,a[ps]=n.z,a[fs]=-r.x,a[ws]=-r.y,a[As]=-r.z,Cs.tmpMatrix.identity(),Cs.tmpMatrix.values[ds]=-t.x,Cs.tmpMatrix.values[gs]=-t.y,Cs.tmpMatrix.values[xs]=-t.z,this.multiply(Cs.tmpMatrix),this}}os=Cs,(0,a.A)(Cs,"xAxis",new as),(0,a.A)(Cs,"yAxis",new as),(0,a.A)(Cs,"zAxis",new as),(0,a.A)(Cs,"tmpMatrix",new os);class Ss{constructor(t,e){(0,a.A)(this,"position",new as(0,0,0)),(0,a.A)(this,"direction",new as(0,0,-1)),(0,a.A)(this,"up",new as(0,1,0)),(0,a.A)(this,"near",0),(0,a.A)(this,"far",100),(0,a.A)(this,"zoom",1),(0,a.A)(this,"viewportWidth",0),(0,a.A)(this,"viewportHeight",0),(0,a.A)(this,"projectionView",new Cs),(0,a.A)(this,"inverseProjectionView",new Cs),(0,a.A)(this,"projection",new Cs),(0,a.A)(this,"view",new Cs),this.viewportWidth=t,this.viewportHeight=e,this.update()}update(){let t=this.projection,e=this.view,s=this.projectionView,i=this.inverseProjectionView,n=this.zoom,r=this.viewportWidth,a=this.viewportHeight;t.ortho(n*(-r/2),n*(r/2),n*(-a/2),n*(a/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),s.set(t.values),s.multiply(e),i.set(s.values).invert()}screenToWorld(t,e,s){let i=t.x,n=s-t.y-1;return t.x=2*i/e-1,t.y=2*n/s-1,t.z=2*t.z-1,t.project(this.inverseProjectionView),t}worldToScreen(t,e,s){return t.project(this.projectionView),t.x=e*(t.x+1)/2,t.y=s*(t.y+1)/2,t.z=(t.z+1)/2,t}setViewport(t,e){this.viewportWidth=t,this.viewportHeight=e}}class Is{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,a.A)(this,"element",void 0),(0,a.A)(this,"mouseX",0),(0,a.A)(this,"mouseY",0),(0,a.A)(this,"buttonDown",!1),(0,a.A)(this,"touch0",null),(0,a.A)(this,"touch1",null),(0,a.A)(this,"initialPinchDistance",0),(0,a.A)(this,"listeners",new Array),(0,a.A)(this,"autoPreventDefault",void 0),(0,a.A)(this,"isTouch",!1),(0,a.A)(this,"callbacks",void 0),this.element=t,this.autoPreventDefault=e,this.callbacks=this.setupCallbacks(t)}setupCallbacks(t){const e=e=>{if(e instanceof MouseEvent&&!this.isTouch){let s=t.getBoundingClientRect();this.mouseX=e.clientX-s.left,this.mouseY=e.clientY-s.top,this.buttonDown=!0,this.listeners.map(t=>{t.down&&t.down(this.mouseX,this.mouseY,e)})}},s=e=>{if(e instanceof MouseEvent&&!this.isTouch){let s=t.getBoundingClientRect();this.mouseX=e.clientX-s.left,this.mouseY=e.clientY-s.top,this.listeners.map(t=>{this.buttonDown?t.dragged&&t.dragged(this.mouseX,this.mouseY,e):t.moved&&t.moved(this.mouseX,this.mouseY,e)})}},i=e=>{if(e instanceof MouseEvent&&!this.isTouch){let s=t.getBoundingClientRect();this.mouseX=e.clientX-s.left,this.mouseY=e.clientY-s.top,this.buttonDown=!1,this.listeners.map(t=>{t.up&&t.up(this.mouseX,this.mouseY,e)})}},n=t=>{this.autoPreventDefault&&t.preventDefault();let e=t.deltaY;t.deltaMode==WheelEvent.DOM_DELTA_LINE&&(e*=8),t.deltaMode==WheelEvent.DOM_DELTA_PAGE&&(e*=24),this.listeners.map(e=>{e.wheel&&e.wheel(t.deltaY,t)})},r=e=>{if(this.isTouch=!0,!this.touch0||!this.touch1){let s=e.changedTouches.item(0);if(!s)return;let i=t.getBoundingClientRect(),n=s.clientX-i.left,r=s.clientY-i.top,a=new Es(s.identifier,n,r);if(this.mouseX=n,this.mouseY=r,this.buttonDown=!0,this.touch0){if(!this.touch1){this.touch1=a;let t=this.touch1.x-this.touch0.x,s=this.touch1.x-this.touch0.x;this.initialPinchDistance=Math.sqrt(t*t+s*s),this.listeners.map(t=>{t.zoom&&t.zoom(this.initialPinchDistance,this.initialPinchDistance,e)})}}else this.touch0=a,this.listeners.map(t=>{t.down&&t.down(a.x,a.y,e)})}this.autoPreventDefault&&e.preventDefault()},a=e=>{if(this.isTouch=!0,this.touch0){var s=e.changedTouches;let r=t.getBoundingClientRect();for(var i=0;i<s.length;i++){var n=s[i];let t=n.clientX-r.left,a=n.clientY-r.top;this.touch0.identifier===n.identifier&&(this.touch0.x=this.mouseX=t,this.touch0.y=this.mouseY=a,this.listeners.map(s=>{s.dragged&&s.dragged(t,a,e)})),this.touch1&&this.touch1.identifier===n.identifier&&(this.touch1.x=this.mouseX=t,this.touch1.y=this.mouseY=a)}if(this.touch0&&this.touch1){let t=this.touch1.x-this.touch0.x,s=this.touch1.x-this.touch0.x,i=Math.sqrt(t*t+s*s);this.listeners.map(t=>{t.zoom&&t.zoom(this.initialPinchDistance,i,e)})}}this.autoPreventDefault&&e.preventDefault()},o=e=>{if(this.isTouch=!0,this.touch0){var s=e.changedTouches;let r=t.getBoundingClientRect();for(var i=0;i<s.length;i++){var n=s[i];let t=n.clientX-r.left,a=n.clientY-r.top;if(this.touch0.identifier===n.identifier){if(this.touch0=null,this.mouseX=t,this.mouseY=a,this.listeners.map(s=>{s.up&&s.up(t,a,e)}),!this.touch1){this.buttonDown=!1;break}this.touch0=this.touch1,this.touch1=null,this.mouseX=this.touch0.x,this.mouseX=this.touch0.x,this.buttonDown=!0,this.listeners.map(t=>{t.down&&t.down(this.touch0.x,this.touch0.y,e)})}this.touch1&&this.touch1.identifier&&(this.touch1=null)}}this.autoPreventDefault&&e.preventDefault()};return t.addEventListener("mousedown",e,!0),t.addEventListener("mousemove",s,!0),t.addEventListener("mouseup",i,!0),t.addEventListener("wheel",n,!0),t.addEventListener("touchstart",r,{passive:!1,capture:!1}),t.addEventListener("touchmove",a,{passive:!1,capture:!1}),t.addEventListener("touchend",o,{passive:!1,capture:!1}),t.addEventListener("touchcancel",o),{mouseDown:e,mouseMove:s,mouseUp:i,mouseWheel:n,touchStart:r,touchMove:a,touchEnd:o}}dispose(){const t=this.element;t.removeEventListener("mousedown",this.callbacks.mouseDown,!0),t.removeEventListener("mousemove",this.callbacks.mouseMove,!0),t.removeEventListener("mouseup",this.callbacks.mouseUp,!0),t.removeEventListener("wheel",this.callbacks.mouseWheel,!0),t.removeEventListener("touchstart",this.callbacks.touchStart,{capture:!1}),t.removeEventListener("touchmove",this.callbacks.touchMove,{capture:!1}),t.removeEventListener("touchend",this.callbacks.touchEnd,{capture:!1}),t.removeEventListener("touchcancel",this.callbacks.touchEnd),this.listeners.length=0}addListener(t){this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>-1&&this.listeners.splice(e,1)}}class Es{constructor(t,e,s){(0,a.A)(this,"identifier",void 0),(0,a.A)(this,"x",void 0),(0,a.A)(this,"y",void 0),this.identifier=t,this.x=e,this.y=s}}class Ts{getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}constructor(t,e,s){(0,a.A)(this,"vertexShader",void 0),(0,a.A)(this,"fragmentShader",void 0),(0,a.A)(this,"context",void 0),(0,a.A)(this,"vs",null),(0,a.A)(this,"vsSource",void 0),(0,a.A)(this,"fs",null),(0,a.A)(this,"fsSource",void 0),(0,a.A)(this,"program",null),(0,a.A)(this,"tmp2x2",new Float32Array(4)),(0,a.A)(this,"tmp3x3",new Float32Array(9)),(0,a.A)(this,"tmp4x4",new Float32Array(16)),this.vertexShader=e,this.fragmentShader=s,this.vsSource=e,this.fsSource=s,this.context=t instanceof is?t:new is(t),this.context.addRestorable(this),this.compile()}compile(){let t=this.context.gl;try{if(this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}compileShader(t,e){let s=this.context.gl,i=s.createShader(t);if(!i)throw new Error("Couldn't create shader.");if(s.shaderSource(i,e),s.compileShader(i),!s.getShaderParameter(i,s.COMPILE_STATUS)){let t="Couldn't compile shader: "+s.getShaderInfoLog(i);if(s.deleteShader(i),!s.isContextLost())throw new Error(t)}return i}compileProgram(t,e){let s=this.context.gl,i=s.createProgram();if(!i)throw new Error("Couldn't compile program.");if(s.attachShader(i,t),s.attachShader(i,e),s.linkProgram(i),!s.getProgramParameter(i,s.LINK_STATUS)){let t="Couldn't compile shader program: "+s.getProgramInfoLog(i);if(s.deleteProgram(i),!s.isContextLost())throw new Error(t)}return i}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)}setUniformf(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)}setUniform2f(t,e,s){this.context.gl.uniform2f(this.getUniformLocation(t),e,s)}setUniform3f(t,e,s,i){this.context.gl.uniform3f(this.getUniformLocation(t),e,s,i)}setUniform4f(t,e,s,i,n){this.context.gl.uniform4f(this.getUniformLocation(t),e,s,i,n)}setUniform2x2f(t,e){let s=this.context.gl;this.tmp2x2.set(e),s.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}setUniform3x3f(t,e){let s=this.context.gl;this.tmp3x3.set(e),s.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}setUniform4x4f(t,e){let s=this.context.gl;this.tmp4x4.set(e),s.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}getUniformLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=e.getUniformLocation(this.program,t);if(!s&&!e.isContextLost())throw new Error("Couldn't find location for uniform ".concat(t));return s}getAttributeLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=e.getAttribLocation(this.program,t);if(-1==s&&!e.isContextLost())throw new Error("Couldn't find location for attribute ".concat(t));return s}dispose(){this.context.removeRestorable(this);let t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}static newColoredTextured(t){let e="\nattribute vec4 ".concat(Ts.POSITION,";\nattribute vec4 ").concat(Ts.COLOR,";\nattribute vec2 ").concat(Ts.TEXCOORDS,";\nuniform mat4 ").concat(Ts.MVP_MATRIX,";\nvarying vec4 v_color;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_color = ").concat(Ts.COLOR,";\n\tv_texCoords = ").concat(Ts.TEXCOORDS,";\n\tgl_Position = ").concat(Ts.MVP_MATRIX," * ").concat(Ts.POSITION,";\n}\n");return new Ts(t,e,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n}\n")}static newTwoColoredTextured(t){let e="\nattribute vec4 ".concat(Ts.POSITION,";\nattribute vec4 ").concat(Ts.COLOR,";\nattribute vec4 ").concat(Ts.COLOR2,";\nattribute vec2 ").concat(Ts.TEXCOORDS,";\nuniform mat4 ").concat(Ts.MVP_MATRIX,";\nvarying vec4 v_light;\nvarying vec4 v_dark;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_light = ").concat(Ts.COLOR,";\n\tv_dark = ").concat(Ts.COLOR2,";\n\tv_texCoords = ").concat(Ts.TEXCOORDS,";\n\tgl_Position = ").concat(Ts.MVP_MATRIX," * ").concat(Ts.POSITION,";\n}\n");return new Ts(t,e,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_light;\nvarying LOWP vec4 v_dark;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\tgl_FragColor.a = texColor.a * v_light.a;\n\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n}\n")}static newColored(t){let e="\nattribute vec4 ".concat(Ts.POSITION,";\nattribute vec4 ").concat(Ts.COLOR,";\nuniform mat4 ").concat(Ts.MVP_MATRIX,";\nvarying vec4 v_color;\n\nvoid main () {\n\tv_color = ").concat(Ts.COLOR,";\n\tgl_Position = ").concat(Ts.MVP_MATRIX," * ").concat(Ts.POSITION,";\n}\n");return new Ts(t,e,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\n\nvoid main () {\n\tgl_FragColor = v_color;\n}\n")}}(0,a.A)(Ts,"MVP_MATRIX","u_projTrans"),(0,a.A)(Ts,"POSITION","a_position"),(0,a.A)(Ts,"COLOR","a_color"),(0,a.A)(Ts,"COLOR2","a_color2"),(0,a.A)(Ts,"TEXCOORDS","a_texCoords"),(0,a.A)(Ts,"SAMPLER","u_texture");class Ms{getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(t){this.dirtyVertices=!0,this.verticesLength=t}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(t){this.dirtyIndices=!0,this.indicesLength=t}getIndices(){return this.indices}getVertexSizeInFloats(){let t=0;for(var e=0;e<this.attributes.length;e++){t+=this.attributes[e].numElements}return t}constructor(t,e,s,i){(0,a.A)(this,"attributes",void 0),(0,a.A)(this,"context",void 0),(0,a.A)(this,"vertices",void 0),(0,a.A)(this,"verticesBuffer",null),(0,a.A)(this,"verticesLength",0),(0,a.A)(this,"dirtyVertices",!1),(0,a.A)(this,"indices",void 0),(0,a.A)(this,"indicesBuffer",null),(0,a.A)(this,"indicesLength",0),(0,a.A)(this,"dirtyIndices",!1),(0,a.A)(this,"elementsPerVertex",0),this.attributes=e,this.context=t instanceof is?t:new is(t),this.elementsPerVertex=0;for(let n=0;n<e.length;n++)this.elementsPerVertex+=e[n].numElements;this.vertices=new Float32Array(s*this.elementsPerVertex),this.indices=new Uint16Array(i),this.context.addRestorable(this)}setVertices(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}setIndices(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}draw(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(t,e,s,i){let n=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?n.drawElements(e,i,n.UNSIGNED_SHORT,2*s):n.drawArrays(e,s,i),this.unbind(t)}bind(t){let e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);let s=0;for(let i=0;i<this.attributes.length;i++){let n=this.attributes[i],r=t.getAttributeLocation(n.name);e.enableVertexAttribArray(r),e.vertexAttribPointer(r,n.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*s),s+=n.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(t){let e=this.context.gl;for(let s=0;s<this.attributes.length;s++){let i=this.attributes[s],n=t.getAttributeLocation(i.name);e.disableVertexAttribArray(n)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}update(){let t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}class Rs{constructor(t,e,s){(0,a.A)(this,"name",void 0),(0,a.A)(this,"type",void 0),(0,a.A)(this,"numElements",void 0),this.name=t,this.type=e,this.numElements=s}}class Fs extends Rs{constructor(){super(Ts.POSITION,Xs.Float,2)}}class Ys extends Rs{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(Ts.TEXCOORDS+(0==t?"":t),Xs.Float,2)}}class Ls extends Rs{constructor(){super(Ts.COLOR,Xs.Float,4)}}class Bs extends Rs{constructor(){super(Ts.COLOR2,Xs.Float,4)}}var Xs;!function(t){t[t.Float=0]="Float"}(Xs||(Xs={}));class Ps{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10920;if((0,a.A)(this,"context",void 0),(0,a.A)(this,"drawCalls",0),(0,a.A)(this,"isDrawing",!1),(0,a.A)(this,"mesh",void 0),(0,a.A)(this,"shader",null),(0,a.A)(this,"lastTexture",null),(0,a.A)(this,"verticesLength",0),(0,a.A)(this,"indicesLength",0),(0,a.A)(this,"srcColorBlend",void 0),(0,a.A)(this,"srcAlphaBlend",void 0),(0,a.A)(this,"dstBlend",void 0),(0,a.A)(this,"cullWasEnabled",!1),s>10920)throw new Error("Can't have more than 10920 triangles per batch: "+s);this.context=t instanceof is?t:new is(t);let i=e?[new Fs,new Ls,new Ys,new Bs]:[new Fs,new Ls,new Ys];this.mesh=new Ms(t,i,s,3*s);let n=this.context.gl;this.srcColorBlend=n.SRC_ALPHA,this.srcAlphaBlend=n.ONE,this.dstBlend=n.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend),Ps.disableCulling&&(this.cullWasEnabled=e.isEnabled(e.CULL_FACE),this.cullWasEnabled&&e.disable(e.CULL_FACE))}setBlendMode(t,e){const s=Ps.blendModesGL[t],i=e?s.srcRgbPma:s.srcRgb,n=s.srcAlpha,r=s.dstRgb;if(this.srcColorBlend==i&&this.srcAlphaBlend==n&&this.dstBlend==r)return;this.srcColorBlend=i,this.srcAlphaBlend=n,this.dstBlend=r,this.isDrawing&&this.flush(),this.context.gl.blendFuncSeparate(i,r,n,r)}draw(t,e,s){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+s.length>this.mesh.getIndices().length)&&this.flush();let i=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);let n=this.mesh.getIndices();for(let r=this.indicesLength,a=0;a<s.length;r++,a++)n[r]=s[a]+i;this.indicesLength+=s.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){if(0!=this.verticesLength){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++,Ps.globalDrawCalls++}}end(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;let t=this.context.gl;t.disable(t.BLEND),Ps.disableCulling&&this.cullWasEnabled&&t.enable(t.CULL_FACE)}getDrawCalls(){return this.drawCalls}static getAndResetGlobalDrawCalls(){let t=Ps.globalDrawCalls;return Ps.globalDrawCalls=0,t}dispose(){this.mesh.dispose()}}(0,a.A)(Ps,"disableCulling",!1),(0,a.A)(Ps,"globalDrawCalls",0),(0,a.A)(Ps,"blendModesGL",[{srcRgb:770,srcRgbPma:1,dstRgb:771,srcAlpha:1},{srcRgb:770,srcRgbPma:1,dstRgb:1,srcAlpha:1},{srcRgb:774,srcRgbPma:774,dstRgb:771,srcAlpha:1},{srcRgb:1,srcRgbPma:1,dstRgb:769,srcAlpha:1}]);class Vs{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10920;if((0,a.A)(this,"context",void 0),(0,a.A)(this,"isDrawing",!1),(0,a.A)(this,"mesh",void 0),(0,a.A)(this,"shapeType",Ds.Filled),(0,a.A)(this,"color",new h(1,1,1,1)),(0,a.A)(this,"shader",null),(0,a.A)(this,"vertexIndex",0),(0,a.A)(this,"tmp",new u),(0,a.A)(this,"srcColorBlend",void 0),(0,a.A)(this,"srcAlphaBlend",void 0),(0,a.A)(this,"dstBlend",void 0),e>10920)throw new Error("Can't have more than 10920 triangles per batch: "+e);this.context=t instanceof is?t:new is(t),this.mesh=new Ms(t,[new Fs,new Ls],e,0);let s=this.context.gl;this.srcColorBlend=s.SRC_ALPHA,this.srcAlphaBlend=s.ONE,this.dstBlend=s.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=t,this.vertexIndex=0,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(t,e,s){if(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=s,this.isDrawing){this.flush(),this.context.gl.blendFuncSeparate(t,s,e,s)}}setColor(t){this.color.setFromColor(t)}setColorWith(t,e,s,i){this.color.set(t,e,s,i)}point(t,e,s){this.check(Ds.Point,1),s||(s=this.color),this.vertex(t,e,s)}line(t,e,s,i,n){this.check(Ds.Line,2);this.mesh.getVertices(),this.vertexIndex;n||(n=this.color),this.vertex(t,e,n),this.vertex(s,i,n)}triangle(t,e,s,i,n,r,a,o,h,l){this.check(t?Ds.Filled:Ds.Line,3);this.mesh.getVertices(),this.vertexIndex;o||(o=this.color),h||(h=this.color),l||(l=this.color),t?(this.vertex(e,s,o),this.vertex(i,n,h),this.vertex(r,a,l)):(this.vertex(e,s,o),this.vertex(i,n,h),this.vertex(i,n,o),this.vertex(r,a,h),this.vertex(r,a,o),this.vertex(e,s,h))}quad(t,e,s,i,n,r,a,o,h,l,c,d,u){this.check(t?Ds.Filled:Ds.Line,3);this.mesh.getVertices(),this.vertexIndex;l||(l=this.color),c||(c=this.color),d||(d=this.color),u||(u=this.color),t?(this.vertex(e,s,l),this.vertex(i,n,c),this.vertex(r,a,d),this.vertex(r,a,d),this.vertex(o,h,u),this.vertex(e,s,l)):(this.vertex(e,s,l),this.vertex(i,n,c),this.vertex(i,n,c),this.vertex(r,a,d),this.vertex(r,a,d),this.vertex(o,h,u),this.vertex(o,h,u),this.vertex(e,s,l))}rect(t,e,s,i,n,r){this.quad(t,e,s,e+i,s,e+i,s+n,e,s+n,r,r,r,r)}rectLine(t,e,s,i,n,r,a){this.check(t?Ds.Filled:Ds.Line,8),a||(a=this.color);let o=this.tmp.set(n-s,e-i);o.normalize(),r*=.5;let h=o.x*r,l=o.y*r;t?(this.vertex(e+h,s+l,a),this.vertex(e-h,s-l,a),this.vertex(i+h,n+l,a),this.vertex(i-h,n-l,a),this.vertex(i+h,n+l,a),this.vertex(e-h,s-l,a)):(this.vertex(e+h,s+l,a),this.vertex(e-h,s-l,a),this.vertex(i+h,n+l,a),this.vertex(i-h,n-l,a),this.vertex(i+h,n+l,a),this.vertex(e+h,s+l,a),this.vertex(i-h,n-l,a),this.vertex(e-h,s-l,a))}x(t,e,s){this.line(t-s,e-s,t+s,e+s),this.line(t-s,e+s,t+s,e-s)}polygon(t,e,s,i){if(s<3)throw new Error("Polygon must contain at least 3 vertices");this.check(Ds.Line,2*s),i||(i=this.color);this.mesh.getVertices(),this.vertexIndex;s<<=1;let n=t[e<<=1],r=t[e+1],a=e+s;for(let o=e,h=e+s-2;o<h;o+=2){let e=t[o],s=t[o+1],h=0,l=0;o+2>=a?(h=n,l=r):(h=t[o+2],l=t[o+3]),this.vertex(e,s,i),this.vertex(h,l,i)}}circle(t,e,s,i,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(0==r&&(r=Math.max(1,6*l.cbrt(i)|0)),r<=0)throw new Error("segments must be > 0.");n||(n=this.color);let a=2*l.PI/r,o=Math.cos(a),h=Math.sin(a),c=i,d=0;if(t){this.check(Ds.Filled,3*r+3),r--;for(let t=0;t<r;t++){this.vertex(e,s,n),this.vertex(e+c,s+d,n);let t=c;c=o*c-h*d,d=h*t+o*d,this.vertex(e+c,s+d,n)}this.vertex(e,s,n),this.vertex(e+c,s+d,n)}else{this.check(Ds.Line,2*r+2);for(let t=0;t<r;t++){this.vertex(e+c,s+d,n);let t=c;c=o*c-h*d,d=h*t+o*d,this.vertex(e+c,s+d,n)}this.vertex(e+c,s+d,n)}c=i,d=0,this.vertex(e+c,s+d,n)}curve(t,e,s,i,n,r,a,o,h,l){this.check(Ds.Line,2*h+2),l||(l=this.color);let c=1/h,d=c*c,u=c*c*c,m=3*c,p=3*d,g=6*d,f=6*u,w=t-2*s+n,A=e-2*i+r,x=3*(s-n)-t+a,b=3*(i-r)-e+o,v=t,y=e,k=(s-t)*m+w*p+x*u,C=(i-e)*m+A*p+b*u,S=w*g+x*f,I=A*g+b*f,E=x*f,T=b*f;for(;h-- >0;)this.vertex(v,y,l),v+=k,y+=C,k+=S,C+=I,S+=E,I+=T,this.vertex(v,y,l);this.vertex(v,y,l),this.vertex(a,o,l)}vertex(t,e,s){let i=this.vertexIndex,n=this.mesh.getVertices();n[i++]=t,n[i++]=e,n[i++]=s.r,n[i++]=s.g,n[i++]=s.b,n[i++]=s.a,this.vertexIndex=i}end(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();let t=this.context.gl;t.disable(t.BLEND),this.isDrawing=!1}flush(){if(0!=this.vertexIndex){if(!this.shader)throw new Error("No shader set.");this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0}}check(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t}dispose(){this.mesh.dispose()}}var Ds;!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Filled=4]="Filled"}(Ds||(Ds={}));class Os{constructor(t){(0,a.A)(this,"boneLineColor",new h(1,0,0,1)),(0,a.A)(this,"boneOriginColor",new h(0,1,0,1)),(0,a.A)(this,"attachmentLineColor",new h(0,0,1,.5)),(0,a.A)(this,"triangleLineColor",new h(1,.64,0,.5)),(0,a.A)(this,"pathColor",(new h).setFromString("FF7F00")),(0,a.A)(this,"clipColor",new h(.8,0,0,2)),(0,a.A)(this,"aabbColor",new h(0,1,0,.5)),(0,a.A)(this,"drawBones",!0),(0,a.A)(this,"drawRegionAttachments",!0),(0,a.A)(this,"drawBoundingBoxes",!0),(0,a.A)(this,"drawMeshHull",!0),(0,a.A)(this,"drawMeshTriangles",!0),(0,a.A)(this,"drawPaths",!0),(0,a.A)(this,"drawSkeletonXY",!1),(0,a.A)(this,"drawClipping",!0),(0,a.A)(this,"premultipliedAlpha",!1),(0,a.A)(this,"scale",1),(0,a.A)(this,"boneWidth",2),(0,a.A)(this,"context",void 0),(0,a.A)(this,"bounds",new He),(0,a.A)(this,"temp",new Array),(0,a.A)(this,"vertices",c.newFloatArray(2048)),this.context=t instanceof is?t:new is(t)}draw(t,e,s){let i=e.x,n=e.y,r=this.context.gl,a=this.premultipliedAlpha?r.ONE:r.SRC_ALPHA;t.setBlendMode(a,r.ONE,r.ONE_MINUS_SRC_ALPHA);let o=e.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(let e=0,i=o.length;e<i;e++){let i=o[e];if(s&&s.indexOf(i.data.name)>-1)continue;if(!i.parent)continue;let n=i.data.length*i.a+i.worldX,r=i.data.length*i.c+i.worldY;t.rectLine(!0,i.worldX,i.worldY,n,r,this.boneWidth*this.scale)}this.drawSkeletonXY&&t.x(i,n,4*this.scale)}if(this.drawRegionAttachments){t.setColor(this.attachmentLineColor);let s=e.slots;for(let e=0,i=s.length;e<i;e++){let i=s[e],n=i.getAttachment();if(n instanceof Ot){let e=n,s=this.vertices;e.computeWorldVertices(i,s,0,2),t.line(s[0],s[1],s[2],s[3]),t.line(s[2],s[3],s[4],s[5]),t.line(s[4],s[5],s[6],s[7]),t.line(s[6],s[7],s[0],s[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let s=e.slots;for(let e=0,i=s.length;e<i;e++){let i=s[e];if(!i.bone.active)continue;let n=i.getAttachment();if(!(n instanceof Pt))continue;let r=n,a=this.vertices;r.computeWorldVertices(i,0,r.worldVerticesLength,a,0,2);let o=r.triangles,h=r.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(let e=0,s=o.length;e<s;e+=3){let s=2*o[e],i=2*o[e+1],n=2*o[e+2];t.triangle(!1,a[s],a[s+1],a[i],a[i+1],a[n],a[n+1])}}if(this.drawMeshHull&&h>0){t.setColor(this.attachmentLineColor),h=2*(h>>1);let e=a[h-2],s=a[h-1];for(let i=0,n=h;i<n;i+=2){let n=a[i],r=a[i+1];t.line(n,r,e,s),e=n,s=r}}}}if(this.drawBoundingBoxes){let s=this.bounds;s.update(e,!0),t.setColor(this.aabbColor),t.rect(!1,s.minX,s.minY,s.getWidth(),s.getHeight());let i=s.polygons,n=s.boundingBoxes;for(let e=0,r=i.length;e<r;e++){let s=i[e];t.setColor(n[e].color),t.polygon(s,0,s.length)}}if(this.drawPaths){let s=e.slots;for(let e=0,i=s.length;e<i;e++){let i=s[e];if(!i.bone.active)continue;let n=i.getAttachment();if(!(n instanceof Vt))continue;let r=n,a=r.worldVerticesLength,o=this.temp=c.setArraySize(this.temp,a,0);r.computeWorldVertices(i,0,a,o,0,2);let h=this.pathColor,l=o[2],d=o[3],u=0,m=0;if(r.closed){t.setColor(h);let e=o[0],s=o[1],i=o[a-2],n=o[a-1];u=o[a-4],m=o[a-3],t.curve(l,d,e,s,i,n,u,m,32),t.setColor(Os.LIGHT_GRAY),t.line(l,d,e,s),t.line(u,m,i,n)}a-=4;for(let e=4;e<a;e+=6){let s=o[e],i=o[e+1],n=o[e+2],r=o[e+3];u=o[e+4],m=o[e+5],t.setColor(h),t.curve(l,d,s,i,n,r,u,m,32),t.setColor(Os.LIGHT_GRAY),t.line(l,d,s,i),t.line(u,m,n,r),l=u,d=m}}}if(this.drawBones){t.setColor(this.boneOriginColor);for(let e=0,i=o.length;e<i;e++){let i=o[e];s&&s.indexOf(i.data.name)>-1||t.circle(!0,i.worldX,i.worldY,3*this.scale,this.boneOriginColor,8)}}if(this.drawClipping){let s=e.slots;t.setColor(this.clipColor);for(let e=0,i=s.length;e<i;e++){let i=s[e];if(!i.bone.active)continue;let n=i.getAttachment();if(!(n instanceof bt))continue;let r=n,a=r.worldVerticesLength,o=this.temp=c.setArraySize(this.temp,a,0);r.computeWorldVertices(i,0,a,o,0,2);for(let e=0,s=o.length;e<s;e+=2){let s=o[e],i=o[e+1],n=o[(e+2)%o.length],r=o[(e+3)%o.length];t.line(s,i,n,r)}}}}dispose(){}}(0,a.A)(Os,"LIGHT_GRAY",new h(192/255,192/255,192/255,1)),(0,a.A)(Os,"GREEN",new h(0,1,0,1));class Ns{constructor(t,e,s){(0,a.A)(this,"vertices",void 0),(0,a.A)(this,"numVertices",void 0),(0,a.A)(this,"numFloats",void 0),this.vertices=t,this.numVertices=e,this.numFloats=s}}class Us{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,a.A)(this,"premultipliedAlpha",!1),(0,a.A)(this,"tempColor",new h),(0,a.A)(this,"tempColor2",new h),(0,a.A)(this,"vertices",void 0),(0,a.A)(this,"vertexSize",8),(0,a.A)(this,"twoColorTint",!1),(0,a.A)(this,"renderable",new Ns([],0,0)),(0,a.A)(this,"clipper",new Je),(0,a.A)(this,"temp",new u),(0,a.A)(this,"temp2",new u),(0,a.A)(this,"temp3",new h),(0,a.A)(this,"temp4",new h),this.twoColorTint=e,e&&(this.vertexSize+=4),this.vertices=c.newFloatArray(1024*this.vertexSize)}draw(t,e){let s,i,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=this.clipper,l=this.premultipliedAlpha,d=this.twoColorTint,u=null,m=this.renderable,p=e.drawOrder,g=e.color,f=d?12:8,w=!1;-1==r&&(w=!0);for(let A=0,x=p.length;A<x;A++){let e=h.isClipping()?2:f,x=p[A];if(!x.bone.active){h.clipEndWithSlot(x);continue}if(r>=0&&r==x.data.index&&(w=!0),!w){h.clipEndWithSlot(x);continue}a>=0&&a==x.data.index&&(w=!1);let b,v=x.getAttachment();if(v instanceof Ot){let t=v;m.vertices=this.vertices,m.numVertices=4,m.numFloats=e<<2,t.computeWorldVertices(x,m.vertices,0,e),i=Us.QUAD_TRIANGLES,s=t.uvs,b=t.region.texture,n=t.color}else{if(!(v instanceof Pt)){if(v instanceof bt){let t=v;h.clipStart(x,t);continue}h.clipEndWithSlot(x);continue}{let t=v;m.vertices=this.vertices,m.numVertices=t.worldVerticesLength>>1,m.numFloats=m.numVertices*e,m.numFloats>m.vertices.length&&(m.vertices=this.vertices=c.newFloatArray(m.numFloats)),t.computeWorldVertices(x,0,t.worldVerticesLength,m.vertices,0,e),i=t.triangles,b=t.region.texture,s=t.uvs,n=t.color}}if(b){let e=x.color,r=this.tempColor;r.r=g.r*e.r*n.r,r.g=g.g*e.g*n.g,r.b=g.b*e.b*n.b,r.a=g.a*e.a*n.a,l&&(r.r*=r.a,r.g*=r.a,r.b*=r.a);let a=this.tempColor2;x.darkColor?(l?(a.r=x.darkColor.r*r.a,a.g=x.darkColor.g*r.a,a.b=x.darkColor.b*r.a):a.setFromColor(x.darkColor),a.a=l?1:0):a.set(0,0,0,1);let c=x.data.blendMode;if(c!=u&&(u=c,t.setBlendMode(u,l)),h.isClipping()){h.clipTriangles(m.vertices,i,i.length,s,r,a,d);let e=new Float32Array(h.clippedVertices),n=h.clippedTriangles;o&&o(e,e.length,f),t.draw(b,e,n)}else{let e=m.vertices;if(d)for(let t=2,i=0,o=m.numFloats;t<o;t+=f,i+=2)e[t]=r.r,e[t+1]=r.g,e[t+2]=r.b,e[t+3]=r.a,e[t+4]=s[i],e[t+5]=s[i+1],e[t+6]=a.r,e[t+7]=a.g,e[t+8]=a.b,e[t+9]=a.a;else for(let t=2,i=0,a=m.numFloats;t<a;t+=f,i+=2)e[t]=r.r,e[t+1]=r.g,e[t+2]=r.b,e[t+3]=r.a,e[t+4]=s[i],e[t+5]=s[i+1];let n=m.vertices.subarray(0,m.numFloats);o&&o(m.vertices,m.numFloats,f),t.draw(b,n,i)}}h.clipEndWithSlot(x)}h.clipEnd()}getSkeletonClipping(){return this.clipper}}(0,a.A)(Us,"QUAD_TRIANGLES",[0,1,2,2,3,0]);const Ws=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],zs=[0,1,2,2,3,0],qs=new h(1,1,1,1);class Gs{constructor(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,a.A)(this,"context",void 0),(0,a.A)(this,"canvas",void 0),(0,a.A)(this,"camera",void 0),(0,a.A)(this,"batcher",void 0),(0,a.A)(this,"twoColorTint",!1),(0,a.A)(this,"batcherShader",void 0),(0,a.A)(this,"shapes",void 0),(0,a.A)(this,"shapesShader",void 0),(0,a.A)(this,"activeRenderer",null),(0,a.A)(this,"skeletonRenderer",void 0),(0,a.A)(this,"skeletonDebugRenderer",void 0),this.canvas=t,this.context=e instanceof is?e:new is(e),this.twoColorTint=s,this.camera=new Ss(t.width,t.height),this.batcherShader=s?Ts.newTwoColoredTextured(this.context):Ts.newColoredTextured(this.context),this.batcher=new Ps(this.context,s),this.shapesShader=Ts.newColored(this.context),this.shapes=new Vs(this.context),this.skeletonRenderer=new Us(this.context,s),this.skeletonDebugRenderer=new Os(this.context)}dispose(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()}begin(){this.camera.update(),this.enableRenderer(this.batcher)}drawSkeleton(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=e,this.skeletonRenderer.draw(this.batcher,t,s,i,n)}drawSkeletonDebug(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0;this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=e,this.skeletonDebugRenderer.draw(this.shapes,t,s)}drawTexture(t,e,s,i,n,r){this.enableRenderer(this.batcher),r||(r=qs);var a=0;Ws[a++]=e,Ws[a++]=s,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=0,Ws[a++]=1,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a++]=0),Ws[a++]=e+i,Ws[a++]=s,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=1,Ws[a++]=1,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a++]=0),Ws[a++]=e+i,Ws[a++]=s+n,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=1,Ws[a++]=0,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a++]=0),Ws[a++]=e,Ws[a++]=s+n,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=0,Ws[a++]=0,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a]=0),this.batcher.draw(t,Ws,zs)}drawTextureUV(t,e,s,i,n,r,a,o,h,l){this.enableRenderer(this.batcher),l||(l=qs);var c=0;Ws[c++]=e,Ws[c++]=s,Ws[c++]=l.r,Ws[c++]=l.g,Ws[c++]=l.b,Ws[c++]=l.a,Ws[c++]=r,Ws[c++]=a,this.twoColorTint&&(Ws[c++]=0,Ws[c++]=0,Ws[c++]=0,Ws[c++]=0),Ws[c++]=e+i,Ws[c++]=s,Ws[c++]=l.r,Ws[c++]=l.g,Ws[c++]=l.b,Ws[c++]=l.a,Ws[c++]=o,Ws[c++]=a,this.twoColorTint&&(Ws[c++]=0,Ws[c++]=0,Ws[c++]=0,Ws[c++]=0),Ws[c++]=e+i,Ws[c++]=s+n,Ws[c++]=l.r,Ws[c++]=l.g,Ws[c++]=l.b,Ws[c++]=l.a,Ws[c++]=o,Ws[c++]=h,this.twoColorTint&&(Ws[c++]=0,Ws[c++]=0,Ws[c++]=0,Ws[c++]=0),Ws[c++]=e,Ws[c++]=s+n,Ws[c++]=l.r,Ws[c++]=l.g,Ws[c++]=l.b,Ws[c++]=l.a,Ws[c++]=r,Ws[c++]=h,this.twoColorTint&&(Ws[c++]=0,Ws[c++]=0,Ws[c++]=0,Ws[c]=0),this.batcher.draw(t,Ws,zs)}drawTextureRotated(t,e,s,i,n,r,a,o,h){this.enableRenderer(this.batcher),h||(h=qs);let c=e+r,d=s+a,u=-r,m=-a,p=i-r,g=n-a,f=u,w=m,A=u,x=g,b=p,v=g,y=p,k=m,C=0,S=0,I=0,E=0,T=0,M=0,R=0,F=0;if(0!=o){let t=l.cosDeg(o),e=l.sinDeg(o);C=t*f-e*w,S=e*f+t*w,R=t*A-e*x,F=e*A+t*x,T=t*b-e*v,M=e*b+t*v,I=T+(C-R),E=M+(S-F)}else C=f,S=w,R=A,F=x,T=b,M=v,I=y,E=k;C+=c,S+=d,I+=c,E+=d,T+=c,M+=d,R+=c,F+=d;var Y=0;Ws[Y++]=C,Ws[Y++]=S,Ws[Y++]=h.r,Ws[Y++]=h.g,Ws[Y++]=h.b,Ws[Y++]=h.a,Ws[Y++]=0,Ws[Y++]=1,this.twoColorTint&&(Ws[Y++]=0,Ws[Y++]=0,Ws[Y++]=0,Ws[Y++]=0),Ws[Y++]=I,Ws[Y++]=E,Ws[Y++]=h.r,Ws[Y++]=h.g,Ws[Y++]=h.b,Ws[Y++]=h.a,Ws[Y++]=1,Ws[Y++]=1,this.twoColorTint&&(Ws[Y++]=0,Ws[Y++]=0,Ws[Y++]=0,Ws[Y++]=0),Ws[Y++]=T,Ws[Y++]=M,Ws[Y++]=h.r,Ws[Y++]=h.g,Ws[Y++]=h.b,Ws[Y++]=h.a,Ws[Y++]=1,Ws[Y++]=0,this.twoColorTint&&(Ws[Y++]=0,Ws[Y++]=0,Ws[Y++]=0,Ws[Y++]=0),Ws[Y++]=R,Ws[Y++]=F,Ws[Y++]=h.r,Ws[Y++]=h.g,Ws[Y++]=h.b,Ws[Y++]=h.a,Ws[Y++]=0,Ws[Y++]=0,this.twoColorTint&&(Ws[Y++]=0,Ws[Y++]=0,Ws[Y++]=0,Ws[Y]=0),this.batcher.draw(t,Ws,zs)}drawRegion(t,e,s,i,n,r){this.enableRenderer(this.batcher),r||(r=qs);var a=0;Ws[a++]=e,Ws[a++]=s,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=t.u,Ws[a++]=t.v2,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a++]=0),Ws[a++]=e+i,Ws[a++]=s,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=t.u2,Ws[a++]=t.v2,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a++]=0),Ws[a++]=e+i,Ws[a++]=s+n,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=t.u2,Ws[a++]=t.v,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a++]=0),Ws[a++]=e,Ws[a++]=s+n,Ws[a++]=r.r,Ws[a++]=r.g,Ws[a++]=r.b,Ws[a++]=r.a,Ws[a++]=t.u,Ws[a++]=t.v,this.twoColorTint&&(Ws[a++]=0,Ws[a++]=0,Ws[a++]=0,Ws[a]=0),this.batcher.draw(t.page.texture,Ws,zs)}line(t,e,s,i,n,r){this.enableRenderer(this.shapes),this.shapes.line(t,e,s,i,n)}triangle(t,e,s,i,n,r,a,o,h,l){this.enableRenderer(this.shapes),this.shapes.triangle(t,e,s,i,n,r,a,o,h,l)}quad(t,e,s,i,n,r,a,o,h,l,c,d,u){this.enableRenderer(this.shapes),this.shapes.quad(t,e,s,i,n,r,a,o,h,l,c,d,u)}rect(t,e,s,i,n,r){this.enableRenderer(this.shapes),this.shapes.rect(t,e,s,i,n,r)}rectLine(t,e,s,i,n,r,a){this.enableRenderer(this.shapes),this.shapes.rectLine(t,e,s,i,n,r,a)}polygon(t,e,s,i){this.enableRenderer(this.shapes),this.shapes.polygon(t,e,s,i)}circle(t,e,s,i,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.enableRenderer(this.shapes),this.shapes.circle(t,e,s,i,n,r)}curve(t,e,s,i,n,r,a,o,h,l){this.enableRenderer(this.shapes),this.shapes.curve(t,e,s,i,n,r,a,o,h,l)}end(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null}resize(t){let e=this.canvas;var s=window.devicePixelRatio||1,i=Math.round(e.clientWidth*s),n=Math.round(e.clientHeight*s);if(e.width==i&&e.height==n||(e.width=i,e.height=n),this.context.gl.viewport(0,0,e.width,e.height),t===_s.Expand)this.camera.setViewport(i,n);else if(t===_s.Fit){let t=e.width,s=e.height,i=this.camera.viewportWidth,n=this.camera.viewportHeight,r=n/i<s/t?i/t:n/s;this.camera.setViewport(t*r,s*r)}this.camera.update()}enableRenderer(t){this.activeRenderer!==t&&(this.end(),t instanceof Ps?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Ts.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):t instanceof Vs?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Ts.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)}}var _s;let js,Hs;!function(t){t[t.Stretch=0]="Stretch",t[t.Expand=1]="Expand",t[t.Fit=2]="Fit"}(_s||(_s={}));let Zs=0;const Js=165,Ks=108,Qs=163;class $s{constructor(t){if((0,a.A)(this,"renderer",void 0),(0,a.A)(this,"logo",null),(0,a.A)(this,"spinner",null),(0,a.A)(this,"angle",0),(0,a.A)(this,"fadeOut",0),(0,a.A)(this,"fadeIn",0),(0,a.A)(this,"timeKeeper",new m),(0,a.A)(this,"backgroundColor",new h(.135,.135,.135,1)),(0,a.A)(this,"tempColor",new h),this.renderer=t,this.timeKeeper.maxDelta=9,!Hs){let t=navigator.userAgent.indexOf("Safari")>-1,e=()=>Zs++;Hs=new Image,Hs.src=ei,t||(Hs.crossOrigin="anonymous"),Hs.onload=e,js=new Image,js.src=ti,t||(js.crossOrigin="anonymous"),js.onload=e}}dispose(){var t,e;null===(t=this.logo)||void 0===t||t.dispose(),null===(e=this.spinner)||void 0===e||e.dispose()}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(Zs<2||t&&this.fadeOut>1)return;this.timeKeeper.update();let e=Math.abs(Math.sin(this.timeKeeper.totalTime+.25));this.angle-=200*this.timeKeeper.delta*(1+1.5*Math.pow(e,5));let s=this.tempColor,i=this.renderer,n=i.canvas,r=i.context.gl;if(i.resize(_s.Expand),i.camera.position.set(n.width/2,n.height/2,0),i.batcher.setBlendMode(Mt.Normal,!0),t){if(this.fadeOut+=this.timeKeeper.delta*(this.timeKeeper.totalTime<1?2:1),this.fadeOut>1)return;s.setFromColor(this.backgroundColor),e=1-this.fadeOut/1,e=1-(e-1)*(e-1),s.a*=e,s.a>0&&(i.camera.zoom=1,i.begin(),i.quad(!0,0,0,n.width,0,n.width,n.height,0,n.height,s,s,s,s),i.end())}else this.fadeIn+=this.timeKeeper.delta,this.backgroundColor.a>0&&(r.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a),r.clear(r.COLOR_BUFFER_BIT)),e=1;e*=Math.min(this.fadeIn/1,1),s.set(e,e,e,e),this.logo||(this.logo=new ns(i.context,Hs),this.spinner=new ns(i.context,js)),i.camera.zoom=Math.max(1,Qs/n.height),i.begin(),i.drawTexture(this.logo,(n.width-Js)/2,(n.height-Ks)/2,Js,Ks,s),this.spinner&&i.drawTextureRotated(this.spinner,(n.width-Qs)/2,(n.height-Qs)/2,Qs,Qs,81.5,81.5,this.angle,s),i.end()}drawInCoordinates(t,e){if(Zs<2)return;this.timeKeeper.update();let s=this.renderer;s.batcher.setBlendMode(Mt.Normal,!0),this.logo||(this.logo=new ns(s.context,Hs),this.spinner=new ns(s.context,js));const i=t-82.5,n=e-54;s.drawTexture(this.logo,i,n,Js,Ks),this.angle-=500*this.timeKeeper.delta,this.spinner&&s.drawTextureRotated(this.spinner,i,n-25,Qs,Qs,81.5,81.5,this.angle)}}let ti="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKMAAACjCAYAAADmbK6AAAALKElEQVR42u2de2iW5R/GPzuqcwfnnKfNmafl5tTNHWzqNi3DEMQykcAoJSsySkspjSIk0iD/07Kf4R+FnVBDUTshZGpWUEJaaiWFgZlUFmXmIe3HNXthyebeZ77P9H13ffBG8Y8H7ut7vff93N/7fu4vGGPiFZiez/Qtw9lytJajfzfw9z/j+efPOv7cV8W+lUNY2a8T/ayTCRsWFLJA5rtUO1LLkV5p9LJeJizQiHeqnlOtmVFtdTGrrZkJCxYXsTgaI6r9MY4/UpNItW4mFDaXsTlaM6qVZlBq3UwofFrJp0HMWJ9DvXUzobCznJ1BzFjWlTLrZkJh/TDWBzFjTgo51s2EgnKI0Rrx+FiOWzNzVaym91Syx5qZsGBWb2ZFa0ZN6dbMhAWTcpkUrRmXD2K5NTNhgVbH0Zpxbl/mWjMTFvRIo0e0ZpzcncnWzISKtvmiMWNRJ4qslwmVXRXsas2Ix8ZwzFqZsGFREYtaM+Oaa1ljrUzYkJ9G/ok6TlzKjJWZVFor0y7c1Zu7WjLiqiGsskamXdHopyT4vALmzS9k/t19uHtKHlOSIMn6xAtARjIZ1sFcUSZ0Y4La+G6M18hS2IlCn4a+WoC0JNL0d/dUupdnUj40g6EJ2VEdMnhrOG/p5f/jUXz8SgmvaGU6KpNRNsLVQV0OdXf24s63h/P2gWoOrBjMCr2GJFQnnxnIM3q5P1PPmaYv+4ev4/C6UtbpV2gzXCkgL5W8Bwt48OIc6ul6Tp+s4+SyASxLiI4+PYCn1bHzDZxvaQW6vZzto7MYnQIpNkf7kp5EuozYUroqEjcNKHHd0Tl9mBPN1pk+hFeieGBnBtog7UXjsj9pWg+m6duecw2cay1OC/uxMC47KmP9OIYfoz1YoC20J/rzRG4quTZK2EAyJGs20qwUbYw0aNRmUxtvfUW/uEtNzc1NB1/X8LVyd15hh82F43AvD+VlXcsSJEZa1CQ3ejleAO7oxR3RDP0XN91X4+NXYb8nkv7UNTwV7e0YTdu7I3g33t7tuaEbNwSZpps2fSyvs4M2Tjhot+jb0Xzbltj8r5j/xVt/6Z1Ob93U1ZYO691EhhzchcHeXosVjcNZysyezLw4xRZt05R+fTeuj8vOj+zKyG0j2aZcVVs6v+QalnjrMFZASQYl2nBoSyz06e3j/Xk8rgWYmMvEICu2pm1HOTuc7okV8FgRj0XukwzanhvCc/F+72TjoQjdObN1OFuDLmh0xP+WHtxiI10ukJlCprb4guiv1fP+avZrS1C7NAkliHZjDtZwMMgqbukAltpMlwuMy2FcEBPqvfLLar5Uqi0hBdEwryy+Mv5n6zkbjTBa+dlMlwvUZFETZKGiFM7tvbhdJ3gSVRO0wzIjnxmvl/J6a6JsGMYGrahtpssFeqbR841S3mhN80OjOaSDEdqd6SjaMKgzgzRK7q1ib3PT9sYyNo7JZoyNFNvRcVMZmy7WOvIuryv/Zvdmdt90+nY0bRp3AvROohFwdwW7dTG7RFlbwlqdrbOBYg005NAQmZU0HWt1rXMBH1Xw0dQ8pmqzoaPmdhun7bHZjNVe9qP9eFQfO1VkUmHjhAVUZ1GtnKFSbjrkrPfy4i4UW5t/6ZxM54J0CqxFe81KpGsQyE4h23oYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjLna+bdOy+IiFquIpGq16Pb79cNYv3IIK/X/ugx+Ui6TVKvYVU9Nc8gX8od8Ir/IN/KPfCQ/yVfyl/6/pfJvLChkQdD6wyqntquCXYuKWJSfRr6D0dEAxV3xlw/khyD+kd/ku/88cHo+09tS3LBpO1HHCVUqcIA6CqB4K+6X6x35L/JM2loXurlWmUmlA5XogOIcK8/If5HncrSWo7F6cKIWPjT/RXGOlWfkv8hzaWsN4uaaysE6WIkOKM6x8oz8F3kusXqo2vxC5jtYiQ4ozrH0TeS5qIZcrB7qkrwdA8U5Vp6R/yLPZV8V+2L14Cl5THGwEh1QnGPlGfkv8lyUlIzFQ1cNYVVHrcjZ0VCcFe9Y+Eb+izy3ceclUl43aFN52DXXssYpnY6a4qFS8ZcP2uIf+e7inRh6pdFrdTGrm8uiHx/L8T2V7NGWzvJBLJ/bl7mTuzO5qBNFDoiJID/IF/KHfCK/yDfyT3O7d/KbfNfS80hNIrU0g9L6HOq1x5iTQo6FNpeLfCQ/yVfyl3xmXYwxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHNk9z4JwJ0SqKTdQkbyEwhU393T6V7zzR6pieR3tE1ITeVXImhe6BXDGZFdRbVeank2TBhcaEMr0rwbixj49IBLL2/L/ffmMuNHfqO9tFZjJYBd1ewO3Lx+IcVfKhqna5nHZYR6XFPH+5R3eeI5t9fx/fvjeC9Jdew5OKZKqFR/RDVKL6vL/f9PJafmyvHsL+a/ff24V6NmjZQbGchVbY6UM2BluqHv1rCqzVZ1KQlkZboepCdQvacPsz5bjTfXao+yMEaDt7Wk9tSIMVGig3TejCtJSM2bSpkPjWPqd1S6Zao+lORSYWmgkOjORRNwZqd5ezMSiHLRooNr5XwWjS6/1XHX9vL2T67N7M1iyXa9JCrYjVrS1gbpJyw6hBfsmiNCYT0P9/A+Wj1/6qGr5YNYFlJBiWJogEzezLz/ZG8/9s4fgtSyuvNYbyp1IONFBtu7sHNv4/j9yAxUHWrdaWsG9+N8XHd+YxkMpSy+aySz841cC5oXbmHCnnI74yxAgZ3YbDeB4PEQCOpBpFNZWwa2ZWRcdnxLsl00crtRB0n2lLg8JNRfDKoM4NsolgBSmw/UMADba1+qpmqfyf6x1u/0a/og3I+aEunP6/i86osqmygcGarF4p54dex/Bo0LqfqOfVwIQ/HW5/RSkwV1oN2WLlHTc82TljAwM4M1O5LWwYKZTjibYXNS0N5KcjKTe10PadfLObFuJwK4ozp+UzXDBTUjL+M5ZcBnRkQV53dMIwNQTu6bSTbVEzbi5awuVByd2E/FgaN0Tc1fKOzBHHV2aAdVSdv6s5NNkp7cSH/++xAng2yyHx+CM/H21YhfdPp+0U1X0TbSZnXx8faG9Aop0MS0cToh1p+iLcpOkLj9t/JOk5eqoPHxnDsyf486an5yqCDK7XZ1O4oZ4dWyy3FSXHUAYq47uyYbMZoGmhpG3DlEFb6uNiVBhpyaHhnBO8oJmfqOROJjzIiP43hJ8UxITqqX56S2Hur2KsOnq3nrE6PPNKPRwrSKbAZrjTQNZmuE7oxYXMZmxWbw9dxWFu4W4ezVedOE6qzI7oyYkY+M7TPeWsPbk2UX1qioSN+E3OZqOR2cReKE+qQRFN0Pi7y73g/UawU1KzezJpXwLz5hczX1ueUPKYkNb6GJQZ+j7/aAfRZREsv+quGsMoamXZBW2Gt5eU0alorEzYsKmJRa/m4NdeyxlqZsCGa84DKnVorEzboC7podis69DfIJmwufHMc7famvvmxZiYsKOtKWbRm1OcW1syEBboSJFozLh/EcmtmwgIluaM14/phrLdmJixYXMTiaM24p5I91syEBTphFOR7Y2tmwgJNvUFOr+tov3UzoaAv44KYUatv62ZCoemdhtG0+hzqrZsJBR08DWLG0gxKrZu50qvpxos3U5NItW4mFPp1ot+lPlpq2lYXs9qamVBZUMiC1ox4pJYjvlfStAu6GmTLcLboMtPIV4/6im5fFfuUi9QIap2MiWP+D96R1vPmsD/fAAAAAElFTkSuQmCC",ei="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKUAAABsCAYAAAALzHKmAAAQ7klEQVR42u3da4xdVRUA4D0zd2Y6nZY59DVtZ1puS9+lzC0YAi2UQ8AAQczFpPgA9VIeIQbirRqJ0cBUBVGjDr/QCKSNRSMmpuODxAdxqhgwxkhFjf6Sxh/+UUNVNGJCzR7uTvas7LXX2q9zzp3em6y0gTN3Zu75utZe5+yztxC9V+/Ve5X9En1Vjd7J6SFbLNF7naPw+l2jh7YHMBWssqMHtlsRdim4qsLtIawaPiHEQOLoNrA9iIkQDnRrVA1qD2LZ8ISoxYqKo13sQAtBWBayQWZUAXGRQM9JjCngDVY0UqJNDbQrMcaGmArdUKpIjbYiQLsCZCyIMQBy8QwnilR4Q5AuCpxFYvRFmBLbEiwKwpsSaWycVQGZBKMrwBjA9BhxDe57u2L2hOoKNCbOrgAZitEVYUxoKSMErQvSxYIzCkguRg5EF4AUhqUlhy/YUKSxcRaKsioYOQhD4I0yYxkR3PcJBcuFysmgsXAWBTMJyBCMIQh9kGGxXIXvexCQXbHGAMrBWTbM2CCpMSMLIxehC77lSJwXGth7M0FzoVJIXXDWQnGmhOkL0ic7YhhtWdGGkAuPAjUWGoF4faCmwBkbZmyUqUCyMqMLRA4+E6IsdTjidUHKBYrh9CnpRcH0ypKxsyOGEYNIIeTCOz91OIJ1QYoB5eAMyZo+MFNnyVTZ0YiRC9EGEMOyAgshxErHsL2XK1gOUgwohtM1a5YNM7Rsu4K0ZkcbRm4mpPBRwFZ5hg9eCqkrUB+csWGGogzNkqEgrdnRhpGLkINudaLgwvVB6oqzCjCTZElb2Y4B0gUjBtEG0ARnDRLjjoG9DwcshtQGlIPTljVjwUySLWNkyRCQVHa0ZUUTRAwgF91a33BEy0VKAcVwwqwZC2bqbOlUurllOxQkJzNyINoAYqjWhYYjWg5SCiiG05Q1U8FMjTIoS8YE6YORi1BHtJ4KIcQEEtTXUWAxpK44YVlPBdO1jCdFWTZIE8bVGEYMIRPcZGBw4HKQcoBiOE1ZMzbMgVQwU6JMAdKEEcuIJogUvg1YCCE2gsCO42DlIIVAKZwpYJaSLVNnSU6XjYHUmxhTmXaFaMO3EYkLqMC+FsLlIoVAKZzMrEnBhJeLfLNlKMrYWRIDCbOkFSSVHbHM6AKRC6/ODUewNqQ+OLlZkxpjUmV8MBbMUJSxyzY3Q1IgTRgxiBRCHdem0KDAUkBh9sRwwjEnAXMMgTnKhFlUtiwkS5rGka4g9SaGgxFmRC7AzTCEEBcyA36dDSsXqAtOLkysjGMwY5XxVChjZ0kuSCo7YlkRQsQQYtDEFsegsLoCxUp7Kpgps2UslFGzJGccSYHUmxhOZqwzEZqAbfUMCisHKIZzgsCpl3MTzMwTpi1bYp2477gyFKUxS7qWbdjY2EBS2dGE0QQRA7gNCyHEdhjE8RhUDlBT9tzgmjWZMFNlSy+Urk1OzCyJlW0XkK4YOQh1cDtcgwBrQmoDWkdgboBZE8mYsJSHlnFbJ+5bwmOPJ7lZkirbC8aRsMvmgtTHjBhGE0QbwJ2egUE1ITVlUC5OmDVdYNrKuN70xM6WoShjlW4464dbtiFIWK6x7GjESEHUUe0iYncnbMdQSE0Z1ITTNOb0hRmjjLtmS9dmJ2rp1jtuKktyyrb6YLEMCUHq2dGG0QQRQ7f72kzc+cJecerne8Wvv7JNPHPvenEkz8Sh3UtFc92QyGt9Yko/HgOLAIUZlItTz5ouMF3KuE+2jFLCQ1D6lm6fLMkBacuOJowYRBUXyfjuHjF3NhdnsfjvAfH6E9vFt9XxKgikEKgJZyyYalzOLeMu2bLbULI6bh+QGwmQ+rgRlumdGEQAao+K56bEL2woVUwOiev0r8OAUjiJrMmFCbvykGxZRAmPitK1dHM7bohyMsuyi/I8f0+e57fJYIKEZXpXo9E4mOf5XTKyLLvCBLETF8uY2SKepkC+dpX4T02Ivepr4HvZcOZ5fmee54fyPL+DmTUhzAs6n4n8bN5dr9f3YdkSg8nsxG0lPBVKVpNjG0/aGhzfLDmRZdnumZmZp8+c+cdZPV555fSr7Xb7s0jJ3i5Pcue4MxKkPPkvvXTqz/B92u32l0wYOzG1fkhcd/py8Rcbyq/vFM/KY1WA95h/3zzP71bfU6JsNpsfgj+P/FlbrdaDGExYyuXvLz8H+DudODH700ajcSM3W6Yu4alQ1spCOTd38jcKocTZbh9+9NixY99XJ8AEUkcpo9W64yH197m5k7+bnZ19QT+J09NHntQhwji/Jg58qi6++ofLxJ8gSFneVw2Ka4QQDfh1Ok4dZavVmtZ/nrm5k7/Vf55O1tRhboUw5+ZOvqyOl5+R/FyOHj32PYVU/tloNG5IXcKrhJIzngwp3fNjomazea/64BuNxts646f50lWv169utw9/DmtqdJQyZFaSJVuV6nq9fqMEof5/vV6/CYBqgJDlee+yAbF/+4i4ZWqZeNfaIfHWzn+Hx0KcEuU9+s8jv3ej0bhVlXOZydX/k0iRMeb8P0D5e6tj8zy/Xb9UJIc56h/yqVOnXul8lmuZ2bJslKmbHG7XrbpCmCXFRLvdfqQD6jTS3Jiy5I4OykM6ADV+1Eu1DmV6evopBORexzDi1L+X/HnGxsb2w3Hm9PSRJ9QxWPOTZdmlKht2hi+w6dkox5bqffI8fye3hDteGqKaHVsHXihKl0tB+h0cY+lute54AGRKDCW89LNTRynHb7ChUWVVjetOnJh9EYBUyPZeNCoOtsbFQwdXi4/esELcd+tq8cCHJ8UXp+viy9efLz7AgamjlKXc1AA1m83DoIRDlFubzeb96hhZLVTlgJ24gttutx+ONa50bHZKRenaeTs1OfpAfnr6yOOdE7EZdNwmlKocntXLNkA5JTGq47Ds+Lf94lWsyfnXleLfnIwJUN4DOnNYwuUxh2A3Ln9XULrfK8t3J27Tu3BVwiOjXJqoAy8UZej1yclGo3GTLN+gu3w+z/P3YaWbQqk3Ne12e4ZC+c8rxWsYytcPiP9RpZxCqWDKnxOiBNlyAUpOnGsoh4tA2Rm8X9xqtT6md5wyZmYe+0YRKL+1S/wYQ3n8zctBl5SBUv5djivfjMOPduIzcizeiYfr9foVvUwZG+XCuzibZKnSceZ5/v4QlKp8y7ElhnJlTeTP7BI/kllRYfzrfvHqFy4UX1vaL/aVlSmROzwbwdS29T2UcEwZF+V8ozM2lu1VY812u/15akypGh3TmFJesJbHHD167IdUxz3YJy5bNySuX1mbvy55CbMLtzU6tjGlsdFptVqfUMc0Go23F4wy1l2dSnbfvpMwVPe9WWVLDsrOJaF9MFu2Wq1PqmNkGce67xiXhTjdNwdlvV6/BgxfbPfBfVCetxi6b9/rlCup65QzM48dl2OjLMv26CibzeZ96sTIzEFdpwQXz9U1yrtVlpR/Zll2Fec65Y6l4pbbx8XHH9kknvzJlPjlHy8Tp29eKT5ou0aJoIT3w3dBlLDzVpfAJEZ1XOdaJZxnOSlvPMjPzxFljIvng914RwebsjYO7uhMyHu46sOfnf3Oz2TXDW6vvYxdFoIXz3Wc8J5zs9n8iOn2IrxTc2BM3Glqdp7dI553uaOjxrhwcob+MyuUpjs6WZZdon8OcigjPx8V+u+GTWFTSWEx3WYcdJ225jNDSE4q0GHCzlueHOyujn6bUWYgeb9ZZUaQPe+GzQ+Gc8+oOGhC+c1d4gfI16n3XDAhQ7+9qE9l01E2Go132GYKyXE1NiFDTcpoNpv3LOYJGWXNErJNW9sEp63p2RKiVPMn1bS1DgxsyhoGdGpmizj+xtXiDYnx7/vFmce3iWdW1cTVGEY4hQ2ZW0nNq8Qm/M6XbXm3S100lwGedFybuvNOibLI+ZS2ceU4eAxiEuvCkfmU8ycToDxETe6FgCBQHeqyAbFvfEhcO7BwDuXFCEbTZF840XeHK0jYcbs2OIGle0mVJ/mmnClEPQqxyTY5I8/zFhif7fSZee4bnrPOU4AssnRXHaVTCTd14dRDY3UbTIiSeFhsN/aMjgnqthFx880rxX3yATL5p3y4LPXzOaBkUyBjZMlYpbtQlIOBD475ZEusjMNSvkXe6VEoJVDkeZ2dzIfIFsRzU+JF2OyM9M9fTC/6SUYOyFQPjQ2nWiUjxnPfw5EeHqMWIqAeIFsAU847lJM2JM6xsewt1OIDLs99P7ZFHNdB/upS8XtPiD7PfLuCXJNolYyyFiNI/Zit65ItrOVafFbHcFohY7hPTN21Tjz4uc3iqfsnxKdX1MTl1OoYRFaMsToGB6Trw2JFP/OdZC2hJZ7ZkrMoAbbSGmelDJ91hFKuJeS7jlBMkJnrAqqJlgMUZS/dArPlGHNdSg5M3xXXtvquuEatvIYtDRhpxbUJuIgqsU5lGWtUploK0KuEU9mSW8YpmFQ556xNuYW7NiW13B+FkMiKHIy+C6eGgBxJvMR0oSv5hi6+z4HJyZoU0M2RVvDlrOQbcxVfX5AhZbuqy0v7ZstYMLHlAVlLTF9ALLbvu9Y5Zylpn/XOsd0ibIvxr2KCLHpp6SCUIdnSZSF+WzfOhem6GD+1KwR3Z4jNjrtDpNoZwmWd8yrupZN6Hx3fbMmFSe0Swdq2ZIPjxk1112Duo8OBGLrBkw/IoncdK2XHsdC9dHz204m50xh3tzFq1zFqtzHXrfCw7OgDsqyNnZLszVijsmXgrmNcmGtS78lIoMX2aJz03fKO2sDJddPQSCDPiQ1DfWBycY6XtXstc2PQKuxgG2McmXTPb9/9vmuJYXKyJrWjbeg+3xPM4O73nWqvbyw7xgZZSJbEUBa157cNJjdr2vb+5iA1YV3HxYscj30PDCEHIgcjtfm8K8hSsmRotkwFk5s1TTghUAopB6xrjHMBBkI0YYTZ0dZlxwLpkiWDULpmy5gwqayZgZNkA7oKQQCxctByYg0XIIEQQuRitGVHblMTA2ShKGPDpC6wu+DEgJqg2rDGDBtAF4Q6RAojp1xXGmSMbImVcR+YWNY04eQCtUG1ofUJ2/uvcETIgUhhdAE5GAlkKShjwHTNmhhODKgJqQ2sC14uOgyfD0IbRF+MlQaZAiZWyn2yJsTJATqGnHQO2Jhh+xlsACFCG0QbRtdyzQFZCZSxYPpmTS7Q5cjJHYNBYIkZpu99HoUQ/o4QIYSIZUZfjJ4ZMjZI32wZBDMU5yhy8pZTULl4XYP5fagMyEVoy4oupTpGduwnkloSlKEwY+AcQU4MhRTD6ovXBRwFzwWgCSEF0QVjJUGmgEllTS5OLlCIlIN1mS9mx/cZ5eLDALpCTI2RAhkTZQqYoTgpoCPECbaBHQ2ETL3PUl98ECAXYijG0OyYAmQoTG7W5ODkAF1CnVgm2JQx4okPA+gCMTbGskBGgRmaOblAh5GTORIrfKFx4VH4EIAxIXIxlg2SBbMvECY3e7oApbDaIgQu5/2HmeEKEINYiwSRi7EQkLFgumZOCuggctKGI4ULZN/vMeSLj0AYMytWEqMLzFg4fYDaoKaC6wvOFR4FkIPQFaILxrJAOsHsc/zlfYDWXE8qF22s8Pz5KHxcgEVALBtjJXBSSEOwFhk1Zgy4hitCT4hVw+gFs8/zwxqIBbUgyK7fcyA0PD9XX4iVxhiC0xdof6STWCsoBmKF7+cVCWFXQYyBMxRpf+STX1b0x45AhN0OMSrOGEirhrY/dfQAdjvS7oy+WCF6r1RIFxXWvlTRg1YVqFWBmxZbD99ig9pt0YPQw9rD1nstVri9V+/Ve3XrS/wfim4P5fIFxLoAAAAASUVORK5CYII=";class si{constructor(t,e){(0,a.A)(this,"config",void 0),(0,a.A)(this,"parent",void 0),(0,a.A)(this,"dom",void 0),(0,a.A)(this,"canvas",null),(0,a.A)(this,"context",null),(0,a.A)(this,"sceneRenderer",null),(0,a.A)(this,"loadingScreen",null),(0,a.A)(this,"assetManager",null),(0,a.A)(this,"bg",new h),(0,a.A)(this,"bgFullscreen",new h),(0,a.A)(this,"playerControls",null),(0,a.A)(this,"timelineSlider",null),(0,a.A)(this,"playButton",null),(0,a.A)(this,"skinButton",null),(0,a.A)(this,"animationButton",null),(0,a.A)(this,"playTime",0),(0,a.A)(this,"selectedBones",[]),(0,a.A)(this,"cancelId",0),(0,a.A)(this,"popup",null),(0,a.A)(this,"error",!1),(0,a.A)(this,"skeleton",null),(0,a.A)(this,"animationState",null),(0,a.A)(this,"paused",!0),(0,a.A)(this,"speed",1),(0,a.A)(this,"time",new m),(0,a.A)(this,"stopRequestAnimationFrame",!1),(0,a.A)(this,"disposed",!1),(0,a.A)(this,"viewport",{}),(0,a.A)(this,"currentViewport",{}),(0,a.A)(this,"previousViewport",{}),(0,a.A)(this,"viewportTransitionStart",0),(0,a.A)(this,"eventListeners",[]),(0,a.A)(this,"input",void 0),this.config=e;let s="string"===typeof t?document.getElementById(t):t;if(null==s)throw new Error("SpinePlayer parent not found: "+t);this.parent=s,void 0===e.showControls&&(e.showControls=!0);let i=e.showControls?'\n<div class="spine-player-controls spine-player-popup-parent spine-player-controls-hidden">\n<div class="spine-player-timeline"></div>\n<div class="spine-player-buttons">\n<button class="spine-player-button spine-player-button-icon-pause"></button>\n<div class="spine-player-button-spacer"></div>\n<button class="spine-player-button spine-player-button-icon-speed"></button>\n<button class="spine-player-button spine-player-button-icon-animations"></button>\n<button class="spine-player-button spine-player-button-icon-skins"></button>\n<button class="spine-player-button spine-player-button-icon-settings"></button>\n<button class="spine-player-button spine-player-button-icon-fullscreen"></button>\n<img class="spine-player-button-icon-spine-logo" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20104%2031.16%22%3E%3Cpath%20d%3D%22M104%2012.68a1.31%201.31%200%200%201-.37%201%201.28%201.28%200%200%201-.85.31H91.57a10.51%2010.51%200%200%200%20.29%202.55%204.92%204.92%200%200%200%201%202%204.27%204.27%200%200%200%201.64%201.26%206.89%206.89%200%200%200%202.6.44%2010.66%2010.66%200%200%200%202.17-.2%2012.81%2012.81%200%200%200%201.64-.44q.69-.25%201.14-.44a1.87%201.87%200%200%201%20.68-.2.44.44%200%200%201%20.27.04.43.43%200%200%201%20.16.2%201.38%201.38%200%200%201%20.09.37%204.89%204.89%200%200%201%200%20.58%204.14%204.14%200%200%201%200%20.43v.32a.83.83%200%200%201-.09.26%201.1%201.1%200%200%201-.17.22%202.77%202.77%200%200%201-.61.34%208.94%208.94%200%200%201-1.32.46%2018.54%2018.54%200%200%201-1.88.41%2013.78%2013.78%200%200%201-2.28.18%2010.55%2010.55%200%200%201-3.68-.59%206.82%206.82%200%200%201-2.66-1.74%207.44%207.44%200%200%201-1.63-2.89%2013.48%2013.48%200%200%201-.55-4%2012.76%2012.76%200%200%201%20.57-3.94%208.35%208.35%200%200%201%201.64-3%207.15%207.15%200%200%201%202.58-1.87%208.47%208.47%200%200%201%203.39-.65%208.19%208.19%200%200%201%203.41.64%206.46%206.46%200%200%201%202.32%201.73%207%207%200%200%201%201.3%202.54%2011.17%2011.17%200%200%201%20.43%203.13zm-3.14-.93a5.69%205.69%200%200%200-1.09-3.86%204.17%204.17%200%200%200-3.42-1.4%204.52%204.52%200%200%200-2%20.44%204.41%204.41%200%200%200-1.47%201.15A5.29%205.29%200%200%200%2092%209.75a7%207%200%200%200-.36%202zM80.68%2021.94a.42.42%200%200%201-.08.26.59.59%200%200%201-.25.18%201.74%201.74%200%200%201-.47.11%206.31%206.31%200%200%201-.76%200%206.5%206.5%200%200%201-.78%200%201.74%201.74%200%200%201-.47-.11.59.59%200%200%201-.25-.18.42.42%200%200%201-.08-.26V12a9.8%209.8%200%200%200-.23-2.35%204.86%204.86%200%200%200-.66-1.53%202.88%202.88%200%200%200-1.13-1%203.57%203.57%200%200%200-1.6-.34%204%204%200%200%200-2.35.83A12.71%2012.71%200%200%200%2069.11%2010v11.9a.42.42%200%200%201-.08.26.59.59%200%200%201-.25.18%201.74%201.74%200%200%201-.47.11%206.51%206.51%200%200%201-.78%200%206.31%206.31%200%200%201-.76%200%201.88%201.88%200%200%201-.48-.11.52.52%200%200%201-.25-.18.46.46%200%200%201-.07-.26v-17a.53.53%200%200%201%20.03-.21.5.5%200%200%201%20.23-.19%201.28%201.28%200%200%201%20.44-.11%208.53%208.53%200%200%201%201.39%200%201.12%201.12%200%200%201%20.43.11.6.6%200%200%201%20.22.19.47.47%200%200%201%20.07.26V7.2a10.46%2010.46%200%200%201%202.87-2.36%206.17%206.17%200%200%201%202.88-.75%206.41%206.41%200%200%201%202.87.58%205.16%205.16%200%200%201%201.88%201.54%206.15%206.15%200%200%201%201%202.26%2013.46%2013.46%200%200%201%20.31%203.11z%22%20fill%3D%22%23fff%22%2F%3E%3Cpath%20d%3D%22M43.35%202.86c.09%202.6%201.89%204%205.48%204.61%203%20.48%205.79.24%206.69-2.37%201.75-5.09-2.4-3.82-6-4.39s-6.31-2.03-6.17%202.15zm1.08%2010.69c.33%201.94%202.14%203.06%204.91%203s4.84-1.16%205.13-3.25c.53-3.88-2.53-2.38-5.3-2.3s-5.4-1.26-4.74%202.55zM48%2022.44c.55%201.45%202.06%202.06%204.1%201.63s3.45-1.11%203.33-2.76c-.21-3.06-2.22-2.1-4.26-1.66S47%2019.6%2048%2022.44zm1.78%206.78c.16%201.22%201.22%202%202.88%201.93s2.92-.67%203.13-2c.4-2.43-1.46-1.53-3.12-1.51s-3.17-.82-2.89%201.58z%22%20fill%3D%22%23ff4000%22%2F%3E%3Cpath%20d%3D%22M35.28%2013.16a15.33%2015.33%200%200%201-.48%204%208.75%208.75%200%200%201-1.42%203%206.35%206.35%200%200%201-2.32%201.91%207.14%207.14%200%200%201-3.16.67%206.1%206.1%200%200%201-1.4-.15%205.34%205.34%200%200%201-1.26-.47%207.29%207.29%200%200%201-1.24-.81q-.61-.49-1.29-1.15v8.51a.47.47%200%200%201-.08.26.56.56%200%200%201-.25.19%201.74%201.74%200%200%201-.47.11%206.47%206.47%200%200%201-.78%200%206.26%206.26%200%200%201-.76%200%201.89%201.89%200%200%201-.48-.11.49.49%200%200%201-.25-.19.51.51%200%200%201-.07-.26V4.91a.57.57%200%200%201%20.06-.27.46.46%200%200%201%20.23-.18%201.47%201.47%200%200%201%20.44-.1%207.41%207.41%200%200%201%201.3%200%201.45%201.45%200%200%201%20.43.1.52.52%200%200%201%20.24.18.51.51%200%200%201%20.07.27V7.2a18.06%2018.06%200%200%201%201.49-1.38%209%209%200%200%201%201.45-1%206.82%206.82%200%200%201%201.49-.59%207.09%207.09%200%200%201%204.78.52%206%206%200%200%201%202.13%202%208.79%208.79%200%200%201%201.2%202.9%2015.72%2015.72%200%200%201%20.4%203.51zm-3.28.36a15.64%2015.64%200%200%200-.2-2.53%207.32%207.32%200%200%200-.69-2.17%204.06%204.06%200%200%200-1.3-1.51%203.49%203.49%200%200%200-2-.57%204.1%204.1%200%200%200-1.2.18%204.92%204.92%200%200%200-1.2.57%208.54%208.54%200%200%200-1.28%201A15.77%2015.77%200%200%200%2022.76%2010v6.77a13.53%2013.53%200%200%200%202.46%202.4%204.12%204.12%200%200%200%202.44.83%203.56%203.56%200%200%200%202-.57A4.28%204.28%200%200%200%2031%2018a7.58%207.58%200%200%200%20.77-2.12%2011.43%2011.43%200%200%200%20.23-2.36zM12%2017.3a5.39%205.39%200%200%201-.48%202.33%204.73%204.73%200%200%201-1.37%201.72%206.19%206.19%200%200%201-2.12%201.06%209.62%209.62%200%200%201-2.71.36%2010.38%2010.38%200%200%201-3.21-.5A7.63%207.63%200%200%201%201%2021.82a3.25%203.25%200%200%201-.66-.43%201.09%201.09%200%200%201-.3-.53%203.59%203.59%200%200%201-.04-.93%204.06%204.06%200%200%201%200-.61%202%202%200%200%201%20.09-.4.42.42%200%200%201%20.16-.22.43.43%200%200%201%20.24-.07%201.35%201.35%200%200%201%20.61.26q.41.26%201%20.56a9.22%209.22%200%200%200%201.41.55%206.25%206.25%200%200%200%201.87.26%205.62%205.62%200%200%200%201.44-.17%203.48%203.48%200%200%200%201.12-.5%202.23%202.23%200%200%200%20.73-.84%202.68%202.68%200%200%200%20.26-1.21%202%202%200%200%200-.37-1.21%203.55%203.55%200%200%200-1-.87%208.09%208.09%200%200%200-1.36-.66l-1.56-.61a16%2016%200%200%201-1.57-.73%206%206%200%200%201-1.37-1%204.52%204.52%200%200%201-1-1.4%204.69%204.69%200%200%201-.37-2%204.88%204.88%200%200%201%20.39-1.87%204.46%204.46%200%200%201%201.16-1.61%205.83%205.83%200%200%201%201.94-1.11A8.06%208.06%200%200%201%206.53%204a8.28%208.28%200%200%201%201.36.11%209.36%209.36%200%200%201%201.23.28%205.92%205.92%200%200%201%20.94.37%204.09%204.09%200%200%201%20.59.35%201%201%200%200%201%20.26.26.83.83%200%200%201%20.09.26%201.32%201.32%200%200%200%20.06.35%203.87%203.87%200%200%201%200%20.51%204.76%204.76%200%200%201%200%20.56%201.39%201.39%200%200%201-.09.39.5.5%200%200%201-.16.22.35.35%200%200%201-.21.07%201%201%200%200%201-.49-.21%207%207%200%200%200-.83-.44%209.26%209.26%200%200%200-1.2-.44%205.49%205.49%200%200%200-1.58-.16%204.93%204.93%200%200%200-1.4.18%202.69%202.69%200%200%200-1%20.51%202.16%202.16%200%200%200-.59.83%202.43%202.43%200%200%200-.2%201%202%202%200%200%200%20.38%201.24%203.6%203.6%200%200%200%201%20.88%208.25%208.25%200%200%200%201.38.68l1.58.62q.8.32%201.59.72a6%206%200%200%201%201.39%201%204.37%204.37%200%200%201%201%201.36%204.46%204.46%200%200%201%20.37%201.8z%22%20fill%3D%22%23fff%22%2F%3E%3C%2Fsvg%3E">\n</div></div>':"";this.parent.appendChild(this.dom=oi('<div class="spine-player" style="position:relative;height:100%"><canvas class="spine-player-canvas" style="display:block;width:100%;height:100%"></canvas>'.concat(i,"</div>")));try{this.validateConfig(e)}catch(n){this.showError(n.message,n)}this.initialize(),this.addEventListener(window,"resize",()=>this.drawFrame(!1)),requestAnimationFrame(()=>this.drawFrame())}dispose(){var t,e,s,i,n;null===(t=this.sceneRenderer)||void 0===t||t.dispose(),null===(e=this.loadingScreen)||void 0===e||e.dispose(),null===(s=this.assetManager)||void 0===s||s.dispose(),null===(i=this.context)||void 0===i||i.dispose();for(var r=0;r<this.eventListeners.length;r++){var a=this.eventListeners[r];a.target.removeEventListener(a.event,a.func)}null===(n=this.input)||void 0===n||n.dispose(),this.canvas&&(this.canvas.width=0,this.canvas.height=0),this.parent.removeChild(this.dom),this.disposed=!0}addEventListener(t,e,s){this.eventListeners.push({target:t,event:e,func:s}),t.addEventListener(e,s)}validateConfig(t){if(!t)throw new Error("A configuration object must be passed to to new SpinePlayer().");if(t.skelUrl&&(t.skeleton=t.skelUrl),!t.skeleton&&!t.jsonUrl&&!t.binaryUrl)throw new Error("A URL must be specified for the skeleton JSON or binary file.");if(t.scale||(t.scale=1),!t.atlas&&!t.atlasUrl)throw new Error("A URL must be specified for the atlas file.");if(t.jsonUrl&&!t.skeleton&&(t.skeleton=t.jsonUrl),t.binaryUrl&&!t.skeleton&&(t.skeleton=t.binaryUrl),t.atlasUrl&&!t.atlas&&(t.atlas=t.atlasUrl),t.backgroundColor||(t.backgroundColor=t.alpha?"00000000":"000000"),t.fullScreenBackgroundColor||(t.fullScreenBackgroundColor=t.backgroundColor),t.backgroundImage&&!t.backgroundImage.url&&(t.backgroundImage=void 0),void 0===t.premultipliedAlpha&&(t.premultipliedAlpha=!0),void 0===t.preserveDrawingBuffer&&(t.preserveDrawingBuffer=!1),void 0===t.mipmaps&&(t.mipmaps=!0),void 0===t.interactive&&(t.interactive=!0),t.debug||(t.debug={bones:!1,clipping:!1,bounds:!1,hulls:!1,meshes:!1,paths:!1,points:!1,regions:!1}),t.animations&&t.animation&&t.animations.indexOf(t.animation)<0)throw new Error("Animation '"+t.animation+"' is not in the config animation list: "+li(t.animations));if(t.skins&&t.skin&&t.skins.indexOf(t.skin)<0)throw new Error("Default skin '"+t.skin+"' is not in the config skins list: "+li(t.skins));t.viewport||(t.viewport={}),t.viewport.animations||(t.viewport.animations={}),void 0===t.viewport.debugRender&&(t.viewport.debugRender=!1),void 0===t.viewport.transitionTime&&(t.viewport.transitionTime=.25),t.controlBones||(t.controlBones=[]),void 0===t.showLoading&&(t.showLoading=!0),void 0===t.defaultMix&&(t.defaultMix=.25)}initialize(){let t=this.config,e=this.dom;if(!t.alpha){let e=t.backgroundColor;this.dom.style.backgroundColor=("#"==e.charAt(0)?e:"#"+e).substr(0,7)}try{this.canvas=ai(e,"spine-player-canvas"),this.context=new is(this.canvas,{alpha:t.alpha,preserveDrawingBuffer:t.preserveDrawingBuffer}),this.sceneRenderer=new Gs(this.canvas,this.context,!0),t.showLoading&&(this.loadingScreen=new $s(this.sceneRenderer))}catch(s){return this.showError("Sorry, your browser does not support WebGL, or you have disabled WebGL in your browser settings.\nPlease use the latest version of Firefox, Chrome, Edge, or Safari.",s),null}if(this.assetManager=new rs(this.context,"",t.downloader),t.rawDataURIs)for(let i in t.rawDataURIs)this.assetManager.setRawDataURI(i,t.rawDataURIs[i]);if(t.skeleton.endsWith(".json")?this.assetManager.loadJson(t.skeleton):this.assetManager.loadBinary(t.skeleton),this.assetManager.loadTextureAtlas(t.atlas),t.backgroundImage&&this.assetManager.loadTexture(t.backgroundImage.url),this.bg.setFromString(t.backgroundColor),this.bgFullscreen.setFromString(t.fullScreenBackgroundColor),t.showControls){this.playerControls=e.children[1];let t=this.playerControls.children,s=t[0],i=t[1].children;this.playButton=i[0];let n=i[2];this.animationButton=i[3],this.skinButton=i[4];let r=i[5],a=i[6],o=i[7];this.timelineSlider=new ri,s.appendChild(this.timelineSlider.create()),this.timelineSlider.change=t=>{this.pause();let e=this.animationState.getCurrent(0).animation.duration*t;this.animationState.update(e-this.playTime),this.animationState.apply(this.skeleton),this.skeleton.update(e-this.playTime),this.skeleton.updateWorldTransform(Tt.update),this.playTime=e},this.playButton.onclick=()=>this.paused?this.play():this.pause(),n.onclick=()=>this.showSpeedDialog(n),this.animationButton.onclick=()=>this.showAnimationsDialog(this.animationButton),this.skinButton.onclick=()=>this.showSkinsDialog(this.skinButton),r.onclick=()=>this.showSettingsDialog(r);let h=this.canvas.clientWidth,l=this.canvas.clientHeight,c=this.canvas.style.width,d=this.canvas.style.height,u=!1;a.onclick=()=>{let t=()=>{u=!u,u||(this.canvas.style.width=h+"px",this.canvas.style.height=l+"px",this.drawFrame(!1),requestAnimationFrame(()=>{this.canvas.style.width=c,this.canvas.style.height=d}))},s=e;s.onfullscreenchange=t,s.onwebkitfullscreenchange=t;let i=document;i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement?i.exitFullscreen?i.exitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen?i.webkitExitFullscreen():i.msExitFullscreen&&i.msExitFullscreen():(h=this.canvas.clientWidth,l=this.canvas.clientHeight,c=this.canvas.style.width,d=this.canvas.style.height,s.requestFullscreen?s.requestFullscreen():s.webkitRequestFullScreen?s.webkitRequestFullScreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen&&s.msRequestFullscreen())},o.onclick=()=>window.open("http://esotericsoftware.com")}return e}loadSkeleton(){if(this.error)return;this.assetManager.hasErrors()&&this.showError("Error: Assets could not be loaded.\n"+li(this.assetManager.getErrors()));let t,e=this.config,s=this.assetManager.require(e.atlas),i=this.context.gl,n=i.getExtension("EXT_texture_filter_anisotropic"),r=-1!=i.getParameter(i.VERSION).indexOf("WebGL 1.0");for(let m of s.pages){let t=m.minFilter;var a=e.mipmaps,o=l.isPowerOfTwo(m.width)&&l.isPowerOfTwo(m.height);r&&!o&&(a=!1),a&&(n?(i.texParameterf(i.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY_EXT,8),t=yt.MipMapLinearLinear):t=yt.Linear,m.texture.setFilters(t,yt.Nearest)),t!=yt.Nearest&&t!=yt.Linear&&m.texture.update(!0)}try{let i,n,r=new Nt(s);if(e.skeleton.endsWith(".json")){if(n=this.assetManager.remove(e.skeleton),!n)throw new Error("Empty JSON data.");if(e.jsonField&&(n=n[e.jsonField],!n))throw new Error("JSON field does not exist: "+e.jsonField);i=new Ke(r)}else n=this.assetManager.remove(e.skeleton),i=new le(r);i.scale=e.scale,t=i.readSkeletonData(n)}catch(u){return void this.showError("Error: Could not load skeleton data.\n".concat(u.message),u)}this.skeleton=new te(t);let h=new At(t);h.defaultMix=e.defaultMix,this.animationState=new ot(h),e.controlBones.forEach(e=>{t.findBone(e)||this.showError("Error: Control bone does not exist in skeleton: ".concat(e))}),!e.skin&&t.skins.length&&(e.skin=t.skins[0].name),e.skins&&e.skin.length&&e.skins.forEach(t=>{this.skeleton.data.findSkin(t)||this.showError("Error: Skin in config list does not exist in skeleton: ".concat(t))}),e.skin&&(this.skeleton.data.findSkin(e.skin)||this.showError("Error: Skin does not exist in skeleton: ".concat(e.skin)),this.skeleton.setSkinByName(e.skin),this.skeleton.setSlotsToSetupPose()),Object.getOwnPropertyNames(e.viewport.animations).forEach(e=>{t.findAnimation(e)||this.showError("Error: Animation for which a viewport was specified does not exist in skeleton: ".concat(e))}),e.animations&&e.animations.length&&(e.animations.forEach(t=>{this.skeleton.data.findAnimation(t)||this.showError("Error: Animation in config list does not exist in skeleton: ".concat(t))}),e.animation||(e.animation=e.animations[0])),e.animation&&!t.findAnimation(e.animation)&&this.showError("Error: Animation does not exist in skeleton: ".concat(e.animation)),this.setupInput(),e.showControls&&((1==t.skins.length||e.skins&&1==e.skins.length)&&this.skinButton.classList.add("spine-player-hidden"),(1==t.animations.length||e.animations&&1==e.animations.length)&&this.animationButton.classList.add("spine-player-hidden")),e.success&&e.success(this);let c=this.animationState.getCurrent(0);if(c){var d;if(void 0===this.currentViewport.x&&this.setViewport(c.animation),!e.animation)e.animation=null===(d=c.animation)||void 0===d?void 0:d.name;this.play()}else e.animation?(c=this.setAnimation(e.animation),this.play()):(c=this.animationState.setEmptyAnimation(0),c.trackEnd=1e8,this.skeleton.updateWorldTransform(Tt.update),this.setViewport(c.animation),this.pause())}setupInput(){let t=this.config,e=t.controlBones;if(!e.length&&!t.showControls)return;let s=this.selectedBones=new Array(e.length),i=this.canvas,n=null,r=new u,a=new as,o=new as,h=new u,c=this.skeleton,d=this.sceneRenderer;if(t.interactive){let u=function(t,n){o.set(t,i.clientHeight-n,0),r.x=r.y=0;let h=24,l=0,u=null;for(let m=0;m<e.length;m++){s[m]=null;let t=c.findBone(e[m]);if(!t)continue;let n=d.camera.worldToScreen(a.set(t.worldX,t.worldY,0),i.clientWidth,i.clientHeight).distance(o);n<h&&(h=n,u=t,l=m,r.x=a.x-o.x,r.y=a.y-o.y)}return u&&(s[l]=u),u};this.input=new Is(i),this.input.addListener({down:(t,e)=>{n=u(t,e)},up:()=>{n?n=null:t.showControls&&(this.paused?this.play():this.pause())},dragged:(t,e)=>{n&&(t=l.clamp(t+r.x,0,i.clientWidth),e=l.clamp(e-r.y,0,i.clientHeight),d.camera.screenToWorld(a.set(t,e,0),i.clientWidth,i.clientHeight),n.parent?(n.parent.worldToLocal(h.set(a.x-c.x,a.y-c.y)),n.x=h.x,n.y=h.y):(n.x=a.x-c.x,n.y=a.y-c.y))},moved:(t,e)=>u(t,e)})}if(t.showControls){this.addEventListener(document,"mousemove",t=>{t instanceof MouseEvent&&n(t.clientX,t.clientY)}),this.addEventListener(document,"touchmove",t=>{if(t instanceof TouchEvent){let e=t.changedTouches;if(e.length){let t=e[0];n(t.clientX,t.clientY)}}});let t=(t,e,s)=>{let i=t-s.left,n=e-s.top;return i>=0&&i<=s.width&&n>=0&&n<=s.height},e=!0,s=!1,n=(n,r)=>{let a=ai(this.dom,"spine-player-popup");e=t(n,r,this.playerControls.getBoundingClientRect()),s=t(n,r,i.getBoundingClientRect()),clearTimeout(this.cancelId),!a&&!e&&!s&&!this.paused?this.playerControls.classList.add("spine-player-controls-hidden"):this.playerControls.classList.remove("spine-player-controls-hidden"),e||a||this.paused||(this.cancelId=setTimeout(()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")},1e3))}}}play(){this.paused=!1;let t=this.config;t.showControls&&(this.cancelId=setTimeout(()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")},1e3),this.playButton.classList.remove("spine-player-button-icon-play"),this.playButton.classList.add("spine-player-button-icon-pause"),t.animation||(t.animations&&t.animations.length?t.animation=t.animations[0]:this.skeleton.data.animations.length&&(t.animation=this.skeleton.data.animations[0].name),t.animation&&this.setAnimation(t.animation)))}pause(){this.paused=!0,this.config.showControls&&(this.playerControls.classList.remove("spine-player-controls-hidden"),clearTimeout(this.cancelId),this.playButton.classList.remove("spine-player-button-icon-pause"),this.playButton.classList.add("spine-player-button-icon-play"))}setAnimation(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=this.setViewport(t),this.animationState.setAnimationWith(0,t,e)}addAnimation(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t=this.setViewport(t),this.animationState.addAnimationWith(0,t,e,s)}setViewport(t){if("string"==typeof t){let e=this.skeleton.data.findAnimation(t);if(!e)throw new Error("Animation not found: "+t);t=e}this.previousViewport=this.currentViewport;let e=this.config.viewport,s=this.currentViewport={padLeft:void 0!==e.padLeft?e.padLeft:"10%",padRight:void 0!==e.padRight?e.padRight:"10%",padTop:void 0!==e.padTop?e.padTop:"10%",padBottom:void 0!==e.padBottom?e.padBottom:"10%"};void 0!==e.x&&void 0!==e.y&&e.width&&e.height?(s.x=e.x,s.y=e.y,s.width=e.width,s.height=e.height):this.calculateAnimationViewport(t,s);let i=this.config.viewport.animations[t.name];return i&&(void 0!==i.x&&void 0!==i.y&&i.width&&i.height&&(s.x=i.x,s.y=i.y,s.width=i.width,s.height=i.height),void 0!==i.padLeft&&(s.padLeft=i.padLeft),void 0!==i.padRight&&(s.padRight=i.padRight),void 0!==i.padTop&&(s.padTop=i.padTop),void 0!==i.padBottom&&(s.padBottom=i.padBottom)),s.padLeft=this.percentageToWorldUnit(s.width,s.padLeft),s.padRight=this.percentageToWorldUnit(s.width,s.padRight),s.padBottom=this.percentageToWorldUnit(s.height,s.padBottom),s.padTop=this.percentageToWorldUnit(s.height,s.padTop),this.viewportTransitionStart=performance.now(),t}percentageToWorldUnit(t,e){return"string"===typeof e?t*parseFloat(e.substr(0,e.length-1))/100:e}calculateAnimationViewport(t,e){this.skeleton.setToSetupPose();let s=t.duration?t.duration/100:0,i=0,n=1e8,r=-1e8,a=1e8,o=-1e8,h=new u,l=new u;const c=new Array(2);for(let d=0;d<100;d++,i+=s)t.apply(this.skeleton,i,i,!1,[],1,x.setup,b.mixIn),this.skeleton.updateWorldTransform(Tt.update),this.skeleton.getBounds(h,l,c,this.sceneRenderer.skeletonRenderer.getSkeletonClipping()),isNaN(h.x)||isNaN(h.y)||isNaN(l.x)||isNaN(l.y)?this.showError("Animation bounds are invalid: "+t.name):(n=Math.min(h.x,n),r=Math.max(h.x+l.x,r),a=Math.min(h.y,a),o=Math.max(h.y+l.y,o));e.x=n,e.y=a,e.width=r-n,e.height=o-a}drawFrame(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{if(this.error)return;if(this.disposed)return;t&&!this.stopRequestAnimationFrame&&requestAnimationFrame(()=>this.drawFrame());let l=document,c=l.fullscreenElement||l.webkitFullscreenElement||l.mozFullScreenElement||l.msFullscreenElement?this.bgFullscreen:this.bg;this.time.update();let d=this.time.delta,u=!this.assetManager.isLoadingComplete();this.skeleton||u||this.loadSkeleton();let m=this.skeleton,p=this.config;if(m){var e,s,i,n,r,a,o;let t=this.sceneRenderer;t.resize(_s.Expand);let l=this.paused?0:d*this.speed;if(p.frame&&p.frame(this,l),!this.paused&&(m.update(l),this.animationState.update(l),this.animationState.apply(m),p.updateWorldTransform?p.updateWorldTransform(this,l):m.updateWorldTransform(Tt.update),p.showControls)){this.playTime+=l;let t=this.animationState.getCurrent(0);if(t){let e=t.animation.duration;for(;this.playTime>=e&&0!=e;)this.playTime-=e;this.playTime=Math.max(0,Math.min(this.playTime,e)),this.timelineSlider.setValue(this.playTime/e)}}let u=this.viewport;if(u.x=this.currentViewport.x-this.currentViewport.padLeft,u.y=this.currentViewport.y-this.currentViewport.padBottom,u.width=this.currentViewport.width+this.currentViewport.padLeft+this.currentViewport.padRight,u.height=this.currentViewport.height+this.currentViewport.padBottom+this.currentViewport.padTop,this.previousViewport){let t=(performance.now()-this.viewportTransitionStart)/1e3/p.viewport.transitionTime;if(t<1){let e=this.previousViewport.x-this.previousViewport.padLeft,s=this.previousViewport.y-this.previousViewport.padBottom,i=this.previousViewport.width+this.previousViewport.padLeft+this.previousViewport.padRight,n=this.previousViewport.height+this.previousViewport.padBottom+this.previousViewport.padTop;u.x=e+(u.x-e)*t,u.y=s+(u.y-s)*t,u.width=i+(u.width-i)*t,u.height=n+(u.height-n)*t}}t.camera.zoom=this.canvas.height/this.canvas.width>u.height/u.width?u.width/this.canvas.width:u.height/this.canvas.height,t.camera.position.x=u.x+u.width/2,t.camera.position.y=u.y+u.height/2;let g=this.context.gl;g.clearColor(c.r,c.g,c.b,c.a),g.clear(g.COLOR_BUFFER_BIT),p.update&&p.update(this,l),t.begin();let f=p.backgroundImage;if(f){let e=this.assetManager.require(f.url);void 0!==f.x&&void 0!==f.y&&f.width&&f.height?t.drawTexture(e,f.x,f.y,f.width,f.height):t.drawTexture(e,u.x,u.y,u.width,u.height)}t.drawSkeleton(m,p.premultipliedAlpha),Number(t.skeletonDebugRenderer.drawBones=null!==(e=p.debug.bones)&&void 0!==e&&e)+Number(t.skeletonDebugRenderer.drawBoundingBoxes=null!==(s=p.debug.bounds)&&void 0!==s&&s)+Number(t.skeletonDebugRenderer.drawClipping=null!==(i=p.debug.clipping)&&void 0!==i&&i)+Number(t.skeletonDebugRenderer.drawMeshHull=null!==(n=p.debug.hulls)&&void 0!==n&&n)+Number(t.skeletonDebugRenderer.drawPaths=null!==(r=p.debug.paths)&&void 0!==r&&r)+Number(t.skeletonDebugRenderer.drawRegionAttachments=null!==(a=p.debug.regions)&&void 0!==a&&a)+Number(t.skeletonDebugRenderer.drawMeshTriangles=null!==(o=p.debug.meshes)&&void 0!==o&&o)>0&&t.drawSkeletonDebug(m,p.premultipliedAlpha);let w=p.controlBones;if(w.length){let e=this.selectedBones;g.lineWidth(2);for(let s=0;s<w.length;s++){let i=m.findBone(w[s]);if(!i)continue;let n=e[s]?ci:ui,r=e[s]?di:mi;t.circle(!0,m.x+i.worldX,m.y+i.worldY,20,n),t.circle(!1,m.x+i.worldX,m.y+i.worldY,20,r)}}p.viewport.debugRender&&(g.lineWidth(1),t.rect(!1,this.currentViewport.x,this.currentViewport.y,this.currentViewport.width,this.currentViewport.height,h.GREEN),t.rect(!1,u.x,u.y,u.width,u.height,h.RED)),t.end(),p.draw&&p.draw(this,l)}p.showLoading&&(this.loadingScreen.backgroundColor.setFromColor(c),this.loadingScreen.draw(!u)),u&&p.loading&&p.loading(this,d)}catch(l){this.showError("Error: Unable to render skeleton.\n".concat(l.message),l)}}startRendering(){this.stopRequestAnimationFrame=!1,requestAnimationFrame(()=>this.drawFrame())}stopRendering(){this.stopRequestAnimationFrame=!0}hidePopup(t){return null!=this.popup&&this.popup.hide(t)}showSpeedDialog(t){let e="speed";if(this.hidePopup(e))return;let s=new ii(e,t,this,this.playerControls,'\n<div class="spine-player-popup-title">Speed</div>\n<hr>\n<div class="spine-player-row" style="align-items:center;padding:8px">\n<div class="spine-player-column">\n\t<div class="spine-player-speed-slider" style="margin-bottom:4px"></div>\n\t<div class="spine-player-row" style="justify-content:space-between"><div>0.1x</div><div>1x</div><div>2x</div></div>\n</div>\n</div>'),i=new ri(2,.1,!0);ai(s.dom,"spine-player-speed-slider").appendChild(i.create()),i.setValue(this.speed/2),i.change=t=>this.speed=2*t,s.show()}showAnimationsDialog(t){let e="animations";if(this.hidePopup(e))return;if(!this.skeleton||!this.skeleton.data.animations.length)return;let s=new ii(e,t,this,this.playerControls,'<div class="spine-player-popup-title">Animations</div><hr><ul class="spine-player-list"></ul>'),i=ai(s.dom,"spine-player-list");this.skeleton.data.animations.forEach(t=>{if(this.config.animations&&this.config.animations.indexOf(t.name)<0)return;let e=oi('<li class="spine-player-list-item selectable"><div class="selectable-circle"></div><div class="selectable-text"></div></li>');t.name==this.config.animation&&e.classList.add("selected"),ai(e,"selectable-text").innerText=t.name,i.appendChild(e),e.onclick=()=>{hi(i.children,"selected"),e.classList.add("selected"),this.config.animation=t.name,this.playTime=0,this.setAnimation(t.name),this.play()}}),s.show()}showSkinsDialog(t){let e="skins";if(this.hidePopup(e))return;if(!this.skeleton||!this.skeleton.data.animations.length)return;let s=new ii(e,t,this,this.playerControls,'<div class="spine-player-popup-title">Skins</div><hr><ul class="spine-player-list"></ul>'),i=ai(s.dom,"spine-player-list");this.skeleton.data.skins.forEach(t=>{if(this.config.skins&&this.config.skins.indexOf(t.name)<0)return;let e=oi('<li class="spine-player-list-item selectable"><div class="selectable-circle"></div><div class="selectable-text"></div></li>');t.name==this.config.skin&&e.classList.add("selected"),ai(e,"selectable-text").innerText=t.name,i.appendChild(e),e.onclick=()=>{hi(i.children,"selected"),e.classList.add("selected"),this.config.skin=t.name,this.skeleton.setSkinByName(this.config.skin),this.skeleton.setSlotsToSetupPose()}}),s.show()}showSettingsDialog(t){let e="settings";if(this.hidePopup(e))return;if(!this.skeleton||!this.skeleton.data.animations.length)return;let s=new ii(e,t,this,this.playerControls,'<div class="spine-player-popup-title">Debug</div><hr><ul class="spine-player-list"></li>'),i=ai(s.dom,"spine-player-list"),n=(t,e)=>{let s=oi('<li class="spine-player-list-item"></li>'),n=new ni(t);s.appendChild(n.create());let r=this.config.debug;n.setEnabled(r[e]),n.change=t=>r[e]=t,i.appendChild(s)};n("Bones","bones"),n("Regions","regions"),n("Meshes","meshes"),n("Bounds","bounds"),n("Paths","paths"),n("Clipping","clipping"),n("Points","points"),n("Hulls","hulls"),s.show()}showError(t,e){if(!this.error)throw this.error=!0,this.dom.appendChild(oi('<div class="spine-player-error" style="background:#000;color:#fff;position:absolute;top:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;overflow:auto;z-index:999">'+t.replace("\n","<br><br>")+"</div>")),this.config.error&&this.config.error(this,t),e||new Error(t);if(e)throw e}}class ii{constructor(t,e,s,i,n){(0,a.A)(this,"id",void 0),(0,a.A)(this,"button",void 0),(0,a.A)(this,"player",void 0),(0,a.A)(this,"dom",void 0),(0,a.A)(this,"className",void 0),(0,a.A)(this,"windowClickListener",void 0),this.id=t,this.button=e,this.player=s,this.dom=oi('<div class="spine-player-popup spine-player-hidden"></div>'),this.dom.innerHTML=n,i.appendChild(this.dom),this.className="spine-player-button-icon-"+t+"-selected"}dispose(){}hide(t){return this.dom.remove(),this.button.classList.remove(this.className),this.id==t&&(this.player.popup=null,!0)}show(){this.player.popup=this,this.button.classList.add(this.className),this.dom.classList.remove("spine-player-hidden");let t=!1,e=()=>{t||requestAnimationFrame(e);let s=this.player.dom,i=Math.abs(s.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom),n=Math.abs(s.getBoundingClientRect().right-s.getBoundingClientRect().right);this.dom.style.maxHeight=s.clientHeight-i-n+"px"};requestAnimationFrame(e);let s=!0,i=e=>{s||this.player.popup!=this?s=!1:this.dom.contains(e.target)||(this.dom.remove(),window.removeEventListener("click",i),this.button.classList.remove(this.className),this.player.popup=null,t=!0)};this.player.addEventListener(window,"click",i)}}class ni{constructor(t){(0,a.A)(this,"text",void 0),(0,a.A)(this,"switch",null),(0,a.A)(this,"enabled",!1),(0,a.A)(this,"change",()=>{}),this.text=t}create(){return this.switch=oi('\n<div class="spine-player-switch">\n\t<span class="spine-player-switch-text">'.concat(this.text,'</span>\n\t<div class="spine-player-switch-knob-area">\n\t\t<div class="spine-player-switch-knob"></div>\n\t</div>\n</div>')),this.switch.addEventListener("click",()=>{this.setEnabled(!this.enabled),this.change&&this.change(this.enabled)}),this.switch}setEnabled(t){var e,s;t?null===(e=this.switch)||void 0===e||e.classList.add("active"):null===(s=this.switch)||void 0===s||s.classList.remove("active"),this.enabled=t}isEnabled(){return this.enabled}}class ri{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,a.A)(this,"snaps",void 0),(0,a.A)(this,"snapPercentage",void 0),(0,a.A)(this,"big",void 0),(0,a.A)(this,"slider",null),(0,a.A)(this,"value",null),(0,a.A)(this,"knob",null),(0,a.A)(this,"change",()=>{}),this.snaps=t,this.snapPercentage=e,this.big=s}create(){this.slider=oi('\n<div class="spine-player-slider '.concat(this.big?"big":"",'">\n\t<div class="spine-player-slider-value"></div>\n\t\x3c!--<div class="spine-player-slider-knob"></div>--\x3e\n</div>')),this.value=ai(this.slider,"spine-player-slider-value"),this.setValue(0);let t=!1;return new Is(this.slider).addListener({down:(e,s)=>{var i;t=!0,null===(i=this.value)||void 0===i||i.classList.add("hovering")},up:(e,s)=>{var i;t=!1,this.change&&this.change(this.setValue(e/this.slider.clientWidth)),null===(i=this.value)||void 0===i||i.classList.remove("hovering")},moved:(e,s)=>{t&&this.change&&this.change(this.setValue(e/this.slider.clientWidth))},dragged:(t,e)=>{this.change&&this.change(this.setValue(t/this.slider.clientWidth))}}),this.slider}setValue(t){if(t=Math.max(0,Math.min(1,t)),this.snaps){let e=1/this.snaps,s=t%e;s<e*this.snapPercentage?t-=s:s>e-e*this.snapPercentage&&(t=t-s+e),t=Math.max(0,Math.min(1,t))}return this.value.style.width=100*t+"%",t}}function ai(t,e){return t.getElementsByClassName(e)[0]}function oi(t){let e=document.createElement("div");return e.innerHTML=t,e.children[0]}function hi(t,e){for(let s=0;s<t.length;s++)t[s].classList.remove(e)}function li(t){return JSON.stringify(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").replace(/'/g,"&#39;")}const ci=new h(.478,0,0,.25),di=new h(1,1,1,1),ui=new h(.478,0,0,.5),mi=new h(1,0,0,.8);function pi(t){return new Promise((e,s)=>{const i=document.createElement("link");i.href=t,i.rel="stylesheet",i.onload=()=>e(),i.onerror=()=>s(new Error("CSS load error for ".concat(t))),document.head.appendChild(i)})}class gi{constructor(t){(0,a.A)(this,"parent",void 0),(0,a.A)(this,"prefix","<html>\n<head>\n<style>\nbody { margin: 0px; }\n</style>\n</head>\n<body>".trim()),(0,a.A)(this,"postfix","</body>"),(0,a.A)(this,"code",void 0),(0,a.A)(this,"player",void 0),(0,a.A)(this,"timerId",0),this.parent=t,this.load()}async load(){var t;await Promise.all([(t="https://www.unpkg.com/codemirror@5.51.0/lib/codemirror.js",new Promise((e,s)=>{const i=document.createElement("script");i.src=t,i.onload=()=>e(),i.onerror=()=>s(new Error("Script load error for ".concat(t))),document.head.appendChild(i)})),pi("https://www.unpkg.com/codemirror@5.51.0/lib/codemirror.css")]),this.render(this.parent)}render(t){t.innerHTML='\n\t\t\t\t<div style="display: flex; flex-direction: column; width: 100%; height: 100%;">\n\t\t\t\t\t<div style="width: 100%; height: 50%"></div>\n\t\t\t\t\t<iframe style="width: 100%; height: 50%; outline: none; border: none;"></iframe>\n\t\t\t\t</div>\n\t\t\t';let e=t.children[0].children[0];this.player=t.children[0].children[1],requestAnimationFrame(()=>{this.code=CodeMirror(e,{lineNumbers:!0,tabSize:3,indentUnit:3,indentWithTabs:!0,scrollBarStyle:"native",mode:"htmlmixed",theme:"monokai"}),this.code.on("change",()=>{this.startPlayer()}),e.children[0].style.height="100%",this.setCode(gi.DEFAULT_CODE)})}setPreAndPostfix(t,e){this.prefix=t,this.postfix=e,this.startPlayer()}setCode(t){this.code.setValue(t),this.startPlayer()}startPlayer(){clearTimeout(this.timerId),this.timerId=setTimeout(()=>{let t=this.code.getDoc().getValue();t=this.prefix+t+this.postfix,t=window.btoa(t),this.player.src="",this.player.src="data:text/html;base64,"+t},500)}}(0,a.A)(gi,"DEFAULT_CODE",'\n<script src="https://esotericsoftware.com/files/spine-player/4.1/spine-player.js"><\/script>\n<link rel="stylesheet" href="https://esotericsoftware.com/files/spine-player/4.1/spine-player.css">\n\n<div id="player-container" style="width: 100vw; height: 100vh;"></div>\n\n<script>\nnew spine.SpinePlayer("player-container", {\n\tjsonUrl: "https://esotericsoftware.com/files/examples/4.1/spineboy/export/spineboy-pro.json",\n\tatlasUrl: "https://esotericsoftware.com/files/examples/4.1/spineboy/export/spineboy-pma.atlas"\n});\n<\/script>\n\t\t'.trim());var fi=s(9950),wi=s(13450),Ai=s(59852),xi=s(84765),bi=s(55030),vi=s(44414);const yi=(0,fi.memo)(t=>{const{skelFile:e,atlasFile:s}=t,i=Ai.c2("/"+e.replace(/\\/g,"/")),n=Ai.c2("/"+s.replace(/\\/g,"/")),r=(0,fi.useRef)(null),a=(0,fi.useRef)(null),{t:o}=(0,bi.Bd)();return(0,fi.useLayoutEffect)(()=>{let h=null;if(a.current&&r.current){const l=r.current,c=new is(a.current,{preserveDrawingBuffer:!1}),d=new rs(c,"");new Promise((t,e)=>{d.loadTextureAtlas(n,(e,s)=>{t(s)},(t,s)=>{e(s)})}).then(s=>new Promise(()=>{d.loadBinary(i,(r,a)=>{const c=new le(new Nt(s));try{const t=c.readSkeletonData(a).animations.map(t=>t.name);let e;t.indexOf("idle")>0&&(e="idle"),h=new si(l,{backgroundColor:wi.Q1.BackgroundDark,animation:e,animations:t,preserveDrawingBuffer:!1,binaryUrl:i,atlasUrl:n,premultipliedAlpha:!1,showControls:!0})}catch(u){console.error(u),t.onLoadFailed(o("spine.load",{file:xi.A.path.basename(e)}))}finally{d.dispose()}},(s,i)=>{console.error(i),t.onLoadFailed(o("spine.load",{file:xi.A.path.basename(e)}))})})).catch(e=>{console.error(e),t.onLoadFailed(o("spine.load",{file:xi.A.path.basename(s)}))})}return()=>{h&&h.dispose()}},[]),(0,vi.jsx)("div",{ref:r,style:{height:"80vh"},children:(0,vi.jsx)("canvas",{ref:a,hidden:!0})})})}}]);